/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\"\r\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\r\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\r\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\r\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\r\n\t</td>\r\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\r\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\r\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\r\n</tr>\r\n","dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){var _a=_6("dojox.grid.DataGrid",_7,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _8(this);},get:function(_b,_c){if(_c&&this.field=="_item"&&!this.fields){return _c;}else{if(_c&&this.fields){var _d=[];var s=this.grid.store;_2.forEach(this.fields,function(f){_d=_d.concat(s.getValues(_c,f));});return _d;}else{if(!_c&&typeof _b==="string"){return this.inherited(arguments);}}}return (!_c?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_c:this.grid.store.getValue(_c,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _e=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_e=true;}if(!this.updating){this.beginUpdate();_e=true;}if(_e){var _f=this;this._endUpdateDelay=setTimeout(function(){delete _f._endUpdateDelay;_f.endUpdate();},this.updateDelay);}}},_onSet:function(_10,_11,_12,_13){this._checkUpdateStatus();var idx=this.getItemIndex(_10);if(idx>-1){this.updateRow(idx);}},_createItem:function(_14,_15){var _16=this._hasIdentity?this.store.getIdentity(_14):_4.toJson(this.query)+":idx:"+_15+":sort:"+_4.toJson(this.getSortProps());var o=this._by_idty[_16]={idty:_16,item:_14};return o;},_addItem:function(_17,_18,_19){this._by_idx[_18]=this._createItem(_17,_18);if(!_19){this.updateRow(_18);}},_onNew:function(_1a,_1b){this._checkUpdateStatus();var _1c=this.get("rowCount");this._addingItem=true;this.updateRowCount(_1c+1);this._addingItem=false;this._addItem(_1a,_1c);this.showMessage();},_onDelete:function(_1d){this._checkUpdateStatus();var idx=this._getItemIndex(_1d,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_1e,_1f,_20){if(this._requestsPending(0)){return;}this._setQuery(_1f,_20);this._setStore(_1e);this._refresh(true);},setQuery:function(_21,_22){if(this._requestsPending(0)){return;}this._setQuery(_21,_22);this._refresh(true);},setItems:function(_23){this.items=_23;this._setStore(this.store);this._refresh(true);},_setQuery:function(_24,_25){this.query=_24;this.queryOptions=_25||this.queryOptions;},_setStore:function(_26){if(this.store&&this._store_connects){_2.forEach(this._store_connects,this.disconnect,this);}this.store=_26;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(_27,req){if(!this.scroller){return;}if(this.rowCount!=_27){if(req.isRender){this.scroller.init(_27,this.keepRows,this.rowsPerPage);this.rowCount=_27;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(_27);}}if(!_27){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_28,req){if(!this.scroller){return;}if(_28&&_28.length>0){_2.forEach(_28,function(_29,idx){this._addItem(_29,req.start+idx,true);},this);this.updateRows(req.start,_28.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(_5("ie")){_9.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_2a,_2b){_2a=_2a||0;if(this.store&&!this._pending_requests[_2a]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_2a]=true;try{if(this.items){var _2c=this.items;var _2d=this.store;this.rowsPerPage=_2c.length;var req={start:_2a,count:this.rowsPerPage,isRender:_2b};this._onFetchBegin(_2c.length,req);var _2e=0;_2.forEach(_2c,function(i){if(!_2d.isItemLoaded(i)){_2e++;}});if(_2e===0){this._onFetchComplete(_2c,req);}else{var _2f=function(_30){_2e--;if(_2e===0){this._onFetchComplete(_2c,req);}};_2.forEach(_2c,function(i){if(!_2d.isItemLoaded(i)){_2d.loadItem({item:i,onItem:_2f,scope:this});}},this);}}else{this.store.fetch({start:_2a,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_2b,onBegin:_3.hitch(this,"_onFetchBegin"),onComplete:_3.hitch(this,"_onFetchComplete"),onError:_3.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_2a,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var _31=this._by_idx[idx];if(!_31||(_31&&!_31.item)){this._preparePage(idx);return null;}return _31.item;},getItemIndex:function(_32){return this._getItemIndex(_32,false);},_getItemIndex:function(_33,_34){if(!_34&&!this.store.isItem(_33)){return -1;}var _35=this._hasIdentity?this.store.getIdentity(_33):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((_35&&d.idty==_35)||(d.item===_33))){return i;}}return -1;},filter:function(_36,_37){this.query=_36;if(_37){this._clearData();}this._fetch();},_getItemAttr:function(idx,_38){var _39=this.getItem(idx);return (!_39?this.fetchText:this.store.getValue(_39,_38));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_3a){return this._pending_requests[_3a];},_rowToPage:function(_3b){return (this.rowsPerPage?Math.floor(_3b/this.rowsPerPage):_3b);},_pageToRow:function(_3c){return (this.rowsPerPage?this.rowsPerPage*_3c:_3c);},_preparePage:function(_3d){if((_3d<this._bop||_3d>=this._eop)&&!this._addingItem){var _3e=this._rowToPage(_3d);this._needPage(_3e);this._bop=_3e*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_3f){if(!this._pages[_3f]){this._pages[_3f]=true;this._requestPage(_3f);}},_requestPage:function(_40){var row=this._pageToRow(_40);var _41=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_41>0){this._requests++;if(!this._requestsPending(row)){setTimeout(_3.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_42){return _42.field;},_refresh:function(_43){this._clearData();this._fetch(0,_43);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var _44=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof _44=="undefined"){_44=si;}else{_44=si?!_44:_44;}return [{attribute:c.field,descending:_44}];}},styleRowState:function(_45){if(this.store&&this.store.getState){var _46=this.store.getState(_45.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_46[s]){c=" dojoxGridRow-"+s;break;}}_45.customClasses+=c;}},onStyleRow:function(_47){this.styleRowState(_47);this.inherited(arguments);},canEdit:function(_48,_49){return this._canEdit;},_copyAttr:function(idx,_4a){var row={};var _4b={};var src=this.getItem(idx);return this.store.getValue(src,_4a);},doStartEdit:function(_4c,_4d){if(!this._cache[_4d]){this._cache[_4d]=this._copyAttr(_4d,_4c.field);}this.onStartEdit(_4c,_4d);},doApplyCellEdit:function(_4e,_4f,_50){this.store.fetchItemByIdentity({identity:this._by_idx[_4f].idty,onItem:_3.hitch(this,function(_51){var _52=this.store.getValue(_51,_50);if(typeof _52=="number"){_4e=isNaN(_4e)?_4e:parseFloat(_4e);}else{if(typeof _52=="boolean"){_4e=_4e=="true"?true:_4e=="false"?false:_4e;}else{if(_52 instanceof Date){var _53=new Date(_4e);_4e=isNaN(_53.getTime())?_4e:_53;}}}this.store.setValue(_51,_50,_4e);this.onApplyCellEdit(_4e,_4f,_50);})});},doCancelEdit:function(_54){var _55=this._cache[_54];if(_55){this.updateRow(_54);delete this._cache[_54];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_56,_57){var _58=this._cache[_56];this.onApplyEdit(_56);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=_3.hitch(this,function(_59){if(_59.length){_2.forEach(_59,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_a.cell_markupFactory=function(_5a,_5b,_5c){var _5d=_3.trim(_9.attr(_5b,"field")||"");if(_5d){_5c.field=_5d;}_5c.field=_5c.field||_5c.name;var _5e=_3.trim(_9.attr(_5b,"fields")||"");if(_5e){_5c.fields=_5e.split(",");}if(_5a){_5a(_5b,_5c);}};_a.markupFactory=function(_5f,_60,_61,_62){return _7.markupFactory(_5f,_60,_61,_3.partial(_a.cell_markupFactory,_62));};return _a;});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_63,_64,_65,_66,_67,has,_68,_69,_6a){return _65("dojox.grid._FocusManager",null,{constructor:function(_6b){this.grid=_6b;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_66.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_66.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_66.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_66.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_66.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_66.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_66.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_66.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_66.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_63.forEach(this._connects,_66.disconnect);_63.forEach(this._headerConnects,_66.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_6c,_6d){return (this.cell==_6c)&&(this.rowIndex==_6d);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _63.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_6e){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){_6a.toggleClass(n,this.focusClass,_6e);if(_6e){var sl=this.scrollIntoView();try{if(!this.grid.edit.isEditing()){_69.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){_6a.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}_69.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();this.grid.domNode.focus();}},_initColumnHeaders:function(){_63.forEach(this._headerConnects,_66.disconnect);this._headerConnects=[];var _6f=this._findHeaderCells();for(var i=0;i<_6f.length;i++){this._headerConnects.push(_66.connect(_6f[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_66.connect(_6f[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _70=_68("th",this.grid.viewsHeaderNode);var _71=[];for(var i=0;i<_70.length;i++){var _72=_70[i];var _73=_6a.hasAttr(_72,"tabIndex");var _74=_6a.attr(_72,"tabIndex");if(_73&&_74<0){_71.push(_72);}}return _71;},_setActiveColHeader:function(_75,_76,_77){this.grid.domNode.setAttribute("aria-activedescendant",_75.id);if(_77!=null&&_77>=0&&_77!=_76){_6a.toggleClass(this._findHeaderCells()[_77],this.focusClass,false);}_6a.toggleClass(_75,this.focusClass,true);this._colHeadNode=_75;this._colHeadFocusIdx=_76;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var _78=(this.cell?this._scrollInfo(this.cell):null);if(!_78||!_78.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(_78.n&&_78.sr){if(_78.n.offsetLeft+_78.n.offsetWidth>_78.sr.l+_78.sr.w){_78.s.scrollLeft=_78.n.offsetLeft+_78.n.offsetWidth-_78.sr.w;}else{if(_78.n.offsetLeft<_78.sr.l){_78.s.scrollLeft=_78.n.offsetLeft;}}}if(_78.r&&_78.sr){if(rt+_78.r.offsetHeight>_78.sr.t+_78.sr.h){this.grid.setScrollTop(rt+_78.r.offsetHeight-_78.sr.h);}else{if(rt<_78.sr.t){this.grid.setScrollTop(rt);}}}return _78.s.scrollLeft;},_scrollInfo:function(_79,_7a){if(_79){var cl=_79,sbn=cl.view.scrollboxNode,_7b={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:_7b,n:(_7a?_7a:_79.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_7c){var _7d=null;if(this._colHeadNode){var _7e=this.grid.getCell(_7c);if(!_7e){return;}_7d=this._scrollInfo(_7e,_7e.getNode(0));}if(_7d&&_7d.s&&_7d.sr&&_7d.n){var _7f=_7d.sr.l+_7d.sr.w;if(_7d.n.offsetLeft+_7d.n.offsetWidth>_7f){_7d.s.scrollLeft=_7d.n.offsetLeft+_7d.n.offsetWidth-_7d.sr.w;}else{if(_7d.n.offsetLeft<_7d.sr.l){_7d.s.scrollLeft=_7d.n.offsetLeft;}else{if(has("ie")<=7&&_7e&&_7e.view.headerNode){_7e.view.headerNode.scrollLeft=_7d.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _80=this.focusView;if(!_80){for(var i=0,_81;(_81=this.grid.views.views[i]);i++){if(_81.headerNode){_80=_81;break;}}}return (_80&&_6a.getComputedStyle(_80.headerNode).display=="none");},colSizeAdjust:function(e,_82,_83){var _84=this._findHeaderCells();var _85=this.focusView;if(!_85){for(var i=0,_86;(_86=this.grid.views.views[i]);i++){if(_86.header.tableMap.map){_85=_86;break;}}}var _87=_84[_82];if(!_85||(_82==_84.length-1&&_82===0)){return;}_85.content.baseDecorateEvent(e);e.cellNode=_87;e.cellIndex=_85.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(_85.header.canResize(e)){var _88={l:_83};var _89=_85.header.colResizeSetup(e,false);_85.header.doResizeColumn(_89,null,_88);_85.update();}},styleRow:function(_8a){return;},setFocusIndex:function(_8b,_8c){this.setFocusCell(this.grid.getCell(_8c),_8b);},setFocusCell:function(_8d,_8e){if(_8d&&!this.isFocusCell(_8d,_8e)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_8d;this.rowIndex=_8e;this._focusifyCellNode(true);}if(has("opera")){setTimeout(_64.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _8f=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_8f.editable||this.grid.canEdit&&!this.grid.canEdit(_8f,row))){this.cell=_8f;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _90=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_90.editable){this.cell=_90;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_91,_92){var _93=_92<0?-1:1;if(this.isNavHeader()){var _94=this._findHeaderCells();var _95=currentIdx=_63.indexOf(_94,this._colHeadNode);currentIdx+=_92;while(currentIdx>=0&&currentIdx<_94.length&&_94[currentIdx].style.display=="none"){currentIdx+=_93;}if((currentIdx>=0)&&(currentIdx<_94.length)){this._setActiveColHeader(_94[currentIdx],currentIdx,_95);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_91));if(_91){if(_91>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_91<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_92));var _96=this.grid.getCell(col);while(col>=0&&col<cc&&_96&&_96.hidden===true){col+=_93;_96=this.grid.getCell(col);}if(!_96||_96.hidden===true){col=i;}var n=_96.getNode(row);if(!n&&_91){if((row+_91)>=0&&(row+_91)<=rc){this.move(_91>0?++_91:--_91,_92);}return;}else{if((!n||_6a.style(n,"display")==="none")&&_92){if((col+_91)>=0&&(col+_91)<=cc){this.move(_91,_92>0?++_92:--_92);}return;}}this.setFocusIndex(row,col);if(_91){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_67.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_67.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){_6a.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _97=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_67.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_67.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_98){this.tabbingOut=true;_98.focus();},focusGridView:function(){_69.fire(this.focusView,"focus");},focusGrid:function(_99){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _9a=true;var _9b=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_9b){var _9c=0;var _9d=this.grid.getCell(_9c);if(_9d.hidden){_9c=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_9c);}else{if(this.cell&&!_9b){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_9a=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _9a;},focusHeader:function(){var _9e=this._findHeaderCells();var _9f=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_9e[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_9e.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_9e[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_9f);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){_6a.removeClass(this._colHeadNode,this.focusClass);_6a.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _a0=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_a0);this._contextMenuBindNode=_a0;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_67.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_67.stop(e);},doBlur:function(e){_67.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_67.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_67.stop(e);},doLastNodeBlur:function(e){_67.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,_6a.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_67.stop(e);},doColHeaderBlur:function(e){_6a.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"esri/toolbars/_VertexEditor":function(){define(["dijit","dojo","dojox","dojo/require!dijit/Menu,esri/toolbars/_VertexMover"],function(_a1,_a2,_a3){_a2.provide("esri.toolbars._VertexEditor");_a2.require("dijit.Menu");_a2.require("esri.toolbars._VertexMover");_a2.declare("esri.toolbars._GraphicVertexEditor",null,{constructor:function(_a4,map,_a5){this.graphic=_a4;this.map=map;this.toolbar=_a5;var _a6=_a5._options;this._symbol1=_a6.vertexSymbol;this._symbol2=_a6.ghostVertexSymbol;var _a7=_a6.ghostLineSymbol;this._lineStroke={style:_a7.style,width:_a7.width,color:_a7.color};this._canDel=_a6.allowDeleteVertices;this._canAdd=_a6.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_a8){if(_a8){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=_a2.connect(esri.toolbars.VertexMover,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=_a2.connect(esri.toolbars.VertexMover,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _a9=this._getGraphicsLayer();this._mouseOverHandle=_a2.connect(_a9,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=_a2.connect(_a9,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new _a1.Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _aa=(this._ctxDelete=new _a1.MenuItem({label:esri.bundle.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=_a2.connect(_aa,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_aa);this._ctxMenu.startup();}},_removeControllers:function(){_a2.disconnect(this._firstMoveHandle);_a2.disconnect(this._moveStopHandle);_a2.disconnect(this._mouseOverHandle);_a2.disconnect(this._mouseOutHandle);_a2.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_ab,_ac,_ad){var i,j,_ae=this.graphic,_af=[];for(i=0;i<_ab.length;i++){var _b0=_ab[i],_b1=[];for(j=0;j<_b0.length;j++){_b1.push(new esri.toolbars.VertexMover(_b0[j],_ac,_ae,i,j,_b0.length,this,_ad));}_af.push(_b1);}return _af;},_remove:function(_b2){if(_b2){_a2.forEach(_b2,function(_b3){_a2.forEach(_b3,function(_b4){_b4.destroy();});});}},_refresh:function(_b5){if(_b5){_a2.forEach(_b5,function(_b6){_a2.forEach(_b6,function(_b7){_b7.refresh();});});}},_isNew:function(_b8){return (_a2.indexOf(this._vertexMovers[_b8.segIndex],_b8)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _b9=this._selectedMover,_ba=_b9.ptIndex;this._updateRelatedGraphic(_b9,_b9.relatedGraphic,_b9.graphic.geometry,_b9.segIndex,_b9.ptIndex,_b9.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_b9);}this._deleteVertex(_b9);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _bb=evt.graphic,_bc=this._findMover(_bb);if(_bc){this.toolbar.onVertexMouseOver(this.graphic,_bc._getInfo());if(!_bc._placeholder){this._selectedMover=_bc;if(this._canDel){this._bindCtxNode(_bb.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _bd=evt.graphic,_be=this._findMover(_bd);if(_be){this.toolbar.onVertexMouseOut(this.graphic,_be._getInfo());}},_bindCtxNode:function(_bf){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(_bf);this._bindNode=_bf;},_unbindCtxNode:function(){var _c0=this._bindNode;if(_c0){this._ctxMenu.unBindDomNode(_c0);}},_findMover:function(_c1){var i,_c2=[],_c3=this._mpVertexMovers;_a2.forEach(this._vertexMovers,function(_c4){_c2=_c2.concat(_c4);});if(_c3){_a2.forEach(_c3,function(_c5){_c2=_c2.concat(_c5);});}for(i=0;i<_c2.length;i++){var _c6=_c2[i];if(_c6.graphic===_c1){return _c6;}}},_firstMoveHandler:function(_c7){if(!this._isNew(_c7)&&this._canAdd){this._hideRelatedMidpoints(_c7);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_c8,tx){var add=this._isNew(_c8);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_c8);}return;}this._updateRelatedGraphic(_c8,_c8.relatedGraphic,_c8.graphic.geometry,_c8.segIndex,_c8.ptIndex,_c8.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_c8);}else{this._repositionRelatedMidpoints(_c8);this._showRelatedMidpoints(_c8);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_c9){var i,_ca=this._getAdjacentMidpoints(_c9.ptIndex,_c9.segLength),_cb=this._mpVertexMovers[_c9.segIndex];for(i=0;i<_ca.length;i++){var mvr=_cb[_ca[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_cc){var i,_cd=this._getAdjacentMidpoints(_cc.ptIndex,_cc.segLength),_ce=this._mpVertexMovers[_cc.segIndex];for(i=0;i<_cd.length;i++){_ce[_cd[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_cf){var i,_d0=this._getAdjacentMidpoints(_cf.ptIndex,_cf.segLength),_d1=this._mpVertexMovers[_cf.segIndex];for(i=0;i<_d0.length;i++){var _d2=this._getAdjacentVertices(_d0[i],_cf.segLength);var _d3=_cf.relatedGraphic.geometry.getPoint(_cf.segIndex,_d2[0]),_d4=_cf.relatedGraphic.geometry.getPoint(_cf.segIndex,_d2[1]);var _d5=new esri.geometry.Point({x:(_d3.x+_d4.x)/2,y:(_d3.y+_d4.y)/2,spatialReference:_d3.spatialReference.toJson()});_d1[_d0[i]].graphic.setGeometry(_d5);}},_addMidpoints:function(_d6){var _d7=_d6.segIndex,_d8=_d6.ptIndex,_d9=_d6.segLength;var _da=_d8+1;var i,_db=_d9+1;this._mpVertexMovers[_d7].splice(_d8,1);var _dc=this._vertexMovers[_d7];for(i=0;i<_da;i++){_dc[i].segLength+=1;}for(i=_da;i<_dc.length;i++){_dc[i].ptIndex+=1;_dc[i].segLength+=1;}_d6.ptIndex=_da;_d6.segLength=_dc.length+1;_dc.splice(_da,0,_d6);_d6.graphic.setSymbol(this._symbol1);_dc=this._mpVertexMovers[_d7];for(i=0;i<_d8;i++){_dc[i].segLength+=1;}for(i=_d8;i<_d9-1;i++){_dc[i].ptIndex+=1;_dc[i].segLength+=1;}var _dd=this._getAdjacentVertices(_d8,_db);var _de=this._getAdjacentVertices(_d8+1,_db);var _df,_e0;_df=_d6.relatedGraphic.geometry.getPoint(_d6.segIndex,_dd[0]);_e0=_d6.relatedGraphic.geometry.getPoint(_d6.segIndex,_dd[1]);var _e1=new esri.geometry.Point({x:(_df.x+_e0.x)/2,y:(_df.y+_e0.y)/2,spatialReference:_df.spatialReference.toJson()});_df=_d6.relatedGraphic.geometry.getPoint(_d6.segIndex,_de[0]);_e0=_d6.relatedGraphic.geometry.getPoint(_d6.segIndex,_de[1]);var _e2=new esri.geometry.Point({x:(_df.x+_e0.x)/2,y:(_df.y+_e0.y)/2,spatialReference:_df.spatialReference.toJson()});var _e3=new esri.toolbars.VertexMover(_e1,this._symbol2,this.graphic,_d6.segIndex,_d8,_db,this,true);var _e4=new esri.toolbars.VertexMover(_e2,this._symbol2,this.graphic,_d6.segIndex,_d8+1,_db,this,true);_dc.splice(_d8,0,_e3,_e4);},_deleteVertex:function(_e5){var i,_e6=_e5.segIndex,_e7=_e5.ptIndex;var _e8=this._vertexMovers[_e6];for(i=0;i<_e7;i++){_e8[i].segLength-=1;}for(i=_e7+1;i<_e8.length;i++){var mvr=_e8[i];mvr.ptIndex-=1;mvr.segLength-=1;}_e8.splice(_e7,1);var _e9=_e5._getInfo();_e5.destroy();this.toolbar.onVertexDelete(this.graphic,_e9);}});_a2.mixin(esri.toolbars._GraphicVertexEditor,{create:function(_ea,map,_eb){var _ec=_ea.geometry.type;switch(_ec){case "multipoint":return new esri.toolbars._MultipointVertexEditor(_ea,map,_eb);break;case "polyline":return new esri.toolbars._PolylineVertexEditor(_ea,map,_eb);break;case "polygon":return new esri.toolbars._PolygonVertexEditor(_ea,map,_eb);break;}}});_a2.declare("esri.toolbars._MultipointVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:1,constructor:function(){this._moveStartHandle=_a2.connect(esri.toolbars.VertexMover,"onMoveStart",this,this._moveStartHandler);_a2.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);_a2.disconnect(this._moveStartHandle);},_getSegments:function(_ed){var i,_ee=_ed.points,_ef=[],sr=_ed.spatialReference;for(i=0;i<_ee.length;i++){var _f0=_ee[i];_ef.push(new esri.geometry.Point({x:_f0[0],y:_f0[1],spatialReference:sr.toJson()}));}return [_ef];},_getMidpointSegments:function(_f1){return [];},_getControlPoints:function(_f2,_f3,_f4,_f5,_f6){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _f7=evt.graphic,_f8=this._findMover(evt);if(_f8){this.toolbar.onVertexMouseOver(_f7,_f8._getInfo());this._selectedMover=_f8;if(this._canDel){this._bindCtxNode(_f8.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _f9=evt.graphic,_fa=this._findMover(evt);if(_fa){this.toolbar.onVertexMouseOut(_f9,_fa._getInfo());}},_findMover:function(evt){var i,_fb=[].concat(this._vertexMovers[0]),_fc=evt.target;for(i=0;i<_fb.length;i++){var _fd=_fb[i];if(_fd.graphic.getDojoShape().getNode()===_fc){return _fd;}}},_moveStartHandler:function(_fe){var _ff=_fe.relatedGraphic.geometry,_100=_fe.ptIndex;var _101=_fe.segLength-1;var _102=_ff.points;var _103=_102.splice(_100,1);_102.push(_103[0]);var j,_104=this._vertexMovers[0];for(j=_101;j>_100;j--){_104[j].ptIndex-=1;}_103=_104.splice(_100,1);_104.push(_103[0]);_103[0].ptIndex=_101;},_moveStopHandler:function(_105){this._updateRelatedGraphic(_105,_105.relatedGraphic,_105.graphic.geometry,_105.segIndex,_105.ptIndex,_105.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_106,_107,_108,_109,_10a,_10b,add,del){var geom=_107.geometry;if(del){geom.removePoint(_10a);}else{geom.setPoint(_10a,_108);}_107.setGeometry(geom);},_deleteMidpoints:function(_10c){}});_a2.declare("esri.toolbars._PolylineVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:2,_getSegments:function(_10d){var i,j,_10e=_10d.paths,_10f=[];for(i=0;i<_10e.length;i++){var path=_10e[i],_110=[];for(j=0;j<path.length;j++){_110.push(_10d.getPoint(i,j));}_10f.push(_110);}return _10f;},_getMidpointSegments:function(_111){var i,j,_112=_111.paths,_113=[],sr=_111.spatialReference;for(i=0;i<_112.length;i++){var path=_112[i],_114=[];for(j=0;j<path.length-1;j++){var _115=_111.getPoint(i,j),_116=_111.getPoint(i,j+1);var midX=(_115.x+_116.x)/2,midY=(_115.y+_116.y)/2;var _117=new esri.geometry.Point({x:midX,y:midY,spatialReference:sr.toJson()});_114.push(_117);}_113.push(_114);}return _113;},_getControlPoints:function(_118,_119,_11a,_11b,_11c){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_118)){idx1=_11b;idx2=_11b+1;if(idx1>=0){pt1=map.toScreen(_119.getPoint(_11a,idx1));}if(idx2<=_11c){pt2=map.toScreen(_119.getPoint(_11a,idx2));}}else{idx1=_11b-1;idx2=_11b+1;if(idx1>=0){pt1=map.toScreen(_119.getPoint(_11a,idx1));}if(idx2<_11c){pt2=map.toScreen(_119.getPoint(_11a,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_11d,_11e){var _11f=[];var idx1=_11d-1;if(idx1>=0){_11f.push(idx1);}var idx2=_11d;if(idx2<_11e-1){_11f.push(idx2);}return _11f;},_getAdjacentVertices:function(_120,_121){return [_120,_120+1];},_deleteMidpoints:function(_122){var _123=_122.segIndex,_124=_122.ptIndex,_125=_122.segLength;var _126=this._mpVertexMovers[_123],_127=_126.length-1;var _128=this._getAdjacentMidpoints(_124,_125).sort();var i,min=_128[0];for(i=0;i<min;i++){_126[i].segLength-=1;}for(i=min+1;i<_126.length;i++){var mvr=_126[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_128.length===1){_126.splice(min,1)[0].destroy();}else{var _129=this._getAdjacentVertices(min,_127);var _12a=_122.relatedGraphic.geometry.getPoint(_122.segIndex,_129[0]);var _12b=_122.relatedGraphic.geometry.getPoint(_122.segIndex,_129[1]);var _12c=new esri.geometry.Point({x:(_12a.x+_12b.x)/2,y:(_12a.y+_12b.y)/2,spatialReference:_12a.spatialReference.toJson()});var mvr1=new esri.toolbars.VertexMover(_12c,this._symbol2,this.graphic,_122.segIndex,min,_127,this,true);var _12d=_126.splice(min,_128.length,mvr1);for(i=0;i<_12d.length;i++){_12d[i].destroy();}}},_updateRelatedGraphic:function(_12e,_12f,_130,_131,_132,_133,add,del){var geom=_12f.geometry;if(add){geom.insertPoint(_131,_132+1,esri.geometry.fromJson(_130.toJson()));}else{if(del){geom.removePoint(_131,_132);}else{geom.setPoint(_131,_132,esri.geometry.fromJson(_130.toJson()));}}_12f.setGeometry(geom);}});_a2.declare("esri.toolbars._PolygonVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:3,_getSegments:function(_134){var i,j,_135=_134.rings,_136=[];for(i=0;i<_135.length;i++){var ring=_135[i],_137=[];for(j=0;j<ring.length-1;j++){_137.push(_134.getPoint(i,j));}_136.push(_137);}return _136;},_getMidpointSegments:function(_138){var i,j,_139=_138.rings,_13a=[],sr=_138.spatialReference;for(i=0;i<_139.length;i++){var ring=_139[i],_13b=[];for(j=0;j<ring.length-1;j++){var _13c=_138.getPoint(i,j),_13d=_138.getPoint(i,j+1);var midX=(_13c.x+_13d.x)/2,midY=(_13c.y+_13d.y)/2;var _13e=new esri.geometry.Point({x:midX,y:midY,spatialReference:sr.toJson()});_13b.push(_13e);}_13a.push(_13b);}return _13a;},_getControlPoints:function(_13f,_140,_141,_142,_143){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_13f)){idx1=_142;idx2=(_142+1)%_143;}else{idx1=_142-1;idx1=idx1<0?(_143+idx1)%_143:idx1;idx2=(_142+1)%_143;}pt1=map.toScreen(_140.getPoint(_141,idx1));pt2=map.toScreen(_140.getPoint(_141,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_144,_145){var idx1=_144-1;idx1=idx1<0?(_145+idx1)%_145:idx1;var idx2=_144;return [idx1,idx2];},_getAdjacentVertices:function(_146,_147){return [_146,(_146+1)%_147];},_deleteMidpoints:function(_148){var _149=_148.segIndex,_14a=_148.ptIndex,_14b=_148.segLength;var _14c=this._mpVertexMovers[_149],_14d=_14c.length-1,_14e=this._getAdjacentMidpoints(_14a,_14b).sort(),_14f,_150,_151,_152,i,mvr1,mvr,min=_14e[0],max=_14e[_14e.length-1];if(_14a===0){_14f=this._getAdjacentVertices(_14d-1,_14d);_150=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14f[0]);_151=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14f[1]);_152=new esri.geometry.Point({x:(_150.x+_151.x)/2,y:(_150.y+_151.y)/2,spatialReference:_150.spatialReference.toJson()});mvr1=new esri.toolbars.VertexMover(_152,this._symbol2,this.graphic,_148.segIndex,_14d-1,_14d,this,true);_14c.splice(max,1,mvr1)[0].destroy();_14c.splice(min,1)[0].destroy();for(i=0;i<_14c.length-1;i++){mvr=_14c[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_14f=this._getAdjacentVertices(min,_14d);_150=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14f[0]);_151=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14f[1]);_152=new esri.geometry.Point({x:(_150.x+_151.x)/2,y:(_150.y+_151.y)/2,spatialReference:_150.spatialReference.toJson()});mvr1=new esri.toolbars.VertexMover(_152,this._symbol2,this.graphic,_148.segIndex,min,_14d,this,true);var _153=_14c.splice(min,_14e.length,mvr1);for(i=0;i<_153.length;i++){_153[i].destroy();}for(i=0;i<min;i++){_14c[i].segLength-=1;}for(i=min+1;i<_14c.length;i++){mvr=_14c[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_154,_155,_156,_157,_158,_159,add,del){var geom=_155.geometry;if(add){geom.insertPoint(_157,_158+1,esri.geometry.fromJson(_156.toJson()));}else{if(del){geom.removePoint(_157,_158);if(_158===0){geom.setPoint(_157,_159-1,esri.geometry.fromJson(geom.getPoint(_157,0).toJson()));}}else{geom.setPoint(_157,_158,esri.geometry.fromJson(_156.toJson()));if(_158===0){geom.setPoint(_157,_159,esri.geometry.fromJson(_156.toJson()));}}}_155.setGeometry(geom);}});});},"dojo/dnd/Selector":function(){define(["../main","./common","./Container"],function(dojo){dojo.declare("dojo.dnd.Selector",dojo.dnd.Container,{constructor:function(node,_15a){if(!_15a){_15a={};}this.singular=_15a.singular;this.autoSync=_15a.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(dojo.connect(this.node,"onmousedown",this,"onMouseDown"),dojo.connect(this.node,"onmouseup",this,"onMouseUp"));},singular:false,getSelectedNodes:function(){var t=new dojo.NodeList();var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dojo.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dojo.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dojo.byId(i);this.delItem(i);dojo.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||dojo.global;var s=this.selection,e=dojo.dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){dojo.dnd.Selector.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}dojo.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_15b,data,_15c,_15d){var _15e=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_15e.call(this,item,hint);if(_15b){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};dojo.dnd.Selector.superclass.insertNodes.call(this,data,_15c,_15d);this._normalizedCreator=_15e;return this;},destroy:function(){dojo.dnd.Selector.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dojo.isCopyKey(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(e.button===dojo.mouseButtons.LEFT){dojo.stopEvent(e);}return;}if(!this.singular&&e.shiftKey){if(!dojo.isCopyKey(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0;for(;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dojo.isCopyKey(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dojo.isCopyKey(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}dojo.stopEvent(e);},onMouseUp:function(e){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(e){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=dojo.connect(this.node,"onmousemove",this,"onMouseMove");},onOutEvent:function(){dojo.disconnect(this.onmousemoveEvent);delete this.onmousemoveEvent;},_removeSelection:function(){var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dojo.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return dojo.dnd.Selector;});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["./popup","dojo/window","./_Widget","./_KeyNavContainer","./_TemplatedMixin","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/_base/array"],function(pm,_15f,_160,_161,_162,_163,dom,_164,_165,lang,_166){return _163("dijit._MenuBase",[_160,_162,_161],{parentMenu:null,popupDelay:500,onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.focusedChild._onClick(evt);}else{var _167=this._getTopMenu();if(_167&&_167._isMenuBar){_167.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _168=this.currentPopup.parentMenu;if(_168.focusedChild){_168.focusedChild._setSelected(false);}_168.focusedChild=this.currentPopup.from_item;_168.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=setTimeout(lang.hitch(this,"_openPopup"),this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _169=item.popup;if(_169){this._stopPendingCloseTimer(_169);_169._pendingClose_timer=setTimeout(function(){_169._pendingClose_timer=null;if(_169.parentMenu){_169.parentMenu.currentPopup=null;}pm.close(_169);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}},_stopPopupTimer:function(){if(this.hover_timer){clearTimeout(this.hover_timer);this.hover_timer=null;}},_stopPendingCloseTimer:function(_16a){if(_16a._pendingClose_timer){clearTimeout(_16a._pendingClose_timer);_16a._pendingClose_timer=null;}},_stopFocusTimer:function(){if(this._focus_timer){clearTimeout(this._focus_timer);this._focus_timer=null;}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup();}else{this.onExecute();item.onClick(evt);}},_openPopup:function(){this._stopPopupTimer();var _16b=this.focusedChild;if(!_16b){return;}var _16c=_16b.popup;if(_16c.isShowingNow){return;}if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_16c.parentMenu=this;_16c.from_item=_16b;var self=this;pm.open({parent:this,popup:_16c,around:_16b.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_16b);self._cleanUp();_16b._setSelected(true);self.focusedChild=_16b;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_16c;_16c.connect(_16c.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));if(_16c.focus){_16c._focus_timer=setTimeout(lang.hitch(_16c,function(){this._focus_timer=null;this.focus();}),0);}},_markActive:function(){this.isActive=true;_165.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_165.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_166.indexOf(this._focusManager.activeStack,this.id)>=0){_164.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.focusedChild._onUnhover();this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this._hoveredChild._onUnhover();}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_16d,lang,has,_16e,_16f,_170,_171){var dhm=lang.getObject("dojox.html.metrics",true);var _172=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _173={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_170.doc.documentElement.style.fontSize="100%";}var div=_170.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_170.body().appendChild(div);for(var p in _173){ds.fontSize=p;_173[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_170.body().removeChild(div);div=null;return _173;};var _174=null;dhm.getCachedFontMeasurements=function(_175){if(_175||!_174){_174=dhm.getFontMeasurements();}return _174;};var _176=null,_177={};dhm.getTextBox=function(text,_178,_179){var m,s;if(!_176){m=_176=_170.doc.createElement("div");var c=_170.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_170.body().appendChild(c);}else{m=_176;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_178){for(var i in _178){if(i in _177){continue;}s[i]=_178[i];}}if(arguments.length>2&&_179){m.className=_179;}m.innerHTML=text;var box=_171.position(m);box.w=m.parentNode.scrollWidth;return box;};var _17a={w:16,h:16};dhm.getScrollbar=function(){return {w:_17a.w,h:_17a.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_17b){var f=dhm._fontResizeNode=_170.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_172._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_172._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_170.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_16f.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_16e(function(){try{var n=_170.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_170.body().appendChild(n);_17a.w=n.offsetWidth-n.clientWidth;_17a.h=n.offsetHeight-n.clientHeight;_170.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _16d.config&&!!_16d.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_17c,_17d){return _17c("dojox.grid._RowSelector",_17d,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_17e,_17f){var w=this.contentWidth||0;_17f.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_180,_181){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_180)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_180)){n.push("dojoxGridRowbarSelected");}_181.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"dojo/dnd/Manager":function(){define(["../main","../Evented","./common","./autoscroll","./Avatar"],function(dojo,_182){var _183=dojo.declare("dojo.dnd.Manager",[_182],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:16,OFFSET_Y:16,overSource:function(_184){if(this.avatar){this.target=(_184&&_184.targetState!="Disabled")?_184:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}dojo.publish("/dnd/source/over",[_184]);},outSource:function(_185){if(this.avatar){if(this.target==_185){this.target=null;this.canDropFlag=false;this.avatar.update();dojo.publish("/dnd/source/over",[null]);}}else{dojo.publish("/dnd/source/over",[null]);}},startDrag:function(_186,_187,copy){this.source=_186;this.nodes=_187;this.copy=Boolean(copy);this.avatar=this.makeAvatar();dojo.body().appendChild(this.avatar.node);dojo.publish("/dnd/start",[_186,_187,this.copy]);this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp"),dojo.connect(dojo.doc,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent)];var c="dojoDnd"+(copy?"Copy":"Move");dojo.addClass(dojo.body(),c);},canDrop:function(flag){var _188=Boolean(this.target&&flag);if(this.canDropFlag!=_188){this.canDropFlag=_188;this.avatar.update();}},stopDrag:function(){dojo.removeClass(dojo.body(),["dojoDndCopy","dojoDndMove"]);dojo.forEach(this.events,dojo.disconnect);this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new dojo.dnd.Avatar(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){dojo.dnd.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dojo.isCopyKey(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dojo.isCopyKey(e))),_189=[this.source,this.nodes,copy,this.target,e];dojo.publish("/dnd/drop/before",_189);dojo.publish("/dnd/drop",_189);}else{dojo.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case dojo.keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case dojo.keys.ESCAPE:dojo.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==dojo.keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();dojo.replaceClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dojo.dnd._manager=null;_183.manager=dojo.dnd.manager=function(){if(!dojo.dnd._manager){dojo.dnd._manager=new dojo.dnd.Manager();}return dojo.dnd._manager;};return _183;});},"dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_18a,_18b,lang,_18c){return _18a("dojox.grid.Selection",null,{constructor:function(_18d){this.grid=_18d;this.selected=[];this.setMode(_18d.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_18e){return this.grid.onCanSelect(_18e);},onCanDeselect:function(_18f){return this.grid.onCanDeselect(_18f);},onSelected:function(_190){},onDeselected:function(_191){},onChanging:function(){},onChanged:function(){},isSelected:function(_192){if(this.mode=="none"){return false;}return this.selected[_192];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_193){if(this.mode=="none"){return -1;}for(var i=_193+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _194=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_194.push(i);}}return _194;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_195){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_195);this.addToSelection(_195);}else{this.toggleSelect(_195);}},addToSelection:function(_196){if(this.mode=="none"){return;}if(lang.isArray(_196)){_18b.forEach(_196,this.addToSelection,this);return;}_196=Number(_196);if(this.selected[_196]){this.selectedIndex=_196;}else{if(this.onCanSelect(_196)!==false){this.selectedIndex=_196;var _197=this.grid.getRowNode(_196);if(_197){_18c.set(_197,"aria-selected","true");}this._beginUpdate();this.selected[_196]=true;this.onSelected(_196);this._endUpdate();}}},deselect:function(_198){if(this.mode=="none"){return;}if(lang.isArray(_198)){_18b.forEach(_198,this.deselect,this);return;}_198=Number(_198);if(this.selectedIndex==_198){this.selectedIndex=-1;}if(this.selected[_198]){if(this.onCanDeselect(_198)===false){return;}var _199=this.grid.getRowNode(_198);if(_199){_18c.set(_199,"aria-selected","false");}this._beginUpdate();delete this.selected[_198];this.onDeselected(_198);this._endUpdate();}},setSelected:function(_19a,_19b){this[(_19b?"addToSelection":"deselect")](_19a);},toggleSelect:function(_19c){if(lang.isArray(_19c)){_18b.forEach(_19c,this.toggleSelect,this);return;}this.setSelected(_19c,!this.selected[_19c]);},_range:function(_19d,inTo,func){var s=(_19d>=0?_19d:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_19e,inTo){this._range(_19e,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_19f,inTo){this._range(_19f,inTo,lang.hitch(this,"deselect"));},insert:function(_1a0){this.selected.splice(_1a0,0,false);if(this.selectedIndex>=_1a0){this.selectedIndex++;}},remove:function(_1a1){this.selected.splice(_1a1,1);if(this.selectedIndex>=_1a1){this.selectedIndex--;}},deselectAll:function(_1a2){for(var i in this.selected){if((i!=_1a2)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_1a3,_1a4,_1a5){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_1a3);}else{var _1a6=this.selectedIndex;if(!_1a4){this.deselectAll(_1a3);}if(_1a5){this.selectRange(_1a6,_1a3);}else{if(_1a4){this.toggleSelect(_1a3);}else{this.addToSelection(_1a3);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"esri/toolbars/_Box":function(){define(["dijit","dojo","dojox","dojo/require!dojox/gfx/Moveable,dojox/gfx/matrix"],function(_1a7,dojo,_1a8){dojo.provide("esri.toolbars._Box");dojo.require("dojox.gfx.Moveable");dojo.require("dojox.gfx.matrix");dojo.declare("esri.toolbars._Box",null,{constructor:function(_1a9,map,_1aa,_1ab,_1ac){this._graphic=_1a9;this._map=map;this._toolbar=_1aa;this._scale=_1ab;this._rotate=_1ac;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";var _1ad=_1aa._options;this._markerSymbol=_1ad.boxHandleSymbol;this._lineSymbol=_1ad.boxLineSymbol;this._moveStartHandler=dojo.hitch(this,this._moveStartHandler);this._firstMoveHandler=dojo.hitch(this,this._firstMoveHandler);this._moveStopHandler=dojo.hitch(this,this._moveStopHandler);this._moveHandler=dojo.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){dojo.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){dojo.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){dojo.forEach(this._connects,dojo.disconnect,dojo);}var _1ae=this._toolbar._scratchGL;if(this._anchors){dojo.forEach(this._anchors,function(info){_1ae.remove(info.graphic);var mov=info.moveable;if(mov){mov.destroy();}});}if(this._box){_1ae.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_1af=this._toolbar._scratchGL;var _1b0=this._getBoxCoords();var _1b1=new esri.geometry.Polyline(map.spatialReference);var path=dojo.clone(dojo.filter(_1b0,function(pt,_1b2){return (_1b2!==8&&_1b2%2===0);}));if(path[0]){path.push([path[0][0],path[0][1]]);}_1b1.addPath(path);if(this._rotate){_1b1.addPath([_1b0[1],_1b0[8]]);}if(this._box){this._box.setGeometry(_1b1);}else{this._box=new esri.Graphic(_1b1,this._lineSymbol);_1af.add(this._box);}if(this._anchors){dojo.forEach(this._anchors,function(info,_1b3){if(!this._scale){_1b3=8;}var _1b4=new esri.geometry.Point(_1b0[_1b3],map.spatialReference);info.graphic.setGeometry(_1b4);var mov=info.moveable,_1b5=info.graphic.getDojoShape();if(_1b5){if(!mov){info.moveable=this._getMoveable(info.graphic,_1b3);}else{if(_1b5!==mov.shape){mov.destroy();info.moveable=this._getMoveable(info.graphic,_1b3);}}}},this);}else{this._anchors=[];this._connects=[];dojo.forEach(_1b0,function(_1b6,_1b7){if(!this._scale&&_1b7<8){return;}_1b6=new esri.geometry.Point(_1b6,map.spatialReference);var _1b8=new esri.Graphic(_1b6,this._markerSymbol);_1af.add(_1b8);this._anchors.push({graphic:_1b8,moveable:this._getMoveable(_1b8,_1b7)});},this);}},_getBoxCoords:function(_1b9){var _1ba=this._graphic,map=this._map,bbox=this._getTransformedBoundingBox(_1ba),_1bb=[],pt,next,_1bc;dojo.forEach(bbox,function(_1bd,_1be,arr){pt=_1bd;next=arr[_1be+1];if(!next){next=arr[0];}_1bc={x:(pt.x+next.x)/2,y:(pt.y+next.y)/2};if(!_1b9){pt=map.toMap(pt);_1bc=map.toMap(_1bc);}_1bb.push([pt.x,pt.y]);_1bb.push([_1bc.x,_1bc.y]);});if(this._rotate){var _1bf=dojo.clone(_1bb[1]);_1bf=_1b9?{x:_1bf[0],y:_1bf[1]}:map.toScreen({x:_1bf[0],y:_1bf[1]});_1bf.y-=this._toolbar._options.rotateHandleOffset;if(!_1b9){_1bf=map.toMap(_1bf);}_1bb.push([_1bf.x,_1bf.y]);}return _1bb;},_getTransformedBoundingBox:function(_1c0){var map=this._map;var _1c1=_1c0.geometry.getExtent();var _1c2=new esri.geometry.Point(_1c1.xmin,_1c1.ymax);var _1c3=new esri.geometry.Point(_1c1.xmax,_1c1.ymin);_1c2=map.toScreen(_1c2);_1c3=map.toScreen(_1c3);return [{x:_1c2.x,y:_1c2.y},{x:_1c3.x,y:_1c2.y},{x:_1c3.x,y:_1c3.y},{x:_1c2.x,y:_1c3.y}];},_getAllGraphics:function(){var _1c4=[this._box];if(this._anchors){dojo.forEach(this._anchors,function(_1c5){_1c4.push(_1c5.graphic);});}_1c4=dojo.filter(_1c4,esri._isDefined);return _1c4;},_getMoveable:function(_1c6,_1c7){var _1c8=_1c6.getDojoShape();if(!_1c8){return;}var _1c9=new _1a8.gfx.Moveable(_1c8);_1c9._index=_1c7;this._connects.push(dojo.connect(_1c9,"onMoveStart",this._moveStartHandler));this._connects.push(dojo.connect(_1c9,"onFirstMove",this._firstMoveHandler));this._connects.push(dojo.connect(_1c9,"onMoveStop",this._moveStopHandler));_1c9.onMove=this._moveHandler;var node=_1c8.getEventSource();if(node){dojo.style(node,"cursor",this._toolbar._cursors["box"+_1c7]);}return _1c9;},_moveStartHandler:function(_1ca){this._toolbar["on"+(_1ca.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_1cb){var _1cc=_1cb.host._index,_1cd=(this._wrapOffset=_1cb.host.shape._wrapOffsets[0]||0),_1ce=this._graphic.getLayer()._div.getTransform(),mx=_1a8.gfx.matrix,_1cf,_1d0,_1d1,_1d2=dojo.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_1cd,y:arr[1]};});if(_1cc===8){_1cf=mx.multiplyPoint(mx.invert(_1ce),_1d2[1]);_1d1={x:_1d2[1].x,y:_1d2[3].y};_1d0=mx.multiplyPoint(mx.invert(_1ce),_1d1);this._startLine=[_1d0,_1cf];this._moveLine=dojo.clone(this._startLine);}else{_1cf=mx.multiplyPoint(mx.invert(_1ce),_1d2[_1cc]);_1d0=mx.multiplyPoint(mx.invert(_1ce),_1d2[(_1cc+4)%8]);this._startBox=_1d0;this._startBox.width=(_1d2[4].x-_1d2[0].x);this._startBox.height=(_1d2[4].y-_1d2[0].y);this._moveBox=dojo.clone(this._startBox);this._xfactor=_1cf.x>_1d0.x?1:-1;this._yfactor=_1cf.y>_1d0.y?1:-1;if(_1cc===1||_1cc===5){this._xfactor=0;}else{if(_1cc===3||_1cc===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_1cc===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_1d3,_1d4){var _1d5=_1d3.host._index,args=this._defaultEventArgs,_1d6,move,tx,pt,_1d7,_1d8,_1d9;args.angle=0;args.scaleX=1;args.scaleY=1;if(_1d5===8){_1d6=this._startLine;move=this._moveLine;pt=move[1];pt.x+=_1d4.dx;pt.y+=_1d4.dy;_1d7=this._getAngle(_1d6,move);tx=_1a8.gfx.matrix.rotategAt(_1d7,_1d6[0]);this._graphic.getDojoShape().setTransform(tx);args.transform=tx;args.angle=_1d7;args.around=_1d6[0];}else{_1d6=this._startBox;move=this._moveBox;move.width+=(_1d4.dx*this._xfactor);move.height+=(_1d4.dy*this._yfactor);_1d8=move.width/_1d6.width;_1d9=move.height/_1d6.height;if(isNaN(_1d8)||_1d8===Infinity||_1d8===-Infinity){_1d8=1;}if(isNaN(_1d9)||_1d9===Infinity||_1d9===-Infinity){_1d9=1;}tx=_1a8.gfx.matrix.scaleAt(_1d8,_1d9,_1d6);this._graphic.getDojoShape().setTransform(tx);args.transform=tx;args.scaleX=_1d8;args.scaleY=_1d9;args.around=_1d6;}this._toolbar["on"+(_1d5===8?this._rotateEvent:this._scaleEvent)](this._graphic,args);},_moveStopHandler:function(_1da){var _1db=this._graphic,_1dc=_1db.geometry.toJson(),_1dd=_1db.getDojoShape(),_1de=_1dd.getTransform(),_1df=_1db.getLayer()._div.getTransform();this._updateSegments(_1dc.paths||_1dc.rings,_1de,_1df);_1dd.setTransform(null);_1db.setGeometry(esri.geometry.fromJson(_1dc));this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;this._toolbar._endOperation("BOX");this._defaultEventArgs.transform=_1de;this._toolbar["on"+(_1da.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_1e0,_1e1,_1e2){var mx=_1a8.gfx.matrix,map=this._map,_1e3=this._wrapOffset||0;dojo.forEach(_1e0,function(_1e4){dojo.forEach(_1e4,function(_1e5){var _1e6=map.toScreen({x:_1e5[0],y:_1e5[1]},true);_1e6.x+=_1e3;_1e6=mx.multiplyPoint([_1e2,_1e1,mx.invert(_1e2)],_1e6);_1e6.x-=_1e3;var _1e7=map.toMap(_1e6);_1e5[0]=_1e7.x;_1e5[1]=_1e7.y;});});},_getAngle:function(_1e8,_1e9){var _1ea=Math.atan2(_1e8[0].y-_1e8[1].y,_1e8[0].x-_1e8[1].x)*180/Math.PI,_1eb=Math.atan2(_1e9[0].y-_1e9[1].y,_1e9[0].x-_1e9[1].x)*180/Math.PI;return _1eb-_1ea;}});});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_1ec,has,_1ed){return _1ec("dojox.grid._ViewManager",null,{constructor:function(_1ee){this.grid=_1ee;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_1ef){_1ef.idx=this.views.length;this.views.push(_1ef);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _1f0=[];for(var i=0,v;v=this.views[i];i++){_1f0.push(v.contentNode);}return _1f0;},forEach:function(_1f1){for(var i=0,v;v=this.views[i];i++){_1f1(v,i);}},onEach:function(_1f2,_1f3){_1f3=_1f3||[];for(var i=0,v;v=this.views[i];i++){if(_1f2 in v){v[_1f2].apply(v,_1f3);}}},normalizeHeaderNodeHeight:function(){var _1f4=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_1f4.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_1f4);},normalizeRowNodeHeights:function(_1f5){var h=0;var _1f6=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_1f5.length<=1){return;}for(var i=0,n;(n=_1f5[i]);i++){if(!_1ed.contains(n,"dojoxGridNonNormalizedCell")){_1f6[i]=n.firstChild.offsetHeight;h=Math.max(h,_1f6[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_1f5[i]);i++){if(_1f6[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_1f7){var _1f8=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_1f7));i++){n.firstChild.style.height="";_1f8.push(n);}this.normalizeRowNodeHeights(_1f8);},getViewWidth:function(_1f9){return this.views[_1f9].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_1fa){_1fa.headerContentNode.style.height="";});var h=0;this.forEach(function(_1fb){h=Math.max(_1fb.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_1fc){h=Math.max(_1fc.domNode.offsetHeight,h);});return h;},findClient:function(_1fd){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _1fe=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4||has("webkit")){hs.right=l+v.getScrollbarWidth()+"px";hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_1fe(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_1fe(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_1fe(v,l);}return l;},renderRow:function(_1ff,_200,_201){var _202=[];for(var i=0,v,n,_203;(v=this.views[i])&&(n=_200[i]);i++){_203=v.renderRow(_1ff);n.appendChild(_203);_202.push(_203);}if(!_201){this.normalizeRowNodeHeights(_202);}},rowRemoved:function(_204){this.onEach("rowRemoved",[_204]);},updateRow:function(_205,_206){for(var i=0,v;v=this.views[i];i++){v.updateRow(_205);}if(!_206){this.renormalizeRow(_205);}},updateRowStyles:function(_207){this.onEach("updateRowStyles",[_207]);},setScrollTop:function(_208){var top=_208;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_208);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"esri/toolbars/_GraphicMover":function(){define(["dijit","dojo","dojox","dojo/require!dojox/gfx/move"],function(_209,dojo,_20a){dojo.provide("esri.toolbars._GraphicMover");dojo.require("dojox.gfx.move");dojo.declare("esri.toolbars._Mover",_20a.gfx.Mover,{constructor:function(_20b,e,host){this.__e=e;}});dojo.declare("esri.toolbars._GraphicMover",null,{constructor:function(_20c,map,_20d){this.graphic=_20c;this.map=map;this.toolbar=_20d;this._enableGraphicMover();this._moved=false;},refresh:function(_20e){var _20f=this.graphic.getDojoShape();if(_20f&&(_20e||!_20f._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _210=this.graphic;var _211=_210.getDojoShape();if(_211){_211._hostGraphic=_210;this._moveable=new _20a.gfx.Moveable(_211,{mover:esri.toolbars._Mover});this._moveStartHandle=dojo.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=dojo.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=dojo.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=dojo.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_211.getEventSource();if(node){dojo.style(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _212=this._moveable;if(_212){dojo.disconnect(this._moveStartHandle);dojo.disconnect(this._firstMoveHandle);dojo.disconnect(this._movingHandle);dojo.disconnect(this._moveStopHandle);var _213=_212.shape;if(_213){_213._hostGraphic=null;var node=_213.getEventSource();if(node){dojo.style(node,"cursor",null);}}_212.destroy();}this._moveable=null;},_moveStartHandler:function(){var _214=this.graphic;this._startTx=_214.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_214);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_215){this.toolbar.onGraphicMove(this.graphic,_215.shape.getTransform());},_moveStopHandler:function(_216){var _217=this.graphic,map=this.map,mx=_20a.gfx.matrix,_218=_217.geometry,type=_218.type,_219=_217.getDojoShape(),tx=_219.getTransform();if(dojo.toJson(tx)!==dojo.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _21a=[tx,mx.invert(this._startTx)];var _21b;if(map.snappingManager){_21b=map.snappingManager._snappingPoint;}_218=_21b||map.toMap(mx.multiplyPoint(_21a,map.toScreen(_218,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_218=this._updatePolyGeometry(_218,_218.paths,tx);break;case "polygon":_218=this._updatePolyGeometry(_218,_218.rings,tx);break;}_219.setTransform(null);_217.setGeometry(_218);}else{this._moved=false;}this.toolbar._endOperation("MOVE");this.toolbar.onGraphicMoveStop(_217,tx);if(!this._moved){var e=_216.__e,_21c=this.map.position,pt=new esri.geometry.Point(e.pageX-_21c.x,e.pageY-_21c.y);this.toolbar.onGraphicClick(_217,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_21d,_21e,_21f){var map=this.map;var _220=_21d.getPoint(0,0);var _221=map.toMap(map.toScreen(_220).offset(_21f.dx,_21f.dy));var _222=_221.x-_220.x;var _223=_221.y-_220.y;for(var i=0;i<_21e.length;i++){var seg=_21e[i];for(var j=0;j<seg.length;j++){var _224=_21d.getPoint(i,j);_21d.setPoint(i,j,_224.offset(_222,_223));}}return _21d;}});});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\"\r\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\r\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\r\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\r\n\t</td>\r\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\r\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\r\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\r\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\r\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\r\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\r\n\t\t</div>\r\n\t</td>\r\n</tr>\r\n","dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_225){return _225.grid.cells;});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_226,_227,_228,lang,_229){return _227("dojox.grid._Layout",null,{constructor:function(_22a){this.grid=_22a;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_22b,_22c,_22d,_22e,_22f){var _230=this.structure[_22b].cells[0];var _231=this.structure[_22c].cells[0];var cell=null;var _232=0;var _233=0;for(var i=0,c;c=_230[i];i++){if(c.index==_22d){_232=i;break;}}cell=_230.splice(_232,1)[0];cell.view=this.grid.views.views[_22c];for(i=0,c=null;c=_231[i];i++){if(c.index==_22e){_233=i;break;}}if(!_22f){_233+=1;}_231.splice(_233,0,cell);var _234=this.grid.getCell(this.grid.getSortIndex());if(_234){_234._currentlySorted=this.grid.getSortAsc();}this.cells=[];_22d=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_22d;this.cells.push(c);if("_currentlySorted" in c){var si=_22d+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_22d++;}}}_228.forEach(this.cells,function(c){var _235=c.markup[2].split(" ");var _236=parseInt(_235[1].substring(5));if(_236!=c.index){_235[1]="idx=\""+c.index+"\"";c.markup[2]=_235.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_237,_238){var cell=this.cells[_237];if(cell.hidden==_238){cell.hidden=!_238;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_229.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_239,_23a,_23b){var self=this;var _23c=function(_23d){var w=0;if(_23d.colSpan>1){w=0;}else{w=_23d.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _23e={grid:this.grid,subrow:_239,layoutIndex:_23a,index:this.cells.length};if(_23b&&_23b instanceof _226.grid.cells._Base){var _23f=lang.clone(_23b);_23e.unitWidth=_23c(_23f._props);_23f=lang.mixin(_23f,this._defaultCellProps,_23b._props,_23e);return _23f;}var _240=_23b.type||_23b.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_226.grid.cells.Cell;if(lang.isString(_240)){_240=lang.getObject(_240);}_23e.unitWidth=_23c(_23b);return new _240(lang.mixin({},this._defaultCellProps,_23b,_23e));},addRowDef:function(_241,_242){var _243=[];var _244=0,_245=0,_246=true;for(var i=0,def,cell;(def=_242[i]);i++){cell=this.addCellDef(_241,i,def);_243.push(cell);this.cells.push(cell);if(_246&&cell.relWidth){_244+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_245+=window.parseInt(w,10);}else{if(w=="auto"){_246=false;}}}}}if(_244&&_246){_228.forEach(_243,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_244)*(100-_245))+"%";}});}return _243;},addRowsDef:function(_247){var _248=[];if(lang.isArray(_247)){if(lang.isArray(_247[0])){for(var i=0,row;_247&&(row=_247[i]);i++){_248.push(this.addRowDef(i,row));}}else{_248.push(this.addRowDef(0,_247));}}return _248;},addViewDef:function(_249){this._defaultCellProps=_249.defaultCell||{};if(_249.width&&_249.width=="auto"){delete _249.width;}return lang.mixin({},_249,{cells:this.addRowsDef(_249.rows||_249.cells)});},setStructure:function(_24a){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_226._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _24b=this.grid.rowSelector;if(_24b=="false"){sel=null;}else{if(_24b!="true"){sel["width"]=_24b;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _24c=function(def){return ("name" in def||"field" in def||"get" in def);};var _24d=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_24c(def[0])){return true;}}return false;};var _24e=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_24c(def))));};if(lang.isArray(_24a)){var _24f=false;for(var i=0,st;(st=_24a[i]);i++){if(_24e(st)){_24f=true;break;}}if(!_24f){s.push(this.addViewDef({cells:_24a}));}else{for(i=0;(st=_24a[i]);i++){if(_24d(st)){s.push(this.addViewDef({cells:st}));}else{if(_24e(st)){s.push(this.addViewDef(st));}}}}}else{if(_24e(_24a)){s.push(this.addViewDef(_24a));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"dijit/nls/loading":function(){define("dijit/nls/loading",{root:({loadingState:"Loading...",errorState:"Sorry, an error occurred"}),"zh":true,"zh-tw":true,"tr":true,"th":true,"sv":true,"sl":true,"sk":true,"ru":true,"ro":true,"pt":true,"pt-pt":true,"pl":true,"nl":true,"nb":true,"ko":true,"kk":true,"ja":true,"it":true,"hu":true,"hr":true,"he":true,"fr":true,"fi":true,"es":true,"el":true,"de":true,"da":true,"cs":true,"ca":true,"az":true,"ar":true});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\r\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\r\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\r\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\r\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\r\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\r\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\r\n\t</div>\r\n</div>\r\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(dojo,_250,_251,_252,_253,lang,_254,has,_255,win,_256,_257,_258,_259,_25a,util,html,_25b,_25c){var _25d=function(_25e,_25f){return _25e.style.cssText==undefined?_25e.getAttribute("style"):_25e.style.cssText;};var _260=_252("dojox.grid._View",[_258,_259],{defaultWidth:"18em",viewWidth:"",templateString:_256,themeable:false,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_25b._HeaderBuilder,_contentBuilderClass:_25b._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");util.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);util.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){html.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);html.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_261){var vs=(this.structure=_261);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_262){if(_262){_253.forEach(_255("[widgetId]",_262).map(_250.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_263,_264){this._onBeforeRow(_263,_264);if(_263>=0){this._cleanupRowWidgets(this.getRowNode(_263));}},onAfterRow:function(_265,_266,_267){this._onAfterRow(_265,_266,_267);var g=this.grid;_253.forEach(_255(".dojoxGridStubNode",_267),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _268=window.parseInt(html.attr(n,"cellIdx"),10);var _269=g.getCell(_268);var w=_250.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}dojo.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.view=this;this.flexCells=this.flexCells||cell.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _26a=this.hasVScrollbar();var _26b=html.style(this.scrollboxNode,"overflow");if(this.noscroll||!_26b||_26b=="hidden"){_26a=false;}else{if(_26b=="scroll"){_26a=true;}}return (_26a?_25a.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?h.firstChild.offsetWidth:0;},setColumnsWidth:function(_26c){this.headerContentNode.firstChild.style.width=_26c+"px";if(this.viewWidth){this.viewWidth=_26c+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,html._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _26d=this.grid.layout.cells;var _26e=lang.hitch(this,function(node,_26f){!this.grid.isLeftToRight()&&(_26f=!_26f);var inc=_26f?-1:1;var idx=this.header.getCellNodeIndex(node)+inc;var cell=_26d[idx];while(cell&&cell.getHeaderNode()&&cell.getHeaderNode().style.display=="none"){idx+=inc;cell=_26d[idx];}if(cell){return cell.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _270="dojoxGrid_bottomMarker";var _271="dojoxGrid_topMarker";if(this.bottomMarker){html.destroy(this.bottomMarker);}this.bottomMarker=html.byId(_270);if(this.topMarker){html.destroy(this.topMarker);}this.topMarker=html.byId(_271);if(!this.bottomMarker){this.bottomMarker=html.create("div",{"id":_270,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=html.create("div",{"id":_271,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=html.contentBox(this.bottomMarker);var _272=html.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _257(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:lang.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_257.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:lang.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_257.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:lang.hitch(this,function(_273){var src=this.source;if(src.current==src.targetAnchor&&src.before==_273){return;}if(src.targetAnchor&&_26e(src.targetAnchor,src.before)){src._removeItemClass(_26e(src.targetAnchor,src.before),src.before?"After":"Before");}_257.prototype._markTargetAnchor.call(src,_273);var _274=_273?src.targetAnchor:_26e(src.targetAnchor,src.before);var _275=0;if(!_274){_274=src.targetAnchor;_275=html.contentBox(_274).w+this.arrowDim.w/2+2;}var pos=html.position(_274,true);var left=Math.floor(pos.x-this.arrowDim.w/2+_275);html.style(this.bottomMarker,"visibility","visible");html.style(this.topMarker,"visibility","visible");html.style(this.bottomMarker,{"left":left+"px","top":(_272+pos.y)+"px"});html.style(this.topMarker,{"left":left+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_26e(src.targetAnchor,src.before)){src._addItemClass(_26e(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:lang.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_26e(src.targetAnchor,src.before)){src._removeItemClass(_26e(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_257.prototype._unmarkTargetAnchor.call(src);}),destroy:lang.hitch(this,function(){_254.disconnect(this._source_conn);_254.unsubscribe(this._source_sub);_257.prototype.destroy.call(this.source);if(this.bottomMarker){html.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){html.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:lang.hitch(this,function(){_257.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_254.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_254.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(node){html.style(node,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_276,_277,copy){if(dojo.dnd.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _278=this.grid.views.views;var _279=_278[_276.viewIndex];var _27a=_278[this.index];if(_27a!=_279){_279.convertColPctToFixed();_27a.convertColPctToFixed();}},_onDndDrop:function(_27b,_27c,copy){if(dojo.dnd.manager().target!==this.source){if(dojo.dnd.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _27d=function(n){return n?html.attr(n,"idx"):null;};var w=html.marginBox(_27c[0]).w;if(_27b.viewIndex!==this.index){var _27e=this.grid.views.views;var _27f=_27e[_27b.viewIndex];var _280=_27e[this.index];if(_27f.viewWidth&&_27f.viewWidth!="auto"){_27f.setColumnsWidth(_27f.getColumnsWidth()-w);}if(_280.viewWidth&&_280.viewWidth!="auto"){_280.setColumnsWidth(_280.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _281=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_281.moveColumn(_27b.viewIndex,idx,_27d(_27c[0]),_27d(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_282){var n=_282.name||_282.grid.getCellName(_282);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_282.index!=_282.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_282.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_282.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_283){var _284=this._hasHScroll||false;if(this._hasHScroll==undefined||_283){if(this.noscroll){this._hasHScroll=false;}else{var _285=html.style(this.scrollboxNode,"overflow");if(_285=="hidden"){this._hasHScroll=false;}else{if(_285=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_284!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_286){var _287=this._hasVScroll||false;if(this._hasVScroll==undefined||_286){if(this.noscroll){this._hasVScroll=false;}else{var _288=html.style(this.scrollboxNode,"overflow");if(_288=="hidden"){this._hasVScroll=false;}else{if(_288=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_287!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _289=false;this.grid.initialWidth="";var _28a=_255("th",this.headerContentNode);var _28b=_253.map(_28a,function(c,vIdx){var w=c.style.width;html.attr(c,"vIdx",vIdx);if(w&&w.slice(-1)=="%"){_289=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return html.contentBox(c).w;});if(_289){_253.forEach(this.grid.layout.cells,function(cell,idx){if(cell.view==this){var _28c=cell.view.getHeaderCellNode(cell.index);if(_28c&&html.hasAttr(_28c,"vIdx")){var vIdx=window.parseInt(html.attr(_28c,"vIdx"));this.setColWidth(idx,_28b[vIdx]);html.removeAttr(_28c,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_28d){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var self=this;var _28e=function(){var v;for(var i in self.grid.views.views){v=self.grid.views.views[i];if(v!==self&&v.hasHScrollbar()){return true;}}return false;};if(_28d||(this.noscroll&&_28e())){h-=_25a.getScrollbar().h;}util.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_28f){var _290=this.createRowNode(_28f);this.buildRow(_28f,_290);return _290;},createRowNode:function(_291){var node=document.createElement("div");node.className=this.classTag+"Row";if(this instanceof _251.grid._RowSelector){html.attr(node,"role","presentation");}else{html.attr(node,"role","row");if(this.grid.selectionMode!="none"){node.setAttribute("aria-selected","false");}}node[util.gridViewTag]=this.id;node[util.rowIndexTag]=_291;this.rowNodes[_291]=node;return node;},buildRow:function(_292,_293){this.buildRowContent(_292,_293);this.styleRow(_292,_293);},buildRowContent:function(_294,_295){_295.innerHTML=this.content.generateHtml(_294,_294);if(this.flexCells&&this.contentWidth){_295.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[_294,this.structure.cells,_295]);},rowRemoved:function(_296){if(_296>=0){this._cleanupRowWidgets(this.getRowNode(_296));}this.grid.edit.save(this,_296);delete this.rowNodes[_296];},getRowNode:function(_297){return this.rowNodes[_297];},getCellNode:function(_298,_299){var row=this.getRowNode(_298);if(row){return this.content.getCellNode(row,_299);}},getHeaderCellNode:function(_29a){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_29a);}},styleRow:function(_29b,_29c){_29c._style=_25d(_29c);this.styleRowNode(_29b,_29c);},styleRowNode:function(_29d,_29e){if(_29e){this.doStyleRowNode(_29d,_29e);}},doStyleRowNode:function(_29f,_2a0){this.grid.styleRowNode(_29f,_2a0);},updateRow:function(_2a1){var _2a2=this.getRowNode(_2a1);if(_2a2){_2a2.style.height="";this.buildRow(_2a1,_2a2);}return _2a2;},updateRowStyles:function(_2a3){this.styleRowNode(_2a3,this.getRowNode(_2a3));},lastTop:0,firstScroll:0,doscroll:function(_2a4){var _2a5=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_2a5&&this.firstScroll==1)||(_2a5&&this.firstScroll===0)){var s=html.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_2a5?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}},setScrollTop:function(_2a6){this.lastTop=_2a6;this.scrollboxNode.scrollTop=_2a6;return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_2a7,_2a8){this.grid.setCellWidth(_2a7,_2a8+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var left=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=left;this.headerNode.scrollLeft=left;}});var _2a9=_252("dojox.grid._GridAvatar",_25c,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _2aa=this.manager.source,node;if(_2aa.creator){node=_2aa._normalizedCreator(_2aa.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{node=this.manager.nodes[0].cloneNode(true);var _2ab,_2ac;if(node.tagName.toLowerCase()=="tr"){_2ab=dd.createElement("table");_2ac=dd.createElement("tbody");_2ac.appendChild(node);_2ab.appendChild(_2ac);node=_2ab;}else{if(node.tagName.toLowerCase()=="th"){_2ab=dd.createElement("table");_2ac=dd.createElement("tbody");var r=dd.createElement("tr");_2ab.cellPadding=_2ab.cellSpacing="0";r.appendChild(node);_2ac.appendChild(r);_2ab.appendChild(_2ac);node=_2ab;}}}node.id="";td.appendChild(node);tr.appendChild(img);tr.appendChild(td);html.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=dojo.dnd.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){dojo.dnd.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _2ad=dojo.dnd.manager().makeAvatar;dojo.dnd.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!html.hasClass(win.body(),"dijit_a11y")){return new _2a9(this);}return _2ad.call(dojo.dnd.manager());};return _260;});},"dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\"\r\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\r\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\r\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\r\n\t</td>\r\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\r\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\r\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\r\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\r\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\r\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\r\n\t\t</div>\r\n\t</td>\r\n</tr>\r\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/event","dojo/_base/kernel","dojo/_base/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_2ae,dom,_2af,_2b0,_2b1,_2b2,has,_2b3,_2b4,_2b5,_2b6,_2b7){return _2ae("dijit.MenuItem",[_2b3,_2b4,_2b5,_2b6],{templateString:_2b7,baseClass:"dijitMenuItem",label:"",_setLabelAttr:{node:"containerNode",type:"innerHTML"},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_2b8){if(_2b8&&!("label" in this.params)){this.set("label",_2b8.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _2b9=this.id+"_text";_2af.set(this.containerNode,"id",_2b9);if(this.accelKeyNode){_2af.set(this.accelKeyNode,"id",this.id+"_accel");_2b9+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_2b9);dom.setSelectable(this.domNode,false);},_onHover:function(){this.getParent().onItemHover(this);},_onUnhover:function(){this.getParent().onItemUnhover(this);this._set("hovering",false);},_onClick:function(evt){this.getParent().onItemClick(this,evt);_2b1.stop(evt);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_2ba){_2b0.toggle(this.domNode,"dijitMenuItemSelected",_2ba);},setLabel:function(_2bb){_2b2.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_2bb);},setDisabled:function(_2bc){_2b2.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_2bc);},_setDisabledAttr:function(_2bd){this.focusNode.setAttribute("aria-disabled",_2bd?"true":"false");this._set("disabled",_2bd);},_setAccelKeyAttr:function(_2be){this.accelKeyNode.style.display=_2be?"":"none";this.accelKeyNode.innerHTML=_2be;_2af.set(this.containerNode,"colSpan",_2be?"1":"2");this._set("accelKey",_2be);}});});},"dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_2bf,lang,_2c0){var _2c1=function(_2c2,_2c3){if(_2c2.style.cssText==undefined){_2c2.setAttribute("style",_2c3);}else{_2c2.style.cssText=_2c3;}};return _2bf("dojox.grid._RowManager",null,{constructor:function(_2c4){this.grid=_2c4;},linesToEms:2,overRow:-2,prepareStylingRow:function(_2c5,_2c6){return {index:_2c5,node:_2c6,odd:Boolean(_2c5&1),selected:!!this.grid.selection.isSelected(_2c5),over:this.isOver(_2c5),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_2c7,_2c8){var row=this.prepareStylingRow(_2c7,_2c8);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_2c9){var i=_2c9;i.node.className=i.customClasses;var h=i.node.style.height;_2c1(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_2ca){this.grid.updateRowStyles(_2ca);},setOverRow:function(_2cb){var last=this.overRow;this.overRow=_2cb;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_2cc){return (this.overRow==_2cc&&!_2c0.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\r\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\r\n</table>\r\n","dojo/dnd/Avatar":function(){define(["../main","./common"],function(dojo){dojo.declare("dojo.dnd.Avatar",null,{constructor:function(_2cd){this.manager=_2cd;this.construct();},construct:function(){this.isA11y=dojo.hasClass(dojo.body(),"dijit_a11y");var a=dojo.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_2ce=this.manager.source,node,b=dojo.create("tbody",null,a),tr=dojo.create("tr",null,b),td=dojo.create("td",null,tr),icon=this.isA11y?dojo.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td):null,span=dojo.create("span",{innerHTML:_2ce.generateText?this._generateText():""},td),k=Math.min(5,this.manager.nodes.length),i=0;dojo.attr(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_2ce.creator){node=_2ce._normalizedCreator(_2ce.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _2cf=dojo.create("table"),_2d0=dojo.create("tbody",null,_2cf);_2d0.appendChild(node);node=_2cf;}}node.id="";tr=dojo.create("tr",null,b);td=dojo.create("td",null,tr);td.appendChild(node);dojo.attr(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){dojo.destroy(this.node);this.node=false;},update:function(){dojo[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");if(this.isA11y){var icon=dojo.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}dojo.query(("tr.dojoDndAvatarHeader td span"+(this.isA11y?" span":"")),this.node).forEach(function(node){node.innerHTML=this._generateText();},this);},_generateText:function(){return this.manager.nodes.length.toString();}});return dojo.dnd.Avatar;});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/_base/connect","dojo/dom-class","dojo/_base/window","./Mover"],function(lang,_2d1,arr,_2d2,_2d3,_2d4,win,_2d5){return _2d1("dojox.gfx.Moveable",null,{constructor:function(_2d6,_2d7){this.shape=_2d6;this.delay=(_2d7&&_2d7.delay>0)?_2d7.delay:0;this.mover=(_2d7&&_2d7.mover)?_2d7.mover:_2d5;this.leftButtonOnly=_2d7&&_2d7.leftButtonOnly;this.events=[this.shape.connect("onmousedown",this,"onMouseDown"),this.shape.connect("ontouchstart",this,"onMouseDown")];},destroy:function(){arr.forEach(this.events,this.shape.disconnect,this.shape);this.events=this.shape=null;},onMouseDown:function(e){var pos=e.touches?e.touches[0]:e;if(this.delay){this.events.push(this.shape.connect("onmousemove",this,"onMouseMove"));this.events.push(this.shape.connect("ontouchmove",this,"onMouseMove"));this.events.push(this.shape.connect("onmouseup",this,"onMouseUp"));this.events.push(this.shape.connect("ontouchend",this,"onMouseUp"));this._lastX=pos.clientX;this._lastY=pos.clientY;}else{if(!this.leftButtonOnly||(pos.button===dojo.mouseButtons.LEFT)){new this.mover(this.shape,pos,this);}}_2d2.stop(e);},onMouseMove:function(e){var pos=e.touches?e.touches[0]:e;if(Math.abs(pos.clientX-this._lastX)>this.delay||Math.abs(pos.clientY-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,pos,this);}_2d2.stop(e);},onMouseUp:function(e){this.shape.disconnect(this.events.shift());this.shape.disconnect(this.events.shift());},onMoveStart:function(_2d8){_2d3.publish("/gfx/move/start",[_2d8]);_2d4.add(win.body(),"dojoMove");},onMoveStop:function(_2d9){_2d3.publish("/gfx/move/stop",[_2d9]);_2d4.remove(win.body(),"dojoMove");},onFirstMove:function(_2da){},onMove:function(_2db,_2dc){this.onMoving(_2db,_2dc);this.shape.applyLeftTransform(_2dc);this.onMoved(_2db,_2dc);},onMoving:function(_2dd,_2de){},onMoved:function(_2df,_2e0){}});});},"dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\r\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\r\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\r\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\r\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\r\n</div>\r\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_2e1,_2e2,_2e3,_2e4,_2e5,_2e6,_2e7,_2e8,_2e9,_2ea,_2eb,_2ec,util,_2ed,_2ee,_2ef,_2f0,_2f1,_2f2,lang,has,_2f3,html,_2f4){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _2f5=_2e2("dojox.grid._Grid",[_2ed,_2ee,_2e3],{templateString:_2f0,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,sortInfo:0,themeable:true,_placeholders:null,_layoutClass:_2e5,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_2f3.initOnFontResize();this.connect(_2f3,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}},postMixInProperties:function(){this.inherited(arguments);var _2f6=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_2f1.substitute(this.loadingMessage,_2f6);this.errorMessage=_2f1.substitute(this.errorMessage,_2f6);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_2f2.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_2f7){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_2f7){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _2e8(this);this.focus=new _2e9(this);this.edit=new _2ea(this);},createSelection:function(){this.selection=new _2eb(this);},createScroller:function(){this.scroller=new _2e4();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.render();},onResizeColumn:function(_2f8){},createViews:function(){this.views=new _2e7(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_2f9,idx){var c=lang.getObject(_2f9);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_2e1._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_2fa){var s=_2fa;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_2fb){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_2fb);},getColumnTogglingItems:function(){var _2fc,_2fd=[];_2fc=_2f2.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _2ef({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_2fe){if(self.layout.setColumnVisibility(this._gridCell.index,_2fe)){var _2ff=this._gridCell.menuItems;if(_2ff.length>1){_2f2.forEach(_2ff,function(item){if(item!==this){item.setAttribute("checked",_2fe);}},this);}_2fe=_2f2.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_2f2.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_2fe.length==1){_2f2.forEach(_2fe[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _300=_2f2.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_300,1);delete this._gridCell;_2ef.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_2fd.push(item);}return item;},this);if(_2fd.length==1){_2fd[0].set("disabled",true);}return _2fc;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_2f2.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_2f2.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_301){this.setScrollTop(0);},getItem:function(_302){return null;},showMessage:function(_303){if(_303){this.messagesNode.innerHTML=_303;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_304,_305){if(dojo.isIE&&!_304&&!_305&&this._autoHeight){return;}this._pendingChangeSize=_304;this._pendingResultSize=_305;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_306,_307){_306=_306||this._pendingChangeSize;_307=_307||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _308=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_308.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_307){_306=_307;}if(!this._autoHeight&&_306){html.marginBox(this.domNode,_306);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=this._parentContentBoxHeight||html._getContentBox(pn).h;this.domNode.style.height=Math.max(0,h)+"px";}}var _309=_2f2.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_309&&hh===undefined){hh=this._getHeaderHeight();}}if(_309){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _30a=(!this.initialWidth&&this.autoWidth);var w=_30a?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_30a){this.domNode.style.width=vw+"px";}},adaptHeight:function(_30b){var t=_30b===undefined?this._getHeaderHeight():_30b;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _30c=0,_30d=0;var _30e=_2f2.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_30c++;}else{_30d++;}return (!has);});if(_30c>0&&_30d>0){_2f2.forEach(_30e,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_30f,_310){this.views.renderRow(_30f,_310,this._skipRowRenormalize);},rowRemoved:function(_311){this.views.rowRemoved(_311);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_312){_312=Number(_312);if(this.updating){this.invalidated[_312]=true;}else{this.views.updateRow(_312);this.scroller.rowHeightChanged(_312);}},updateRows:function(_313,_314){_313=Number(_313);_314=Number(_314);var i;if(this.updating){for(i=0;i<_314;i++){this.invalidated[i+_313]=true;}}else{for(i=0;i<_314;i++){this.views.updateRow(i+_313,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_313);}},updateRowCount:function(_315){if(this.updating){this.invalidated.rowCount=_315;}else{this.rowCount=_315;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_315);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_316){this.views.updateRowStyles(_316);},getRowNode:function(_317){if(this.focus.focusView&&!(this.focus.focusView instanceof _2ec)){return this.focus.focusView.rowNodes[_317];}else{for(var i=0,_318;(_318=this.views.views[i]);i++){if(!(_318 instanceof _2ec)){return _318.rowNodes[_317];}}}return null;},rowHeightChanged:function(_319){this.views.renormalizeRow(_319);this.scroller.rowHeightChanged(_319);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_31a){if(!this.fastScroll){this.setScrollTop(_31a);return;}var _31b=Math.abs(this.lastScrollTop-_31a);this.lastScrollTop=_31a;if(_31b>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_31a;this.views.setScrollTop(_31a);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _31c=this;this._pendingScroll=window.setTimeout(function(){delete _31c._pendingScroll;_31c.finishScrollJob();},200);}else{this.setScrollTop(_31a);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_31d){this.scroller.scroll(this.views.setScrollTop(_31d));},scrollToRow:function(_31e){this.setScrollTop(this.scroller.findScrollTop(_31e)+1);},styleRowNode:function(_31f,_320){if(_320){this.rows.styleRowNode(_31f,_320);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_321){return this.layout.cells[_321];},setCellWidth:function(_322,_323){this.getCell(_322).unitWidth=_323;},getCellName:function(_324){return "Cell "+_324.index;},canSort:function(_325){},sort:function(){},getSortAsc:function(_326){_326=_326==undefined?this.sortInfo:_326;return Boolean(_326>0);},getSortIndex:function(_327){_327=_327==undefined?this.sortInfo:_327;return Math.abs(_327)-1;},setSortIndex:function(_328,_329){var si=_328+1;if(_329!=undefined){si*=(_329?1:-1);}else{if(this.getSortIndex()==_328){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_32a){if(this.canSort(_32a)){this.sortInfo=_32a;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_32b,_32c){this.onStartEdit(_32b,_32c);},doApplyCellEdit:function(_32d,_32e,_32f){this.onApplyCellEdit(_32d,_32e,_32f);},doCancelEdit:function(_330){this.onCancelEdit(_330);},doApplyEdit:function(_331){this.onApplyEdit(_331);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_2f5.markupFactory=function(_332,node,ctor,_333){var _334=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_332.structure&&node.nodeName.toLowerCase()=="table"){_332.structure=_2f4("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_334(cg);}return v;});if(!_332.structure.length){_332.structure.push({__span:Infinity,cells:[]});}_2f4("thead > tr",node).forEach(function(tr,_335){var _336=0;var _337=0;var _338;var _339=null;_2f4("> th",tr).map(function(th){if(!_339){_338=0;_339=_332.structure[0];}else{if(_336>=(_338+_339.__span)){_337++;_338+=_339.__span;var _33a=_339;_339=_332.structure[_337];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_336+=cell.colSpan;var _33b=html.attr(th,"rowspan");if(_33b){cell.rowSpan=_33b;}if(html.hasAttr(th,"width")){cell.width=_334(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_333){_333(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_2e1.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_339.cells[_335]){_339.cells[_335]=[];}_339.cells[_335].push(cell);});});}return new ctor(_332,node);};return _2f5;});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\r\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\r\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\r\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\r\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\r\n</div>\r\n","dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\r\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\r\n</table>\r\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_33c,_33d,keys,_33e,_33f,_340){return _33c("dijit.DropDownMenu",[_340,_33f],{templateString:_33e,baseClass:"dijitMenu",postCreate:function(){var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_33d.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_33d.stop(evt);}break;}}});});},"dojo/data/util/simpleFetch":function(){define(["dojo/_base/lang","dojo/_base/window","./sorter"],function(lang,_341,_342){var _343=lang.getObject("dojo.data.util.simpleFetch",true);_343.fetch=function(_344){_344=_344||{};if(!_344.store){_344.store=this;}var self=this;var _345=function(_346,_347){if(_347.onError){var _348=_347.scope||_341.global;_347.onError.call(_348,_346,_347);}};var _349=function(_34a,_34b){var _34c=_34b.abort||null;var _34d=false;var _34e=_34b.start?_34b.start:0;var _34f=(_34b.count&&(_34b.count!==Infinity))?(_34e+_34b.count):_34a.length;_34b.abort=function(){_34d=true;if(_34c){_34c.call(_34b);}};var _350=_34b.scope||_341.global;if(!_34b.store){_34b.store=self;}if(_34b.onBegin){_34b.onBegin.call(_350,_34a.length,_34b);}if(_34b.sort){_34a.sort(_342.createSortFunction(_34b.sort,self));}if(_34b.onItem){for(var i=_34e;(i<_34a.length)&&(i<_34f);++i){var item=_34a[i];if(!_34d){_34b.onItem.call(_350,item,_34b);}}}if(_34b.onComplete&&!_34d){var _351=null;if(!_34b.onItem){_351=_34a.slice(_34e,_34f);}_34b.onComplete.call(_350,_351,_34b);}};this._fetchItems(_344,_349,_345);return _344;};return _343;});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/_base/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_352,_353,_354,_355,dom,_356,_357,_358,_359,keys,lang,on,has,win,_35a,pm,_35b,_35c){if(!_359.isAsync){_35c(0,function(){var _35d=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_352(_35d);});}return _354("dijit.Menu",_35b,{constructor:function(){this._bindings=[];},targetNodeIds:[],contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(win.body());}else{_353.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_35e){return _35a.get(this._iframeContentDocument(_35e))||this._iframeContentDocument(_35e)["__parent__"]||(_35e.name&&win.doc.frames[_35e.name])||null;},_iframeContentDocument:function(_35f){return _35f.contentDocument||(_35f.contentWindow&&_35f.contentWindow.document)||(_35f.name&&win.doc.frames[_35f.name]&&win.doc.frames[_35f.name].document)||null;},bindDomNode:function(node){node=dom.byId(node);var cn;if(node.tagName.toLowerCase()=="iframe"){var _360=node,_361=this._iframeContentWindow(_360);cn=win.withGlobal(_361,win.body);}else{cn=(node==win.body()?win.doc.documentElement:node);}var _362={node:node,iframe:_360};_356.set(node,"_dijitMenu"+this.id,this._bindings.push(_362));var _363=lang.hitch(this,function(cn){return [on(cn,this.leftClickToOpen?"click":"contextmenu",lang.hitch(this,function(evt){_355.stop(evt);this._scheduleOpen(evt.target,_360,{x:evt.pageX,y:evt.pageY});})),on(cn,"keydown",lang.hitch(this,function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_355.stop(evt);this._scheduleOpen(evt.target,_360);}}))];});_362.connects=cn?_363(cn):[];if(_360){_362.onloadHandler=lang.hitch(this,function(){var _364=this._iframeContentWindow(_360);cn=win.withGlobal(_364,win.body);_362.connects=_363(cn);});if(_360.addEventListener){_360.addEventListener("load",_362.onloadHandler,false);}else{_360.attachEvent("onload",_362.onloadHandler);}}},unBindDomNode:function(_365){var node;try{node=dom.byId(_365);}catch(e){return;}var _366="_dijitMenu"+this.id;if(node&&_356.has(node,_366)){var bid=_356.get(node,_366)-1,b=this._bindings[bid],h;while(h=b.connects.pop()){h.remove();}var _367=b.iframe;if(_367){if(_367.removeEventListener){_367.removeEventListener("load",b.onloadHandler,false);}else{_367.detachEvent("onload",b.onloadHandler);}}_356.remove(node,_366);delete this._bindings[bid];}},_scheduleOpen:function(_368,_369,_36a){if(!this._openTimer){this._openTimer=setTimeout(lang.hitch(this,function(){delete this._openTimer;this._openMyself({target:_368,iframe:_369,coords:_36a});}),1);}},_openMyself:function(args){var _36b=args.target,_36c=args.iframe,_36d=args.coords;if(_36d){if(_36c){var ifc=_357.position(_36c,true),_36e=this._iframeContentWindow(_36c),_36f=win.withGlobal(_36e,"_docScroll",dojo);var cs=_358.getComputedStyle(_36c),tp=_358.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_36c,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_36c,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_36c,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_36c,cs.borderTopWidth):0);_36d.x+=ifc.x+left-_36f.x;_36d.y+=ifc.y+top-_36f.y;}}else{_36d=_357.position(_36b,true);_36d.x+=10;_36d.y+=10;}var self=this;var _370=this._focusManager.get("prevNode");var _371=this._focusManager.get("curNode");var _372=!_371||(dom.isDescendant(_371,this.domNode))?_370:_371;function _373(){if(self.refocus&&_372){_372.focus();}pm.close(self);};pm.open({popup:this,x:_36d.x,y:_36d.y,onExecute:_373,onCancel:_373,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},uninitialize:function(){_353.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_374,_375,_376,_377,keys,_378,_379,_37a,lang){return _378("dijit._KeyNavContainer",[_376,_375],{tabIndex:"0",connectKeyNavHandlers:function(_37b,_37c){var _37d=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_377.forEach(_37b,function(code){_37d[code]=prev;});_377.forEach(_37c,function(code){_37d[code]=next;});_37d[keys.HOME]=lang.hitch(this,"focusFirstChild");_37d[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_374.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_377.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_37e,_37f){this.inherited(arguments);this._startupChild(_37e);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_380,last){if(!_380){return;}if(this.focusedChild&&_380!==this.focusedChild){this._onChildBlur(this.focusedChild);}_380.set("tabIndex",this.tabIndex);_380.focus(last?"end":"start");this._set("focusedChild",_380);},_startupChild:function(_381){_381.set("tabIndex","-1");this.connect(_381,"_onFocus",function(){_381.set("tabIndex",this.tabIndex);});this.connect(_381,"_onBlur",function(){_381.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_37a.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_37a.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_379.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_382,dir){if(_382){_382=this._getSiblingOfChild(_382,dir);}var _383=this.getChildren();for(var i=0;i<_383.length;i++){if(!_382){_382=_383[(dir>0)?0:(_383.length-1)];}if(_382.isFocusable()){return _382;}_382=this._getSiblingOfChild(_382,dir);}return null;}});});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_384,_385){return _384("dijit._Contained",null,{_getSibling:function(_386){var node=this.domNode;do{node=node[_386+"Sibling"];}while(node&&node.nodeType!=1);return node&&_385.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"dojox/gfx/move":function(){define("dojox/gfx/move",["dojo/_base/lang","./Mover","./Moveable"],function(lang){return lang.getObject("dojox.gfx.move",true);});},"dojo/dnd/Source":function(){define(["../main","./Selector","./Manager"],function(dojo,_387,_388){if(!dojo.isAsync){dojo.ready(0,function(){var _389=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_389);});}return dojo.declare("dojo.dnd.Source",_387,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_38a){dojo.mixin(this,dojo.mixin({},_38a));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){dojo.addClass(this.node,"dojoDndSource");}this.targetState="";if(this.accept){dojo.addClass(this.node,"dojoDndTarget");}if(this.horizontal){dojo.addClass(this.node,"dojoDndHorizontal");}this.topics=[dojo.subscribe("/dnd/source/over",this,"onDndSourceOver"),dojo.subscribe("/dnd/start",this,"onDndStart"),dojo.subscribe("/dnd/drop",this,"onDndDrop"),dojo.subscribe("/dnd/cancel",this,"onDndCancel")];},checkAcceptance:function(_38b,_38c){if(this==_38b){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_38c.length;++i){var type=_38b.getItem(_38c[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_38d,self){if(_38d){return true;}if(arguments.length<2){self=this==_388.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){dojo.dnd.Source.superclass.destroy.call(this);dojo.forEach(this.topics,dojo.unsubscribe);this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}dojo.dnd.Source.superclass.onMouseMove.call(this,e);var m=_388.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _38e=this.getSelectedNodes();if(_38e.length){m.startDrag(this,_38e,this.copyState(dojo.isCopyKey(e),true));}}}if(this.isDragging){var _38f=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=dojo.position(this.current,true);}if(this.horizontal){_38f=(e.pageX-this.targetBox.x)<(this.targetBox.w/2);}else{_38f=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_38f!=this.before){this._markTargetAnchor(_38f);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dojo.dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;dojo.dnd.Source.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;dojo.dnd.Source.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_390){if(this!=_390){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_388.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_391,_392,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_391?(copy?"Copied":"Moved"):"");}var _393=this.accept&&this.checkAcceptance(_391,_392);this._changeState("Target",_393?"":"Disabled");if(this==_391){_388.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_394,_395,copy,_396){if(this==_396){this.onDrop(_394,_395,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_397,_398,copy){if(this!=_397){this.onDropExternal(_397,_398,copy);}else{this.onDropInternal(_398,copy);}},onDropExternal:function(_399,_39a,copy){var _39b=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _39b.call(this,_399.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node,hint){var t=_399.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node,hint){var t=_399.getItem(node.id);_399.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_399.selectNone();}this.insertNodes(true,_39a,this.before,this.current);if(!copy&&this.creator){_399.deleteSelectedNodes();}this._normalizedCreator=_39b;},onDropInternal:function(_39c,copy){var _39d=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _39d.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_39c,this.before,this.current);this._normalizedCreator=_39d;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){dojo.dnd.Source.superclass.onOverEvent.call(this);_388.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){dojo.dnd.Source.superclass.onOutEvent.call(this);_388.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_39e){if(this.current==this.targetAnchor&&this.before==_39e){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_39e;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(!dojo.mouseButtons.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(dojo.hasClass(node,"dojoDndHandle")){return true;}if(dojo.hasClass(node,"dojoDndItem")||dojo.hasClass(node,"dojoDndIgnore")){break;}}return false;}});});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","../_base/window","./util/filter","./util/simpleFetch","../date/stamp"],function(_39f,lang,_3a0,_3a1,xhr,_3a2,_3a3,_3a4,_3a5,_3a6){var _3a7=_3a0("dojo.data.ItemFileReadStore",[_3a2],{constructor:function(_3a8){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_3a8.url;this._ccUrl=_3a8.url;this.url=_3a8.url;this._jsonData=_3a8.data;this.data=null;this._datatypeMap=_3a8.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_3a9){return _3a6.fromISOString(_3a9);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_3a8.urlPreventCache!==undefined){this.urlPreventCache=_3a8.urlPreventCache?true:false;}if(_3a8.hierarchical!==undefined){this.hierarchical=_3a8.hierarchical?true:false;}if(_3a8.clearOnClose){this.clearOnClose=true;}if("failOk" in _3a8){this.failOk=_3a8.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.");}},_assertIsAttribute:function(_3aa){if(typeof _3aa!=="string"){throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.");}},getValue:function(item,_3ab,_3ac){var _3ad=this.getValues(item,_3ab);return (_3ad.length>0)?_3ad[0]:_3ac;},getValues:function(item,_3ae){this._assertIsItem(item);this._assertIsAttribute(_3ae);return (item[_3ae]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _3af=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_3af.push(key);}}return _3af;},hasAttribute:function(item,_3b0){this._assertIsItem(item);this._assertIsAttribute(_3b0);return (_3b0 in item);},containsValue:function(item,_3b1,_3b2){var _3b3=undefined;if(typeof _3b2==="string"){_3b3=_3a4.patternToRegExp(_3b2,false);}return this._containsValue(item,_3b1,_3b2,_3b3);},_containsValue:function(item,_3b4,_3b5,_3b6){return _3a1.some(this.getValues(item,_3b4),function(_3b7){if(_3b7!==null&&!lang.isObject(_3b7)&&_3b6){if(_3b7.toString().match(_3b6)){return true;}}else{if(_3b5===_3b7){return true;}}});},isItem:function(_3b8){if(_3b8&&_3b8[this._storeRefPropName]===this){if(this._arrayOfAllItems[_3b8[this._itemNumPropName]]===_3b8){return true;}}return false;},isItemLoaded:function(_3b9){return this.isItem(_3b9);},loadItem:function(_3ba){this._assertIsItem(_3ba.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},_fetchItems:function(_3bb,_3bc,_3bd){var self=this,_3be=function(_3bf,_3c0){var _3c1=[],i,key;if(_3bf.query){var _3c2,_3c3=_3bf.queryOptions?_3bf.queryOptions.ignoreCase:false;var _3c4={};for(key in _3bf.query){_3c2=_3bf.query[key];if(typeof _3c2==="string"){_3c4[key]=_3a4.patternToRegExp(_3c2,_3c3);}else{if(_3c2 instanceof RegExp){_3c4[key]=_3c2;}}}for(i=0;i<_3c0.length;++i){var _3c5=true;var _3c6=_3c0[i];if(_3c6===null){_3c5=false;}else{for(key in _3bf.query){_3c2=_3bf.query[key];if(!self._containsValue(_3c6,key,_3c2,_3c4[key])){_3c5=false;}}}if(_3c5){_3c1.push(_3c6);}}_3bc(_3c1,_3bf);}else{for(i=0;i<_3c0.length;++i){var item=_3c0[i];if(item!==null){_3c1.push(item);}}_3bc(_3c1,_3bf);}};if(this._loadFinished){_3be(_3bb,this._getItemsArray(_3bb.queryOptions));}else{if(this._jsonFileUrl!==this._ccUrl){_39f.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_3bb,filter:_3be});}else{this._loadInProgress=true;var _3c7={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _3c8=xhr.get(_3c7);_3c8.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;_3be(_3bb,self._getItemsArray(_3bb.queryOptions));self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_3bd(e,_3bb);}});_3c8.addErrback(function(_3c9){self._loadInProgress=false;_3bd(_3c9,_3bb);});var _3ca=null;if(_3bb.abort){_3ca=_3bb.abort;}_3bb.abort=function(){var df=_3c8;if(df&&df.fired===-1){df.cancel();df=null;}if(_3ca){_3ca.call(_3bb);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;_3be(_3bb,this._getItemsArray(_3bb.queryOptions));}catch(e){_3bd(e,_3bb);}}else{_3bd(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),_3bb);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _3cb=this._queuedFetches[i],_3cc=_3cb.args,_3cd=_3cb.filter;if(_3cd){_3cd(_3cc,this._getItemsArray(_3cc.queryOptions));}else{this.fetchItemByIdentity(_3cc);}}this._queuedFetches=[];}},_getItemsArray:function(_3ce){if(_3ce&&_3ce.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_3cf){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug("dojo.data.ItemFileReadStore: WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_3d0){var _3d1=false,self=this;function _3d2(_3d3){return (_3d3!==null)&&(typeof _3d3==="object")&&(!lang.isArray(_3d3)||_3d1)&&(!lang.isFunction(_3d3))&&(_3d3.constructor==Object||lang.isArray(_3d3))&&(typeof _3d3._reference==="undefined")&&(typeof _3d3._type==="undefined")&&(typeof _3d3._value==="undefined")&&self.hierarchical;};function _3d4(_3d5){self._arrayOfAllItems.push(_3d5);for(var _3d6 in _3d5){var _3d7=_3d5[_3d6];if(_3d7){if(lang.isArray(_3d7)){var _3d8=_3d7;for(var k=0;k<_3d8.length;++k){var _3d9=_3d8[k];if(_3d2(_3d9)){_3d4(_3d9);}}}else{if(_3d2(_3d7)){_3d4(_3d7);}}}}};this._labelAttr=_3d0.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_3d0.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_3d1=true;}_3d4(item);item[this._rootItemPropName]=true;}var _3da={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _3db=item[key];if(_3db!==null){if(!lang.isArray(_3db)){item[key]=[_3db];}}else{item[key]=[null];}}_3da[key]=key;}}while(_3da[this._storeRefPropName]){this._storeRefPropName+="_";}while(_3da[this._itemNumPropName]){this._itemNumPropName+="_";}while(_3da[this._reverseRefMap]){this._reverseRefMap+="_";}var _3dc;var _3dd=_3d0.identifier;if(_3dd){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_3dd;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_3dc=item[_3dd];var _3de=_3dc[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_3de)){this._itemsByIdentity[_3de]=item;}else{if(this._jsonFileUrl){throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_3dd+"].  Value collided: ["+_3de+"]");}else{if(this._jsonData){throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_3dd+"].  Value collided: ["+_3de+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_3dc=item[key];for(var j=0;j<_3dc.length;++j){_3db=_3dc[j];if(_3db!==null&&typeof _3db=="object"){if(("_type" in _3db)&&("_value" in _3db)){var type=_3db._type;var _3df=this._datatypeMap[type];if(!_3df){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_3df)){_3dc[j]=new _3df(_3db._value);}else{if(lang.isFunction(_3df.deserialize)){_3dc[j]=_3df.deserialize(_3db._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_3db._reference){var _3e0=_3db._reference;if(!lang.isObject(_3e0)){_3dc[j]=this._getItemByIdentity(_3e0);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _3e1=this._arrayOfAllItems[k],_3e2=true;for(var _3e3 in _3e0){if(_3e1[_3e3]!=_3e0[_3e3]){_3e2=false;}}if(_3e2){_3dc[j]=_3e1;}}}if(this.referenceIntegrity){var _3e4=_3dc[j];if(this.isItem(_3e4)){this._addReferenceToMap(_3e4,item,key);}}}else{if(this.isItem(_3db)){if(this.referenceIntegrity){this._addReferenceToMap(_3db,item,key);}}}}}}}},_addReferenceToMap:function(_3e5,_3e6,_3e7){},getIdentity:function(item){var _3e8=this._features["dojo.data.api.Identity"];if(_3e8===Number){return item[this._itemNumPropName];}else{var _3e9=item[_3e8];if(_3e9){return _3e9[0];}}return null;},fetchItemByIdentity:function(_3ea){var item,_3eb;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_39f.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_3ea});}else{this._loadInProgress=true;var _3ec={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _3ed=xhr.get(_3ec);_3ed.addCallback(function(data){var _3ee=_3ea.scope?_3ea.scope:_3a3.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_3ea.identity);if(_3ea.onItem){_3ea.onItem.call(_3ee,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_3ea.onError){_3ea.onError.call(_3ee,error);}}});_3ed.addErrback(function(_3ef){self._loadInProgress=false;if(_3ea.onError){var _3f0=_3ea.scope?_3ea.scope:_3a3.global;_3ea.onError.call(_3f0,_3ef);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_3ea.identity);if(_3ea.onItem){_3eb=_3ea.scope?_3ea.scope:_3a3.global;_3ea.onItem.call(_3eb,item);}}}}else{item=this._getItemByIdentity(_3ea.identity);if(_3ea.onItem){_3eb=_3ea.scope?_3ea.scope:_3a3.global;_3ea.onItem.call(_3eb,item);}}},_getItemByIdentity:function(_3f1){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_3f1)){item=this._itemsByIdentity[_3f1];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_3f1)){item=this._arrayOfAllItems[_3f1];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _3f2=this._features["dojo.data.api.Identity"];if(_3f2===Number){return null;}else{return [_3f2];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_39f.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _3f3={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _3f4=xhr.get(_3f3);_3f4.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error("dojo.data.ItemFileReadStore:  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_3f4.addErrback(function(_3f5){throw _3f5;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_3a7,_3a5);return _3a7;});},"esri/toolbars/_VertexMover":function(){define(["dijit","dojo","dojox","dojo/require!dojox/gfx/move"],function(_3f6,dojo,_3f7){dojo.provide("esri.toolbars._VertexMover");dojo.require("dojox.gfx.move");dojo.declare("esri.toolbars.VertexMover",null,{constructor:function(_3f8,_3f9,_3fa,_3fb,_3fc,_3fd,_3fe,_3ff){this.point=_3f8;this.symbol=_3f9;this.relatedGraphic=_3fa;this.segIndex=_3fb;this.ptIndex=_3fc;this.segLength=_3fd;this.editor=_3fe;this.map=_3fe.map;this._scratchGL=_3fe.toolbar._scratchGL;this._placeholder=_3ff||false;this._type=_3fa.geometry.type;this._init();this._enable();},refresh:function(_400){if(_400||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var _401=new esri.geometry.Point(this.point.toJson());var _402=new esri.Graphic(_401,this.symbol);switch(this._type){case "multipoint":_402._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_402);break;}this.graphic=_402;},_enable:function(){var _403=this.graphic.getDojoShape();if(_403){_403._hasMover=true;this._moveable=this._getMoveable(_403);var node=_403.getEventSource();if(node){dojo.style(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _404=this._moveable;if(_404){dojo.disconnect(this._startHandle);dojo.disconnect(this._firstHandle);dojo.disconnect(this._movingHandle);dojo.disconnect(this._stopHandle);var _405=_404.shape;if(_405){var node=_405.getEventSource();if(node){dojo.style(node,"cursor",null);}}_404.destroy();this._moveable=null;}},_needRefresh:function(){var _406=this.graphic.getDojoShape(),need=false;if(_406){switch(this._type){case "multipoint":var _407=this.relatedGraphic.getDojoShape();if(_407){var _408=_407.children[this.ptIndex];if(_406!==_408){_406=_408;this.graphic._shape=_406;need=true;}}break;case "polyline":case "polygon":need=!_406._hasMover;break;}}return need;},_getMoveable:function(_409){var _40a=new _3f7.gfx.Moveable(_409,dojo.isMac&&dojo.isFF&&!esri.isTouchEnabled&&{leftButtonOnly:true});this._startHandle=dojo.connect(_40a,"onMoveStart",this,this._moveStartHandler);this._firstHandle=dojo.connect(_40a,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=dojo.connect(_40a,"onMoving",this,this._movingHandler);this._stopHandle=dojo.connect(_40a,"onMoveStop",this,this._moveStopHandler);return _40a;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(_40b){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}_40b.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(_40c){var _40d=_40c.shape;var _40e=this._getControlEdges();var _40f=this._scratchGL._div;var i,_410=[],_411=_40c.host.shape._wrapOffsets[0]||0;for(i=0;i<_40e.length;i++){var edge=_40e[i];edge.x1+=_411;edge.x2+=_411;_410.push([_40f.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}_40d._lines=_410;_40c.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(_412){var _413=_412.shape,tx=_413.getTransform();var i,_414=_413._lines;for(i=0;i<_414.length;i++){var line=_414[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(_415){var _416=_415.shape,tx=_416.getTransform(),map=this.map;var host=this.graphic;var i,_417=_416._lines;if(_417){for(i=0;i<_417.length;i++){_417[i][0].removeShape();}_416._lines=null;}var ph=false,_418=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{_418=false;}var _419;if(this.map.snappingManager){_419=this.map.snappingManager._snappingPoint;}var _41a=_419||map.toMap(map.toScreen(host.geometry).offset(tx.dx,tx.dy));if(this.map.snappingManager){this.map.snappingManager._killOffSnapping();}_416.setTransform(null);host.setGeometry(_41a);this.constructor.onMoveStop(this,tx);this.editor.toolbar.onVertexMoveStop(this.relatedGraphic,info,tx);if(!_418){this.editor.toolbar.onVertexClick(this.relatedGraphic,info);}if(ph){this.editor.toolbar.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _41b=this.relatedGraphic.geometry;var _41c=this.segIndex,_41d=this.ptIndex,_41e=this.segLength;var _41f=this._scratchGL._div;var _420=_41f.getTransform();var sdx=_420.dx,sdy=_420.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var _421=[];var _422=this.editor._getControlPoints(this,_41b,_41c,_41d,_41e);if(_422[0]){_421.push({x1:x,y1:y,x2:_422[0].x-sdx,y2:_422[0].y-sdy});}if(_422[1]){_421.push({x1:x,y1:y,x2:_422[1].x-sdx,y2:_422[1].y-sdy});}return _421;}});dojo.mixin(esri.toolbars.VertexMover,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});});},"esri/toolbars/edit":function(){define(["dijit","dojo","dojox","dojo/require!esri/toolbars/_toolbar,esri/toolbars/_GraphicMover,esri/toolbars/_VertexEditor,esri/toolbars/_Box"],function(_423,dojo,_424){dojo.provide("esri.toolbars.edit");dojo.require("esri.toolbars._toolbar");dojo.require("esri.toolbars._GraphicMover");dojo.require("esri.toolbars._VertexEditor");dojo.require("esri.toolbars._Box");(function(){var link=document.createElement("link");link.type="text/css";link.rel="stylesheet";link.href=dojo.moduleUrl("esri","toolbars/css/edit.css").toString();document.getElementsByTagName("head").item(0).appendChild(link);}());dojo.declare("esri.toolbars.Edit",esri.toolbars._Toolbar,{constructor:function(map,_425){this._map=map;this._tool=0;this._scratchGL=map.graphics;var _426=esri.isTouchEnabled;this._defaultOptions=dojo.mixin({vertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,_426?20:12,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([128,128,128])),ghostVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,_426?18:10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([255,255,255,0.75])),ghostLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DOT,new dojo.Color([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:_426?24:16,boxLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new dojo.Color([64,64,64]),1),boxHandleSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,_426?16:9,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([255,255,255,0.75]))},_425||{});},activate:function(tool,_427,_428){this.deactivate();this._graphic=_427;this._options=dojo.mixin(dojo.mixin({},this._defaultOptions),_428||{});var MOVE=esri.toolbars.Edit.MOVE,EDIT=esri.toolbars.Edit.EDIT_VERTICES;var _429=esri.toolbars.Edit.SCALE,_42a=esri.toolbars.Edit.ROTATE;var move=false,edit=false,box=false;if((tool&MOVE)===MOVE){move=this._enableMove(_427);}var _42b=((tool&_429)===_429),_42c=((tool&_42a)===_42a);if(_42b||_42c){box=this._enableBoxEditing(_427,_42b,_42c);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_427);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] "+esri.bundle.toolbars.edit.invalidType);}this._tool=tool;var map=this._map;if(this._tool){this._mapPanEndHandle=dojo.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=dojo.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_427);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_42d=this._graphic;if(!tool){return;}var _42e=!!this._modified;this._clear();dojo.disconnect(this._mapPanEndHandle);dojo.disconnect(this._mapExtChgHandle);this._graphic=null;this.onDeactivate(tool,_42d,{isModified:_42e});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_42f){},onDeactivate:function(tool,_430,info){},onGraphicMoveStart:function(_431){},onGraphicFirstMove:function(_432){this._modified=true;},onGraphicMove:function(_433,_434){},onGraphicMoveStop:function(_435,_436){},onGraphicClick:function(_437,info){},onVertexMoveStart:function(_438,_439){},onVertexFirstMove:function(_43a,_43b){this._modified=true;},onVertexMove:function(_43c,_43d,_43e){},onVertexMoveStop:function(_43f,_440,_441){},onVertexAdd:function(_442,_443){this._modified=true;},onVertexClick:function(_444,_445){},onVertexMouseOver:function(_446,_447){},onVertexMouseOut:function(_448,_449){},onVertexDelete:function(_44a,_44b){this._modified=true;},onScaleStart:function(_44c){},onScaleFirstMove:function(_44d){this._modified=true;},onScale:function(_44e,info){},onScaleStop:function(_44f,info){},onRotateStart:function(_450){},onRotateFirstMove:function(_451){this._modified=true;},onRotate:function(_452,info){},onRotateStop:function(_453,info){},_enableMove:function(_454){var map=this._map,type=_454.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new esri.toolbars._GraphicMover(_454,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_455){var map=this._map,type=_455.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=esri.toolbars._GraphicVertexEditor.create(_455,map,this);return true;}return false;},_enableBoxEditing:function(_456,_457,_458){var map=this._map,type=_456.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new esri.toolbars._Box(_456,map,this,_457,_458);return true;}return false;},_disableMove:function(){var _459=this._graphicMover;if(_459){_459.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _45a=this._vertexEditor;if(_45a){_45a.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_45b){if(_45b){this._refreshMoveables();}},_refreshMoveables:function(_45c){var _45d=dojo.filter([this._graphicMover,this._vertexEditor,this._boxEditor],esri._isDefined);dojo.forEach(_45d,function(mov){mov.refresh(_45c);});},_beginOperation:function(_45e){dojo.forEach(this._getAffectedTools(_45e),function(tool){tool.suspend();});},_endOperation:function(_45f){dojo.forEach(this._getAffectedTools(_45f),function(tool){tool.resume();});},_getAffectedTools:function(_460){var _461=[];switch(_460){case "MOVE":_461=[this._vertexEditor,this._boxEditor];break;case "VERTICES":_461=[this._boxEditor];break;case "BOX":_461=[this._vertexEditor];break;}_461=dojo.filter(_461,esri._isDefined);return _461;}});dojo.mixin(esri.toolbars.Edit,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});});},"dojo/data/util/filter":function(){define(["dojo/_base/lang"],function(lang){var _462=lang.getObject("dojo.data.util.filter",true);_462.patternToRegExp=function(_463,_464){var rxp="^";var c=null;for(var i=0;i<_463.length;i++){c=_463.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_463.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_464){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _462;});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(_465,_466,lang,win,_467,has,_468,_469,_46a,util,html){var dg=_465.grid;var _46b=function(td){return td.cellIndex>=0?td.cellIndex:_466.indexOf(td.parentNode.cells,td);};var _46c=function(tr){return tr.rowIndex>=0?tr.rowIndex:_466.indexOf(tr.parentNode.childNodes,tr);};var _46d=function(_46e,_46f){return _46e&&((_46e.rows||0)[_46f]||_46e.childNodes[_46f]);};var _470=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _471=function(_472,_473){for(var n=_472;n&&_473(n);n=n.parentNode){}return n;};var _474=function(_475){var name=_475.toUpperCase();return function(node){return node.tagName!=name;};};var _476=util.rowIndexTag;var _477=util.gridViewTag;var _478=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_479,_47a,_47b,_47c){var _47d=[],html;if(_47c){var _47e=_479.index!=_479.grid.getSortIndex()?"":_479.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_479.id){_479.id=this.grid.id+"Hdr"+_479.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_47e,"id=\"",_479.id,"\""];}else{var _47f=this.grid.editable&&!_479.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_47f];}if(_479.colSpan){html.push(" colspan=\"",_479.colSpan,"\"");}if(_479.rowSpan){html.push(" rowspan=\"",_479.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_479.classes){html.push(_479.classes," ");}if(_47b){html.push(_47b," ");}_47d.push(html.join(""));_47d.push("");html=["\" idx=\"",_479.index,"\" style=\""];if(_47a&&_47a[_47a.length-1]!=";"){_47a+=";";}html.push(_479.styles,_47a||"",_479.hidden?"display:none;":"");if(_479.unitWidth){html.push("width:",_479.unitWidth,";");}_47d.push(html.join(""));_47d.push("");html=["\""];if(_479.attrs){html.push(" ",_479.attrs);}html.push(">");_47d.push(html.join(""));_47d.push("");_47d.push(_47c?"</th>":"</td>");return _47d;},isCellNode:function(_480){return Boolean(_480&&_480!=win.doc&&html.attr(_480,"idx"));},getCellNodeIndex:function(_481){return _481?Number(html.attr(_481,"idx")):-1;},getCellNode:function(_482,_483){for(var i=0,row;((row=_46d(_482.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_483){return cell;}}}return null;},findCellTarget:function(_484,_485){var n=_484;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_477 in n.offsetParent.parentNode&&n.offsetParent.parentNode[_477]!=this.view.id))&&(n!=_485)){n=n.parentNode;}return n!=_485?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_486,_487){var n=_486;while(n&&(n!=this.domNode)&&(!(_487 in n)||(_477 in n&&n[_477]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_488){return this.findTarget(_488,_476);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _489=dg._ContentBuilder=lang.extend(function(view){_478.call(this,view);},_478.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _48a=this.grid.get,_48b=this.view.structure.cells;for(var j=0,row;(row=_48b[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_48a;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_48c,_48d){var html=this.getTableArray(),v=this.view,_48e=v.structure.cells,item=this.grid.getItem(_48d);util.fire(this.view,"onBeforeRow",[_48d,_48e]);for(var j=0,row;(row=_48e[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_48d,item);if(has("ie")<8&&(m[5]===null||m[5]===""||/^\s+$/.test(m[5]))){m[5]="&nbsp;";}m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_476];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _48f=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_478.call(this,view);},_478.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_490,_491){var html=this.getTableArray(),_492=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,_492]);for(var j=0,row;(row=_492[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_493;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_493=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_493[5]=(_491!=undefined?_491:_490(cell));_493[3]=cell.customStyles.join(";");_493[1]=cell.customClasses.join(" ");html.push(_493.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_471(e.target,_474("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_471(n,_474("table"));x-=(table&&table.offsetLeft)||0;}}n=_471(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){_467.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){_467.stop(e);return true;}return false;},colResizeSetup:function(e,_494){var _495=html.contentBox(e.sourceView.headerNode);if(_494){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _496=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_46a.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_496.h+_495.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _497=[],_498=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_498[i]);i++){_497.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var _499=e.grid.views.views;var _49a=[];for(var j=view.idx+adj,_49b;(_49b=_499[j]);j=j+adj){_49a.push({node:_49b.headerNode,left:window.parseInt(_49b.headerNode.style.left)});}var _49c=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_495.w,table:_49c,tw:html.contentBox(_49c).w,spanners:_497,followers:_49a};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _469(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_468.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_49d,_49e,_49f){var _4a0=_49f.l;var data={deltaX:_4a0,w:_49d.w+(this.grid.isLeftToRight()?_4a0:-_4a0),vw:_49d.vw+_4a0,tw:_49d.tw+_4a0};this.dragRecord={inDrag:_49d,mover:_49e,leftTop:_49f};if(data.w>=this.minColWidth){if(!_49e){this.doResizeNow(_49d,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_4a1){if(this.dragRecord){var _4a2=this.dragRecord.leftTop;var _4a3=this.grid.isLeftToRight()?_4a2.l:-_4a2.l;_4a3+=Math.max(_4a1.w+_4a3,this.minColWidth)-(_4a1.w+_4a3);if(has("webkit")&&_4a1.spanners.length){_4a3+=html._getPadBorderExtents(_4a1.spanners[0].node).w;}var data={deltaX:_4a3,w:_4a1.w+_4a3,vw:_4a1.vw+_4a3,tw:_4a1.tw+_4a3};this.doResizeNow(_4a1,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_4a1.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_4a1.index);},doResizeNow:function(_4a4,data){_4a4.view.convertColPctToFixed();if(_4a4.view.flexCells&&!_4a4.view.testFlexCells()){var t=_470(_4a4.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_4a4.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_4a4.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_4a4.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_4a4.node.style.width=data.w+"px";_4a4.view.setColWidth(_4a4.index,data.w);_4a4.view.headerNode.style.width=data.vw+"px";_4a4.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_4a4.view.headerNode.scrollLeft=_4a4.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_4a5){var _4a6=_4a5.length;if(!_4a6){return;}this.map=[];var row;for(var k=0;(row=_4a5[k]);k++){this.map[k]=[];}for(var j=0;(row=_4a5[j]);j++){for(var i=0,x=0,cell,_4a7,_4a8;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_4a8=cell.rowSpan||1;_4a7=cell.colSpan||1;for(var y=0;y<_4a8;y++){for(var s=0;s<_4a7;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_4a7;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_4a9,_4aa){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_4aa&&cell.r==_4a9){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_4ab,_4ac,_4ad){var row=_4ab&&_4ab.rows[_4ac];return row&&row.cells[_4ad];},_findOverlappingNodes:function(_4ae,_4af,_4b0){var _4b1=[];var m=this.getMapCoords(_4af,_4b0);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_4ae,rw.r,rw.c):null);if(n){_4b1.push(n);}}return _4b1;},findOverlappingNodes:function(_4b2){return this._findOverlappingNodes(_470(_4b2),_46c(_4b2.parentNode),_46b(_4b2));}});return {_Builder:_478,_HeaderBuilder:_48f,_ContentBuilder:_489};});},"dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,_4b3,_4b4,_4b5,has,util){return _4b4("dojox.grid._EditManager",null,{constructor:function(_4b6){this.grid=_4b6;if(has("ie")){this.connections=[_4b5.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_4b5.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){_4b3.forEach(this.connections,_4b5.disconnect);},cellFocus:function(_4b7,_4b8){if(this.grid.singleClickEdit||this.isEditRow(_4b8)){this.setEditCell(_4b7,_4b8);}else{this.apply();}if(this.isEditing()||(_4b7&&_4b7.editable&&_4b7.alwaysEditing)){this._focusEditor(_4b7,_4b8);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_4b9){if(_4b9.index==this.info.rowIndex){_4b9.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_4ba,_4bb){return (this.info.rowIndex===_4ba)&&(this.info.cell.index==_4bb);},isEditRow:function(_4bc){return this.info.rowIndex===_4bc;},setEditCell:function(_4bd,_4be){if(!this.isEditCell(_4be,_4bd.index)&&this.grid.canEdit&&this.grid.canEdit(_4bd,_4be)){this.start(_4bd,_4be,this.isEditRow(_4be)||_4bd.editable);}},_focusEditor:function(_4bf,_4c0){util.fire(_4bf,"focus",[_4c0]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_4c1,_4c2,_4c3){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_4c2)){this.applyRowEdit();this.grid.updateRow(_4c2);}if(_4c3){this.info={cell:_4c1,rowIndex:_4c2};this.grid.doStartEdit(_4c1,_4c2);this.grid.updateRow(_4c2);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_4c1,_4c2);this._doCatchBoomerang();},_editorDo:function(_4c4){var c=this.info.cell;if(c&&c.editable){c[_4c4](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_4c5,_4c6,_4c7){if(this.grid.canEdit(_4c6,_4c7)){this.grid.doApplyCellEdit(_4c5,_4c7,_4c6.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_4c8,_4c9){var c=this.info.cell;if(this.isEditRow(_4c8)&&(!_4c9||c.view==_4c9)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_4ca,_4cb){var c=this.info.cell;if(this.isEditRow(_4cb)&&c.view==_4ca&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"dojo/data/util/sorter":function(){define(["dojo/_base/lang"],function(lang){var _4cc=lang.getObject("dojo.data.util.sorter",true);_4cc.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_4cc.createSortFunction=function(_4cd,_4ce){var _4cf=[];function _4d0(attr,dir,comp,s){return function(_4d1,_4d2){var a=s.getValue(_4d1,attr);var b=s.getValue(_4d2,attr);return dir*comp(a,b);};};var _4d3;var map=_4ce.comparatorMap;var bc=_4cc.basicComparator;for(var i=0;i<_4cd.length;i++){_4d3=_4cd[i];var attr=_4d3.attribute;if(attr){var dir=(_4d3.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_4cf.push(_4d0(attr,dir,comp,_4ce));}}return function(rowA,rowB){var i=0;while(i<_4cf.length){var ret=_4cf[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _4cc;});},"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\r\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\r\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\r\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\r\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\r\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\r\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\r\n\t</div>\r\n</div>\r\n","esri/dijit/editing/TemplatePicker":function(){define(["dijit","dojo","dojox","dojo/require!dojo/data/ItemFileReadStore,dojox/grid/DataGrid,dijit/_Widget,dijit/_Templated,dojox/gfx,esri/utils,esri/symbol"],function(_4d4,dojo,_4d5){dojo.provide("esri.dijit.editing.TemplatePicker");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojox.grid.DataGrid");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dojox.gfx");dojo.require("esri.utils");dojo.require("esri.symbol");(function(){var css=[dojo.moduleUrl("esri.dijit.editing","css/TemplatePicker.css"),dojo.moduleUrl("dojox","grid/resources/Grid.css")];var head=document.getElementsByTagName("head").item(0),link,i,il=css.length;for(i=0;i<il;i++){link=document.createElement("link");link.type="text/css";link.rel="stylesheet";link.href=css[i].toString();head.appendChild(link);}}());dojo.declare("esri.dijit.editing.TemplatePicker",[_4d4._Widget,_4d4._Templated],{widgetsInTemplate:true,templateString:"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>",basePath:dojo.moduleUrl("esri.dijit.editing"),featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_4d6,_4d7){_4d6=_4d6||{};if(!_4d6.items&&!_4d6.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(dojo.version.minor>=4);this._itemWidgets={};if(_4d6.featureLayers&&_4d6.featureLayers.length){this._flChanged=1;}this._nls=dojo.getObject("bundle.widgets.templatePicker",false,esri);this.emptyMessage=_4d6.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=dojo.contentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=dojo.contentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();dojo.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(dojo.isIE<9){this._repaintItems=dojo.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _4d8=this._selectedCell,info=this._selectedInfo;if(_4d8){this._rowClicked({cellNode:_4d8,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_4d9){var _4da=(this.rows==="auto"&&this.columns==="auto"&&_4d9)?true:false,grid=this.grid,box;if(_4da){var _4db=this.domNode,id=_4db.id,_4dc,item=dojo.query("#"+id+".templatePicker div.item")[0];box=dojo.contentBox(_4db);item=item&&item.parentNode;if(item){_4dc=dojo.coords(item).w;}else{_4dc=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/_4dc);this._columns=this._columns||1;}var _4dd=this._rows;this._preprocess();var _4de=this._rows;this._setGridLayout();this._setGridData();if(_4de!==_4dd){grid.set("autoHeight",this._rows,false);}if(_4da){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_4df=this.getSelected();if(_4df){grid.store.fetch({onComplete:function(its){var _4e0=self._locate(_4df,self._selectedInfo,its);var _4e1=_4e0&&grid.views.views[0].getCellNode(_4e0[0],_4e0[1]);if(_4e1){self._rowClicked({cellNode:_4e1,rowIndex:_4e0[0],cellIndex:_4e0[1]},true);}}});}if(dojo.isIE<9){setTimeout(this._repaintItems,this._ieTimer);}var _4e2=this.featureLayers,_4e3=this.items;if((!_4e2||!_4e2.length)&&(!_4e3||!_4e3.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _4e4=this.useLegend;if(!this._started||_4e4!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_4e5){var _4e6=this.featureLayers;if(!this._started||_4e6!==_4e5){this._flChanged=1;}this.featureLayers=_4e5;},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var _4e7;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}_4e7=this._flItems=this._getItemsFromLayers(this.featureLayers);}else{_4e7=this._itItems=this._getItemsFromItems(this.items);}if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=_4e7.length;dojo.forEach(_4e7,function(_4e8){len+=Math.ceil(_4e8.length/this.columns);},this);}else{dojo.forEach(_4e7,function(_4e9){len+=_4e9.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(_4e7.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{dojo.forEach(_4e7,function(_4ea){len+=_4ea.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(_4e7.length/this.rows);}this._columns=len;}}},_processSelectionLayers:function(){var map,_4eb,info,_4ec,key,_4ed,_4ee,_4ef={};dojo.forEach(this.featureLayers,function(_4f0,idx){if(_4f0.mode===esri.layers.FeatureLayer.MODE_SELECTION&&_4f0._map&&_4f0.url&&_4f0._params.drawMode&&!_4f0.source){_4eb=dojo.trim(_4f0._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_4ef[_4eb]=_4ef[_4eb]||{});_4ec=(info.featureLayers=info.featureLayers||{});_4ed=(info.indices=info.indices||[]);_4ec[idx]=_4f0;_4ed.push(idx);map=_4f0._map;}});if(map){dojo.forEach(map.layerIds,function(_4f1){_4f1=map.getLayer(_4f1);if(_4f1&&_4f1.url&&(_4f1.getImageUrl||_4f1.getTileUrl)&&_4f1.loaded&&_4f1.version>=10.1){_4eb=dojo.trim(_4f1._url.path).replace(/(\/MapServer).*/ig,"$1");key=_4eb.replace(/^https?:\/\//ig,"").toLowerCase();if(_4ef[key]&&(!_4ef[key].mapServiceUrl)){info=_4ef[key];info.mapServiceUrl=_4eb;info.mapServiceLayer=_4f1;this._legendIndices=this._legendIndices.concat(info.indices);_4ee=this._fetchLegend({pickerInstance:this,info:info},key);if(_4ee.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_4ee);}else{this._processLegendResponse(_4ee,info);}}}},this);}},_fetchLegend:function(_4f2,key){var _4f3=esri.dijit.editing.TemplatePicker.prototype,_4f4=_4f3.legendCache[key];if(!_4f4){_4f4=(_4f3.legendCache[key]=esri.request({url:_4f2.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_4f4._contexts=[_4f2];_4f4.addBoth(function(_4f5){if(_4f4.canceled){return;}_4f3.legendCache[key]=_4f5;var _4f6=_4f4._contexts;_4f4._contexts=null;dojo.forEach(_4f6,function(ctxt){var _4f7=ctxt.pickerInstance,info=ctxt.info,_4f8;if(_4f7._destroyed){return;}dojo.forEach(info.indices,function(idx){_4f8=dojo.indexOf(_4f7._loadingIndices,idx);if(_4f8>-1){_4f7._loadingIndices.splice(_4f8,1);}});_4f8=dojo.indexOf(_4f7._loadingLegends,_4f4);if(_4f8>-1){_4f7._loadingLegends.splice(_4f8,1);}_4f7._processLegendResponse(_4f5,info);});});}else{if(_4f4.then){_4f4._contexts.push(_4f2);}}return _4f4;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){dojo.forEach(this._loadingLegends,function(_4f9){var _4fa=-1;dojo.some(_4f9._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){_4fa=idx;}return (_4fa>-1);},this);if(_4fa>-1){_4f9._contexts.splice(_4fa,1);}},this);}},_processLegendResponse:function(_4fb,info){if(_4fb&&!(_4fb instanceof Error)){dojo.forEach(info.indices,function(idx){var _4fc=info.featureLayers[idx].layerId,i,_4fd=info.mapServiceUrl+"/"+_4fc+"/images/",_4fe=info.mapServiceLayer._getToken(),_4ff,obj,_500,url;if(this._legendSymbols[idx]){return;}_4ff=null;dojo.some(_4fb.layers,function(_501){if(_501.layerId==_4fc){_4ff=_501;}return !!_4ff;});if(_4ff){obj=(this._legendSymbols[idx]={});dojo.forEach(_4ff.legend,function(_502){_500=_502.values;if(_500&&_500.length){for(i=0;i<_500.length;i++){obj[_500[i]]=_502;}}else{obj.defaultSymbol=_502;}url=_502.url;if(url&&!_502._fixed){_502._fixed=1;if((url.search(/https?\:/)===-1)){_502.url=_4fd+url;}if(_4fe&&_502.url.search(/https?\:/)!==-1){_502.url+=(((_502.url.indexOf("?")>-1)?"&":"?")+"token="+_4fe);}}});}},this);}else{var _503;dojo.forEach(info.indices,function(idx){_503=dojo.indexOf(this._legendIndices,idx);if(_503>-1){this._legendIndices.splice(_503,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _504=grid.adaptWidth,_505,i,view;grid.adaptWidth=function(){_505=this.views.views;for(i=0;view=_505[i];i++){dojo.style(view.headerNode,"display","block");}_504.apply(this,arguments);for(i=0;view=_505[i];i++){dojo.style(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _506=dojo.connect(grid,"_onFetchComplete",this,function(){dojo.disconnect(_506);this.grid.set("autoHeight",this._rows);});}dojo.connect(grid,"_onDelete",this,this._destroyItems);dojo.connect(grid,"_clearData",this,this._destroyItems);dojo.connect(grid,"destroy",this,this._destroyItems);var _507=grid.focus;if(_507&&_507.findAndFocusGridCell){_507.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _508=function(_509){return function(_50a,_50b){return this._cellGet(_509,_50a,_50b);};};var _50c=dojo.hitch(this,this._cellFormatter),_50d=[],cols=this._columns,i;for(i=0;i<cols;i++){_50d.push({field:"cell"+i,get:dojo.hitch(this,_508(i)),formatter:_50c});}var _50e={cells:[_50d]};if(this.grouping){var _50f={field:"groupName",colSpan:cols,get:dojo.hitch(this,this._cellGetGroup),formatter:dojo.hitch(this,this._cellGroupFormatter)};_50e.cells.push([_50f]);}var grid=this.grid,_510=_4d5.grid.DataGrid.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_510)?this._rows:_510);grid.set("structure",_50e);},_setGridData:function(){var _511=[];if(this.grouping){this._groupRowIndices=[];var _512,_513,cols=this._columns;dojo.forEach(this._flItems,function(_514,idx){_511.push({});var _515=(idx===0)?0:(_512+_513+1);this._groupRowIndices.push(_515);_512=_515;_513=Math.ceil(_514.length/cols);_511=_511.concat(this._getStoreItems(_514));},this);}else{if(this.featureLayers){dojo.forEach(this._flItems,function(_516){_511=_511.concat(_516);});_511=this._getStoreItems(_511);}else{_511=this._getStoreItems(this._itItems);}}var _517=new dojo.data.ItemFileReadStore({data:{items:_511}});this.grid.setStore(_517);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=dojo.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=dojo.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=dojo.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){dojo.disconnect(this._mouseOverConnect);dojo.disconnect(this._mouseOutConnect);dojo.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_518){var _519=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_519,row,col);if(!cell){return;}var _51a=this.grid.store;if(_51a.getValue(cell,"loadingCell")){return;}if(this._selectedCell){dojo.removeClass(this._selectedCell,"selectedItem");}if(_519!==this._selectedCell){dojo.addClass(_519,"selectedItem");this._selectedCell=_519;this._selectedItem={featureLayer:_51a.getValue(cell,"layer"),type:_51a.getValue(cell,"type"),template:_51a.getValue(cell,"template"),symbolInfo:_51a.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:_51a.getValue(cell,"index1"),index2:_51a.getValue(cell,"index2"),index:_51a.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_518){this.onSelectionChange();}},_locate:function(_51b,info,_51c){var _51d=this.grid.store,cols=new Array(this._columns);var _51e,_51f=info.index1,_520=info.index2,_521=info.index,item=_51b.item;dojo.some(_51c,function(_522,_523){return dojo.some(cols,function(_524,_525){var cell=_51d.getValue(_522,"cell"+_525);if(cell&&(item?(_521===_51d.getValue(cell,"index")):(_51f===_51d.getValue(cell,"index1")&&_520===_51d.getValue(cell,"index2")))){_51e=[_523,_525];return true;}else{return false;}});});return _51e;},_getCellInfo:function(_526,row,col){if(!_526){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var _527=this.items;if(_527){return _527[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _528=this.tooltip;var _529=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_529,row,col);if(_528&&cell){var _52a=this.grid.store;var _52b=_52a.getValue(cell,"template");var type=_52a.getValue(cell,"type");var _52c=_52a.getValue(cell,"symbolInfo");var _52d=_52a.getValue(cell,"layer");var item=this._getItem(cell);var _52e=(item&&(item.label+(item.description?(": "+item.description):"")))||(_52b&&(_52b.name+(_52b.description?(": "+_52b.description):"")))||(type&&type.name)||(_52c&&(_52c.label+(_52c.description?(": "+_52c.description):"")))||((_52d&&_52d.name+": ")+"Default");_528.style.display="none";_528.innerHTML=_52e;var _52f=dojo.coords(_529.firstChild);dojo.style(_528,{left:(_52f.x)+"px",top:(_52f.y+_52f.h+5)+"px"});_528.style.display="";}},_cellMouseOut:function(){var _530=this.tooltip;if(_530){_530.style.display="none";}},_destroyItems:function(){var _531=this._itemWidgets,w;for(w in _531){if(!_531[w]){continue;}_531[w].destroy();delete _531[w];}},_repaintItems:function(){var _532=this._itemWidgets,w;for(w in _532){var _533=_532[w];if(_533){_533._repaint(_533._surface);}}},_getStoreItems:function(_534){var uid=this._uniqueId;_534=dojo.map(_534,function(item){return dojo.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_534.length,_535=0,obj={},k=0,prop,_536=[],flag=true,cols=this._columns;while(_535<len){flag=true;prop="cell"+k;obj[prop]=_534[_535];_535++;k++;if(k%cols===0){flag=false;_536.push(obj);obj={};k=0;}}if(flag&&len){_536.push(obj);}return _536;},_getItemsFromLayers:function(_537){var _538=[];dojo.forEach(_537,function(_539,_53a){_538.push(this._getItemsFromLayer(_539,_53a));},this);return _538;},_getItemsFromLayer:function(_53b,_53c){var _53d=[];if(this.useLegend&&dojo.indexOf(this._loadingIndices,_53c)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:_53b,type:null,template:null,index1:_53c,index2:0,loadingCell:1}];}var _53e=[];_53e=_53e.concat(_53b.templates);dojo.forEach(_53b.types,function(_53f){var _540=_53f.templates;dojo.forEach(_540,function(_541){_541._type_=_53f;});_53e=_53e.concat(_540);});_53e=dojo.filter(_53e,esri._isDefined);var _542=_53b.renderer;if(_542){var _543=_542.declaredClass.replace("esri.renderer.","");if(_53e.length>0){dojo.forEach(_53e,function(_544){var _545=_544.prototype;if(_545){var _546=_542.getSymbol(_545);if(_546){var _547=null,pms,_548;if(this.useLegend&&dojo.indexOf(this._legendIndices,_53c)>-1){_548=this._legendSymbols&&this._legendSymbols[_53c];if(_548){switch(_543){case "SimpleRenderer":_547=_548.defaultSymbol;break;case "UniqueValueRenderer":dojo.some(_542.infos,function(info){if(info.symbol===_546){_547=_548[info.value];}return !!_547;});break;case "ClassBreaksRenderer":dojo.some(_542.infos,function(info){if(info.symbol===_546){_547=_548[info.maxValue];}return !!_547;});break;}}if(_547){pms=dojo.fromJson(dojo.toJson(esri.symbol.defaultPictureMarkerSymbol));pms.url=_547.url;pms.imageData=_547.imageData;pms.contentType=_547.contentType;pms.width=_547.width;pms.height=_547.height;if(!esri._isDefined(pms.width)||!esri._isDefined(pms.height)){pms.width=15;pms.height=15;}_547=new esri.symbol.PictureMarkerSymbol(pms);}}_53d.push({label:this._trimLabel(_544.name),symbol:_547||_546,legendOverride:!!_547,layer:_53b,type:_544._type_,template:_544,index1:_53c,index2:_53d.length});}}delete _544._type_;},this);}else{var _549=[];if(_543==="TemporalRenderer"){_542=_542.observationRenderer;if(_542){_543=_542.declaredClass.replace("esri.renderer.","");}}switch(_543){case "SimpleRenderer":_549=[{symbol:_542.symbol,label:_542.label,description:_542.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":_549=_542.infos;break;}_53d=dojo.map(_549,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:dojo.mixin({constructor:function(){}},info),symbol:info.symbol,layer:_53b,index1:_53c,index2:idx};},this);}}return _53d;},_getItemsFromItems:function(_54a){return dojo.map(_54a,function(item,idx){item=dojo.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(_54b){var max=this.maxLabelLength;if(max&&_54b){if(_54b.length>max){_54b=_54b.substr(0,max)+"...";}}return _54b||"";},_cellGet:function(_54c,_54d,_54e){if(!_54e){return "";}return this.grid.store.getValue(_54e,"cell"+_54c);},_cellFormatter:function(_54f){if(_54f){var _550=this._itemWidgets,_551=this.grid.store;var sid=_551.getValue(_54f,"surfaceId");var w=_550[sid];if(!w){w=(_550[sid]=new esri.dijit.editing.TemplatePickerItem({id:sid,label:_551.getValue(_54f,"label"),symbol:_551.getValue(_54f,"symbol"),legendOverride:_551.getValue(_54f,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:_551.getValue(_54f,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_552,_553){if(!this._groupRowIndices){return "";}var _554=dojo.indexOf(this._groupRowIndices,_552);if(!_553||_554===-1){return "";}return (this.featureLayers[_554]&&this.featureLayers[_554].name)||"";},_cellGroupFormatter:function(_555){if(_555){return "<div class='groupLabel'>"+_555+"</div>";}else{return "";}}});dojo.declare("esri.dijit.editing.TemplatePickerItem",[_4d4._Widget,_4d4._Templated],{templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(node,_556,_557,_558,_559){if(!_556){return;}var _55a=_4d5.gfx.createSurface(node,_557,_558);if(dojo.isIE<9){var _55b=_55a.getEventSource();dojo.style(_55b,"position","relative");dojo.style(_55b.parentNode,"position","relative");}var _55c=(!this.legendOverride&&this._getDrawingToolShape(_556,_559))||esri.symbol.getShapeDescriptors(_556);var _55d;try{_55d=_55a.createShape(_55c.defaultShape).setFill(_55c.fill).setStroke(_55c.stroke);}catch(e){_55a.clear();_55a.destroy();return;}var dim=_55a.getDimensions();var _55e={dx:dim.width/2,dy:dim.height/2};var bbox=_55d.getBoundingBox(),_55f=bbox.width,_560=bbox.height;if(_55f>_557||_560>_558){var _561=_55f>_560?_55f:_560;var _562=_557<_558?_557:_558;var _563=(_562-5)/_561;dojo.mixin(_55e,{xx:_563,yy:_563});}_55d.applyTransform(_55e);return _55a;},_getDrawingToolShape:function(_564,_565){var _566,_567=_565?_565.drawingTool||null:null;switch(_567){case "esriFeatureEditToolArrow":_566={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_566={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_566={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_566={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_566={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_566={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_566={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_566={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_566={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_564.type==="simplelinesymbol"||_564.type==="cartographiclinesymbol"){_566={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_566={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_566,fill:_564.getFill(),stroke:_564.getStroke()};},_repaint:function(_568){if(!_568){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_568.getStroke&&_568.setStroke){_568.setStroke(_568.getStroke());}if(_568.getFill&&_568.setFill){_568.setFill(_568.getFill());}if(_568.children&&dojo.isArray(_568.children)){dojo.forEach(_568.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});});},"dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_569,_56a,_56b,has){return _56a("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_56c){var i=_56c;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_56c);this.edit.styleRow(_56c);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _56d;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_56d=this.focus.getHeaderIndex();if(_56d>=0){this.setSortIndex(_56d);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_56b.stop(e);}if(!e.shiftKey){var _56e=this.edit.isEditing();this.edit.apply();if(!_56e){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _56f=this.focus.focusView||this.views.views[0];_56f.content.decorateEvent(e);this.onRowClick(e);_56b.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_56d=this.focus.getHeaderIndex();if(_56d>=0){this.setSortIndex(_56d);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_56b.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _570=e.keyCode;_56b.stop(e);_56d=this.focus.getHeaderIndex();if(_56d>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_56d,(_570==keys.LEFT_ARROW?-1:1)*5);}else{var _571=(_570==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_571*=-1;}this.focus.move(0,_571);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_56b.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_56b.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_56b.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_56b.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_569.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_569.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var _572;if(this._click.length>1&&has("ie")){_572=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){_572=this._click[0];}else{_572=e;}}this.focus.setFocusCell(_572.cell,_572.rowIndex);this.onRowClick(_572);this.edit.setEditCell(_572.cell,_572.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_573,_574){this.edit.cellFocus(_573,_574);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){_56b.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_569.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_569.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){_56b.stop(e);}},onStartEdit:function(_575,_576){},onApplyCellEdit:function(_577,_578,_579){},onCancelEdit:function(_57a){},onApplyEdit:function(_57b){},onCanSelect:function(_57c){return true;},onCanDeselect:function(_57d){return true;},onSelected:function(_57e){this.updateRowStyles(_57e);},onDeselected:function(_57f){this.updateRowStyles(_57f);},onSelectionChanged:function(){}});});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\"\r\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\r\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\r\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\r\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\r\n\t</td>\r\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\r\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\r\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\r\n</tr>\r\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_580,_581,_582,_583){return _580("dijit.CheckedMenuItem",_582,{templateString:_583,checked:false,_setCheckedAttr:function(_584){_581.toggle(this.domNode,"dijitCheckedMenuItemChecked",_584);this.domNode.setAttribute("aria-checked",_584);this._set("checked",_584);},iconClass:"",onChange:function(){},_onClick:function(e){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.inherited(arguments);}});});},"dojo/io/iframe":function(){define(["../main","require"],function(dojo,_585){dojo.getObject("io",true,dojo);dojo.io.iframe={create:function(_586,_587,uri){if(window[_586]){return window[_586];}if(window.frames[_586]){return window.frames[_586];}var turi=uri;if(!turi){if(dojo.config["useXDomain"]&&!dojo.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}turi=(dojo.config["dojoBlankHtmlUrl"]||_585.toUrl("../resources/blank.html"));}var _588=dojo.place("<iframe id=\""+_586+"\" name=\""+_586+"\" src=\""+turi+"\" onload=\""+_587+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",dojo.body());window[_586]=_588;return _588;},setSrc:function(_589,src,_58a){try{if(!_58a){if(dojo.isWebKit){_589.location=src;}else{frames[_589.name].location=src;}}else{var idoc;if(dojo.isIE||dojo.isWebKit){idoc=_589.contentWindow.document;}else{idoc=_589.contentWindow;}if(!idoc){_589.location=src;}else{idoc.location.replace(src);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_58b){return _58b.contentDocument||(((_58b.name)&&(_58b.document)&&(dojo.doc.getElementsByTagName("iframe")[_58b.name].contentWindow)&&(dojo.doc.getElementsByTagName("iframe")[_58b.name].contentWindow.document)))||((_58b.name)&&(dojo.doc.frames[_58b.name])&&(dojo.doc.frames[_58b.name].document))||null;},send:function(args){if(!this["_frame"]){this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");}var dfd=dojo._ioSetArgs(args,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _58c=null;try{var _58d=dfd.ioArgs;var dii=dojo.io.iframe;var ifd=dii.doc(dii._frame);var _58e=_58d.handleAs;_58c=ifd;if(_58e!="html"){if(_58e=="xml"){if(dojo.isIE<9||(dojo.isIE&&dojo.isQuirks)){dojo.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _58f=(dii._frame.contentWindow.document).documentElement.innerText;_58f=_58f.replace(/>\s+</g,"><");_58f=dojo.trim(_58f);var _590={responseText:_58f};_58c=dojo._contentHandlers["xml"](_590);}}else{_58c=ifd.getElementsByTagName("textarea")[0].value;if(_58e=="json"){_58c=dojo.fromJson(_58c);}else{if(_58e=="javascript"){_58c=dojo.eval(_58c);}}}}}catch(e){_58c=e;}finally{_58d._callNext();}return _58c;},function(_591,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _591;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;dojo.io.iframe._currentDfd=null;dojo.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();dojo._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}do{var dfd=this._currentDfd=this._dfdQueue.shift();}while(dfd&&dfd.canceled&&this._dfdQueue.length);if(!dfd||dfd.canceled){this._currentDfd=null;return;}var _592=dfd.ioArgs;var args=_592.args;_592._contentToClean=[];var fn=dojo.byId(args["form"]);var _593=args["content"]||{};if(fn){if(_593){var _594=function(name,_595){dojo.create("input",{type:"hidden",name:name,value:_595},fn);_592._contentToClean.push(name);};for(var x in _593){var val=_593[x];if(dojo.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_594(x,val[i]);}}else{if(!fn[x]){_594(x,val);}else{fn[x].value=val;}}}}var _596=fn.getAttributeNode("action");var _597=fn.getAttributeNode("method");var _598=fn.getAttributeNode("target");if(args["url"]){_592._originalAction=_596?_596.value:null;if(_596){_596.value=args.url;}else{fn.setAttribute("action",args.url);}}if(!_597||!_597.value){if(_597){_597.value=(args["method"])?args["method"]:"post";}else{fn.setAttribute("method",(args["method"])?args["method"]:"post");}}_592._originalTarget=_598?_598.value:null;if(_598){_598.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;dojo._ioNotifyStart(dfd);fn.submit();}else{var _599=args.url+(args.url.indexOf("?")>-1?"&":"?")+_592.query;dojo._ioNotifyStart(dfd);this.setSrc(this._frame,_599,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _59a=dfd.ioArgs;var args=_59a.args;var _59b=dojo.byId(args.form);if(_59b){var _59c=_59a._contentToClean;for(var i=0;i<_59c.length;i++){var key=_59c[i];for(var j=0;j<_59b.childNodes.length;j++){var _59d=_59b.childNodes[j];if(_59d.name==key){dojo.destroy(_59d);break;}}}if(_59a["_originalAction"]){_59b.setAttribute("action",_59a._originalAction);}if(_59a["_originalTarget"]){_59b.setAttribute("target",_59a._originalTarget);_59b.target=_59a._originalTarget;}}_59a._finished=true;}};return dojo.io.iframe;});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/event"],function(lang,arr,_59e,_59f,evt){return _59e("dojox.gfx.Mover",null,{constructor:function(_5a0,e,host){this.shape=_5a0;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document;this.events=[_59f.connect(d,"onmousemove",this,"onFirstMove"),_59f.connect(d,"ontouchmove",this,"onFirstMove"),_59f.connect(d,"onmousemove",this,"onMouseMove"),_59f.connect(d,"ontouchmove",this,"onMouseMove"),_59f.connect(d,"onmouseup",this,"destroy"),_59f.connect(d,"ontouchend",this,"destroy"),_59f.connect(d,"ondragstart",evt,"stop"),_59f.connect(d,"onselectstart",evt,"stop")];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var pos=e.touches?e.touches[0]:e;var x=pos.clientX;var y=pos.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;evt.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);_59f.disconnect(this.events.shift());_59f.disconnect(this.events.shift());},destroy:function(){arr.forEach(this.events,_59f.disconnect);var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(_5a1,lang,dom){var dgu=lang.getObject("grid.util",true,_5a1);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_5a2,_5a3){if(_5a3>=0){var s=_5a2.style;var v=_5a3+"px";if(_5a2&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_5a4,_5a5,_5a6,_5a7){var evts=(_5a7?_5a7:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_5a5.connect(_5a4,"on"+evts[i],_5a6);}};dgu.removeNode=function(_5a8){_5a8=dom.byId(_5a8);_5a8&&_5a8.parentNode&&_5a8.parentNode.removeChild(_5a8);return _5a8;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_5a9,_5aa,_5ab){if(_5a9.length<=_5aa){_5a9[_5aa]=_5ab;}else{_5a9.splice(_5aa,0,_5ab);}};dgu.arrayRemove=function(_5ac,_5ad){_5ac.splice(_5ad,1);};dgu.arraySwap=function(_5ae,inI,inJ){var _5af=_5ae[inI];_5ae[inI]=_5ae[inJ];_5ae[inJ]=_5af;};return _5a1.grid.util;});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_5b0,lang,_5b1,_5b2,_5b3,has,dom,_5b4,_5b5,_5b6,util){var _5b7=_5b0("dojox.grid._DeferredTextWidget",_5b6,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _5b8=function(_5b9){try{util.fire(_5b9,"focus");util.fire(_5b9,"select");}catch(e){}};var _5ba=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _5bb=_5b0("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_5bc){this._props=_5bc||{};lang.mixin(this,_5bc);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_5bd,_5be){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_5bd!=this.defaultValue&&f)?f.apply(s,_5be):_5bd;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _5b7({deferred:v},_5b5.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_5bf,_5c0){var f,i=this.grid.edit.info,d=this.get?this.get(_5bf,_5c0):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_5bf&&i.cell==this))){return this.formatEditing(d,_5bf);}else{return this._defaultFormat(d,[d,_5bf,this]);}},formatEditing:function(_5c1,_5c2){},getNode:function(_5c3){return this.view.getCellNode(_5c3,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_5c4){return (this.getNode(_5c4)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_5c5,_5c6){this.grid.edit.applyCellEdit(_5c5,this,_5c6);},cancelEdit:function(_5c7){this.grid.doCancelEdit(_5c7);},_onEditBlur:function(_5c8){if(this.grid.edit.isEditCell(_5c8,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_5c9,_5ca){if(this.commitOnBlur){_5b2.connect(_5c9,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_5ca),250);});}},needFormatNode:function(_5cb,_5cc){this._formatPending=true;_5ba(this,"_formatNode",_5cb,_5cc);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_5cd,_5ce){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_5ce),_5cd,_5ce);}},formatNode:function(_5cf,_5d0,_5d1){if(has("ie")){_5ba(this,"focus",_5d1,_5cf);}else{this.focus(_5d1,_5cf);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_5d2){return this.getEditNode(_5d2)[this._valueProp];},setValue:function(_5d3,_5d4){var n=this.getEditNode(_5d3);if(n){n[this._valueProp]=_5d4;}},focus:function(_5d5,_5d6){_5b8(_5d6||this.getEditNode(_5d5));},save:function(_5d7){this.value=this.value||this.getValue(_5d7);},restore:function(_5d8){this.setValue(_5d8,this.value);},_finish:function(_5d9){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_5da){this.applyEdit(this.getValue(_5da),_5da);this._finish(_5da);},cancel:function(_5db){this.cancelEdit(_5db);this._finish(_5db);}});_5bb.markupFactory=function(node,_5dc){var _5dd=lang.trim(_5b4.get(node,"formatter")||"");if(_5dd){_5dc.formatter=lang.getObject(_5dd)||_5dd;}var get=lang.trim(_5b4.get(node,"get")||"");if(get){_5dc.get=lang.getObject(get);}var _5de=function(attr,cell,_5df){var _5e0=lang.trim(_5b4.get(node,attr)||"");if(_5e0){cell[_5df||attr]=!(_5e0.toLowerCase()=="false");}};_5de("sortDesc",_5dc);_5de("editable",_5dc);_5de("alwaysEditing",_5dc);_5de("noresize",_5dc);_5de("draggable",_5dc);var _5e1=lang.trim(_5b4.get(node,"loadingText")||_5b4.get(node,"defaultValue")||"");if(_5e1){_5dc.defaultValue=_5e1;}var _5e2=function(attr,cell,_5e3){var _5e4=lang.trim(_5b4.get(node,attr)||"")||undefined;if(_5e4){cell[_5e3||attr]=_5e4;}};_5e2("styles",_5dc);_5e2("headerStyles",_5dc);_5e2("cellStyles",_5dc);_5e2("classes",_5dc);_5e2("headerClasses",_5dc);_5e2("cellClasses",_5dc);};var Cell=_5b0("dojox.grid.cells.Cell",_5bb,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_5e5,_5e6){this.needFormatNode(_5e5,_5e6);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_5e5+"\">";},formatNode:function(_5e7,_5e8,_5e9){this.inherited(arguments);this.registerOnBlur(_5e7,_5e9);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){_5b1.stop(e);}}},_finish:function(_5ea){this.inherited(arguments);var n=this.getEditNode(_5ea);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_5eb){_5bb.markupFactory(node,_5eb);var _5ec=lang.trim(_5b4.get(node,"keyFilter")||"");if(_5ec){_5eb.keyFilter=new RegExp(_5ec);}};var _5ed=_5b0("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_5ee){return _5ee+1;}});_5ed.markupFactory=function(node,_5ef){Cell.markupFactory(node,_5ef);};var _5f0=_5b0("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_5f1){this.values=this.values||this.options;},formatEditing:function(_5f2,_5f3){this.needFormatNode(_5f2,_5f3);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_5f2==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_5f4,_5f5){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=_5b3.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_5f6){var n=this.getEditNode(_5f6);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_5f0.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _5f7=lang.trim(_5b4.get(node,"options")||"");if(_5f7){var o=_5f7.split(",");if(o[0]!=_5f7){cell.options=o;}}var _5f8=lang.trim(_5b4.get(node,"values")||"");if(_5f8){var v=_5f8.split(",");if(v[0]!=_5f8){cell.values=v;}}};var _5f9=_5b0("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_5fa,_5fb){this.formatNode(this.getEditNode(_5fb),_5fa,_5fb);},applyStaticValue:function(_5fc){var e=this.grid.edit;e.applyCellEdit(this.getValue(_5fc),this,_5fc);e.start(this,_5fc,true);}});_5f9.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_5b0("dojox.grid.cells.Bool",_5f9,{_valueProp:"checked",formatEditing:function(_5fd,_5fe){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_5fd?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_5f9.markupFactory(node,cell);};return _5bb;});},"dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_5ff,_600,lang,util,html){var _601=function(_602){var i=0,n,p=_602.parentNode;while((n=p.childNodes[i++])){if(n==_602){return i-1;}}return -1;};var _603=function(_604){if(!_604){return;}dojo.forEach(_5ff.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_604,true)){w.destroy();}});};var _605=function(_606){var node=html.byId(_606);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _607=function(_608,_609){var _60a=[];var i=0,n;while((n=_608.childNodes[i])){i++;if(_605(n)==_609){_60a.push(n);}}return _60a;};var _60b=function(_60c){return _607(_60c,"div");};return _600("dojox.grid._Scroller",null,{constructor:function(_60d){this.setContentNodes(_60d);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_60e,_60f,_610){switch(arguments.length){case 3:this.rowsPerPage=_610;case 2:this.keepRows=_60f;case 1:this.rowCount=_60e;default:break;}this.defaultPageHeight=this.defaultRowHeight*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_611,_612){return _611?(Math.ceil(_611/_612)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_613){this.keepRows=_613;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_614){this.contentNodes=_614;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_615){this.invalidateNodes();this.rowCount=_615;var _616=this.pageCount;if(_616===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_616){for(var i=_616-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_616){this.height+=this.defaultPageHeight*(this.pageCount-_616-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_617){return Boolean(this.getDefaultPageNode(_617));},measurePage:function(_618){if(this.grid.rowHeight){var _619=this.grid.rowHeight+1;return ((_618+1)*this.rowsPerPage>this.rowCount?this.rowCount-_618*this.rowsPerPage:this.rowsPerPage)*_619;}var n=this.getDefaultPageNode(_618);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_61a,_61b){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_61a].style.top=_61b+"px";}},repositionPages:function(_61c){var _61d=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=_61d[_61c];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_61c):0);for(var p=_61c+1;p<=last;p++){n=_61d[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_61e){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_61e]);}},preparePage:function(_61f,_620){var p=(_620?this.popPage():null);for(var i=0;i<this.colCount;i++){var _621=this.pageNodes[i];var _622=(p===null?this.createPageNode():this.invalidatePageNode(p,_621));_622.pageIndex=_61f;_621[_61f]=_622;}},renderPage:function(_623){var _624=[];var i,j;for(i=0;i<this.colCount;i++){_624[i]=this.pageNodes[i][_623];}for(i=0,j=_623*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_624);}},removePage:function(_625){for(var i=0,j=_625*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_626){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_626,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_627){},pacifying:false,pacifyTicks:200,setPacifying:function(_628){if(this.pacifying!=_628){this.pacifying=_628;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _629=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _629;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _62a=(!this._invalidating);if(!_62a){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_62a=true;}}if(_62a){this.needPage(this.page,this.pageTop);}var _62b=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _62c=this.getPageHeight(this.page);this.averageRowHeight=(_62c>0&&_62b>0)?(_62c/_62b):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _62d=this.pageCount-1;var _62e=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_62d]=_62e;return _62e;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_62f,_630,_631){if(this.pageExists(_62f)){var oh=this.getPageHeight(_62f);var h=(this.measurePage(_62f));if(h===undefined){h=oh;}this.pageHeights[_62f]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_630)){if(!_631){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_62f);}}else{this.repositionPages(_62f);}}return h;}return 0;},rowHeightChanged:function(_632,_633){this.updatePageHeight(Math.floor(_632/this.rowsPerPage),false,_633);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_634){var ph=this.pageHeights[_634];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_635){return this.stack.push(_635);},popPage:function(){return this.stack.shift();},findPage:function(_636){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_636){break;}}this.page=i;this.pageTop=h;},buildPage:function(_637,_638,_639){this.preparePage(_637,_638);this.positionPage(_637,_639);this.installPage(_637);this.renderPage(_637);this.pushPage(_637);},needPage:function(_63a,_63b){var h=this.getPageHeight(_63a),oh=h;if(!this.pageExists(_63a)){this.buildPage(_63a,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),_63b);h=this.updatePageHeight(_63a,true);}else{this.positionPage(_63a,_63b);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_63c){this.grid.scrollTop=_63c;if(this.colCount){this.startPacify();this.findPage(_63c);var h=this.height;var b=this.getScrollBottom(_63c);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_63c);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_63d){return (this.windowHeight>=0?_63d+this.windowHeight:-1);},processNodeEvent:function(e,_63e){var t=e.target;while(t&&(t!=_63e)&&t.parentNode&&(t.parentNode.parentNode!=_63e)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_63e)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_601(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_63f,_640){},removeRow:function(_641){},getDefaultPageNode:function(_642){return this.getDefaultNodes()[_642];},positionPageNode:function(_643,_644){},getPageNodePosition:function(_645){return _645.offsetTop;},invalidatePageNode:function(_646,_647){var p=_647[_646];if(p){delete _647[_646];this.removePage(_646,p);_603(p);p.innerHTML="";}return p;},getPageRow:function(_648){return _648*this.rowsPerPage;},getLastPageRow:function(_649){return Math.min(this.rowCount,this.getPageRow(_649+1))-1;},getFirstVisibleRow:function(_64a,_64b,_64c){if(!this.pageExists(_64a)){return 0;}var row=this.getPageRow(_64a);var _64d=this.getDefaultNodes();var rows=_60b(_64d[_64a]);for(var i=0,l=rows.length;i<l&&_64b<_64c;i++,row++){_64b+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_64e,_64f,_650){if(!this.pageExists(_64e)){return 0;}var _651=this.getDefaultNodes();var row=this.getLastPageRow(_64e);var rows=_60b(_651[_64e]);for(var i=rows.length-1;i>=0&&_64f>_650;i--,row--){_64f-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_652){var _653=this.getDefaultNodes();var rows=_60b(_653[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_652){this.offset=h-(t-_652);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_654){var _655=Math.floor(_654/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_655;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_655;this.needPage(_655,this.pageTop);var _656=this.getDefaultNodes();var rows=_60b(_656[_655]);var r=_654-this.rowsPerPage*_655;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"dojo/dnd/Container":function(){define(["../main","../Evented","./common","../parser"],function(dojo,_657){dojo.declare("dojo.dnd.Container",_657,{skipForm:false,constructor:function(node,_658){this.node=dojo.byId(node);if(!_658){_658={};}this.creator=_658.creator||null;this.skipForm=_658.skipForm;this.parent=_658.dropParent&&dojo.byId(_658.dropParent);this.map={};this.current=null;this.containerState="";dojo.addClass(this.node,"dojoDndContainer");if(!(_658&&_658._skipStartup)){this.startup();}this.events=[dojo.connect(this.node,"onmouseover",this,"onMouseOver"),dojo.connect(this.node,"onmouseout",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",this,"onSelectStart"),dojo.connect(this.node,"onselectstart",this,"onSelectStart")];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||dojo.global;var m=this.map,e=dojo.dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return dojo.query("> .dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dojo.dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_659,_65a){if(!this.parent.firstChild){_65a=null;}else{if(_659){if(!_65a){_65a=this.parent.firstChild;}}else{if(_65a){_65a=_65a.nextSibling;}}}if(_65a){for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.insertBefore(t.node,_65a);}}else{for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_65b,node,ctor){_65b._skipStartup=true;return new ctor(node,_65b);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dojo.dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_65c){var _65d="dojoDnd"+type;var _65e=type.toLowerCase()+"State";dojo.replaceClass(this.node,_65d+_65c,_65d+this[_65e]);this[_65e]=_65c;},_addItemClass:function(node,type){dojo.addClass(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){dojo.removeClass(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _65f=node.parentNode;_65f;node=_65f,_65f=node.parentNode){if(_65f==this.parent&&dojo.hasClass(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!dojo.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dojo.dnd.getUniqueId();}dojo.addClass(t.node,"dojoDndItem");return t;}});dojo.dnd._createNode=function(tag){if(!tag){return dojo.dnd._createSpan;}return function(text){return dojo.create(tag,{innerHTML:text});};};dojo.dnd._createTrTd=function(text){var tr=dojo.create("tr");dojo.create("td",{innerHTML:text},tr);return tr;};dojo.dnd._createSpan=function(text){return dojo.create("span",{innerHTML:text});};dojo.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dojo.dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dojo.dnd._createTrTd:dojo.dnd._createNode(dojo.dnd._defaultCreatorNodes[tag]);return function(item,hint){var _660=item&&dojo.isObject(item),data,type,n;if(_660&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_660&&item.data)?item.data:item;type=(_660&&item.type)?item.type:["text"];n=(hint=="avatar"?dojo.dnd._createSpan:c)(String(data));}if(!n.id){n.id=dojo.dnd.getUniqueId();}return {node:n,data:data,type:type};};};return dojo.dnd.Container;});},"dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_661,_662,_663){return _661("dojox.grid.DataSelection",_663,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _662(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_663.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_664){var _665=this.grid.getItemIndex(_664);var idx=_663.prototype.getNextSelected.call(this,_665);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _666=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_666.push(this.grid.getItem(i));}}return _666;},addToSelection:function(_667){if(this.mode=="none"){return;}var idx=null;if(typeof _667=="number"||typeof _667=="string"){idx=_667;}else{idx=this.grid.getItemIndex(_667);}_663.prototype.addToSelection.call(this,idx);},deselect:function(_668){if(this.mode=="none"){return;}var idx=null;if(typeof _668=="number"||typeof _668=="string"){idx=_668;}else{idx=this.grid.getItemIndex(_668);}_663.prototype.deselect.call(this,idx);},deselectAll:function(_669){var idx=null;if(_669||typeof _669=="number"){if(typeof _669=="number"||typeof _669=="string"){idx=_669;}else{idx=this.grid.getItemIndex(_669);}_663.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_66a,_66b,lang,_66c){return _66a("dojox.grid._SelectionPreserver",null,{constructor:function(_66d){this.selection=_66d;var grid=this.grid=_66d.grid;this.reset();this._connects=[_66b.connect(grid,"_setStore",this,"reset"),_66b.connect(grid,"_addItem",this,"_reSelectById"),_66b.connect(_66d,"addToSelection",lang.hitch(this,"_selectById",true)),_66b.connect(_66d,"deselect",lang.hitch(this,"_selectById",false)),_66b.connect(_66d,"deselectAll",this,"reset")];},destroy:function(){this.reset();_66c.forEach(this._connects,_66b.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,_66e){if(item&&this.grid._hasIdentity){this.selection.selected[_66e]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_66f,_670){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_670,g=this.grid;if(typeof _670=="number"||typeof _670=="string"){var _671=g._by_idx[_670];item=_671&&_671.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_66f;}return item;}});});},"esri/layers/FeatureLayer":function(){define(["dijit","dojo","dojox","dojo/require!esri/layers/graphics,esri/tasks/query,dojo/io/iframe,esri/layers/agscommon,dojo/date/locale"],function(_672,dojo,_673){dojo.provide("esri.layers.FeatureLayer");dojo.require("esri.layers.graphics");dojo.require("esri.tasks.query");dojo.require("dojo.io.iframe");dojo.require("esri.layers.agscommon");dojo.require("dojo.date.locale");dojo.declare("esri.layers.FeatureLayer",esri.layers.GraphicsLayer,{constructor:function(url,_674){this._outFields=_674&&_674.outFields;this._loadCallback=_674&&_674.loadCallback;var _675=_674&&_674._usePatch;this._usePatch=(_675===null||_675===undefined)?true:_675;this._trackIdField=_674&&_674.trackIdField;this.objectIdField=_674&&_674.objectIdField;this._maxOffset=_674&&_674.maxAllowableOffset;this._optEditable=_674&&_674.editable;this._optAutoGen=_674&&_674.autoGeneralize;this.editSummaryCallback=_674&&_674.editSummaryCallback;this.userId=_674&&_674.userId;this.userIsAdmin=_674&&_674.userIsAdmin;this.useMapTime=(_674&&_674.hasOwnProperty("useMapTime"))?(!!_674.useMapTime):true;this.source=_674&&_674.source;this.gdbVersion=_674&&_674.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(esri._isDefined(_674&&_674.mode)?_674.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_674&&_674.tileWidth)||512;this._tileHeight=(_674&&_674.tileHeight)||512;this._mode=new esri.layers._OnDemandMode(this);var _676=_674&&_674.latticeTiling;this.latticeTiling=_676;break;case ctor.MODE_SELECTION:this._mode=new esri.layers._SelectionMode(this);this._isSelOnly=true;break;}this._initLayer=dojo.hitch(this,this._initLayer);this._selectHandler=dojo.hitch(this,this._selectHandler);this._editable=false;if(dojo.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new esri.tasks.QueryTask(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _677=this._url.path;this._fserver=false;if(_677.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _678=_674&&_674.resourceInfo;if(_678){this._initLayer(_678);}else{if(this.source){var _679={source:this.source.toJson()};this._url.query=dojo.mixin(this._url.query,{layer:dojo.toJson(_679)});}if(this.gdbVersion){this._url.query=dojo.mixin(this._url.query,{gdbVersion:this.gdbVersion});}esri.request({url:_677,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_67a,io){if(_67a||io){this._json=_67a;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_67a&&_67a._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;this._featureSet=_67a.featureSet;this._nextId=_67a.nextObjectId;_67a=_67a.layerDefinition;}if(_67a.hasOwnProperty("capabilities")){var _67b=(this.capabilities=_67a.capabilities);if(_67b&&_67b.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(esri._isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=dojo.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_67a.geometryType==="esriGeometryPolyline")||(_67a.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=esri._isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}this.minScale=_67a.effectiveMinScale||_67a.minScale||0;this.maxScale=_67a.effectiveMaxScale||_67a.maxScale||0;this.layerId=_67a.id;this.name=_67a.name;this.description=_67a.description;this.copyright=_67a.copyrightText;this.type=_67a.type;this.geometryType=_67a.geometryType;this.displayField=_67a.displayField;this.defaultDefinitionExpression=_67a.definitionExpression;this.fullExtent=new esri.geometry.Extent(_67a.extent);this.defaultVisibility=_67a.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_67a.indexedFields;this.maxRecordCount=_67a.maxRecordCount;this.canModifyLayer=_67a.canModifyLayer;this.supportsStatistics=_67a.supportsStatistics;this.supportsAdvancedQueries=_67a.supportsAdvancedQueries;this.hasLabels=_67a.hasLabels;this.canScaleSymbols=_67a.canScaleSymbols;this.supportsRollbackOnFailure=_67a.supportsRollbackOnFailure;this.syncCanReturnChanges=_67a.syncCanReturnChanges;this.isDataVersioned=_67a.isDataVersioned;this.editFieldsInfo=_67a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_67a.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_67a.relationships;this.allowGeometryUpdates=esri._isDefined(_67a.allowGeometryUpdates)?_67a.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _67c=(this.fields=[]),_67d=_67a.fields,i;for(i=0;i<_67d.length;i++){_67c.push(new esri.layers.Field(_67d[i]));}if(!this.objectIdField){this.objectIdField=_67a.objectIdField;if(!this.objectIdField){_67d=_67a.fields;for(i=0;i<_67d.length;i++){var _67e=_67d[i];if(_67e.type==="esriFieldTypeOID"){this.objectIdField=_67e.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noOIDField));}}if(!esri._isDefined(this._nextId)){var _67f=this.objectIdField,_680=-1;if(this._collection&&_67f){var fset=this._featureSet,_681=fset&&fset.features,il=_681?_681.length:0,oid,attr;for(i=0;i<il;i++){attr=_681[i].attributes;oid=attr&&attr[_67f];if(oid>_680){_680=oid;}}}this._nextId=(_680+1);}this.globalIdField=_67a.globalIdField;var _682=(this.typeIdField=_67a.typeIdField),_683;if(_682){_683=!this._getField(_682)&&this._getField(_682,true);if(_683){this.typeIdField=_683.name;}}this.visibilityField=_67a.visibilityField;var _684=_67a.defaultSymbol;if(_684){this.defaultSymbol=esri.symbol.fromJson(_684);}var _685=this.types=[],_686=_67a.types,_687,_688,_689,_68a=this.editFieldsInfo,_68b=_68a&&_68a.creatorField,_68c=_68a&&_68a.editorField,fix=(_68b||_68c),_68d=[];if(_686){for(i=0;i<_686.length;i++){_687=new esri.layers.FeatureType(_686[i]);_688=_687.templates;if(fix&&_688&&_688.length){_68d=_68d.concat(_688);}_685.push(_687);}}var _68e=_67a.templates,_68f,_690=this.templates=[];if(_68e){for(i=0;i<_68e.length;i++){_68f=new esri.layers.FeatureTemplate(_68e[i]);if(fix){_68d.push(_68f);}_690.push(_68f);}}for(i=0;i<_68d.length;i++){_689=dojo.getObject("prototype.attributes",false,_68d[i]);if(_689){if(_68b){delete _689[_68b];}if(_68c){delete _689[_68c];}}}var _691=_67a.timeInfo;if(_691){this.timeInfo=new esri.layers.TimeInfo(_691);this._startTimeField=_691.startTimeField;this._endTimeField=_691.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_691.trackIdField=this._trackIdField;}else{this._trackIdField=_691.trackIdField;}}this.hasAttachments=(!this._collection&&_67a.hasAttachments)?true:false;this.htmlPopupType=_67a.htmlPopupType;var _692=_67a.drawingInfo,_693;if(!this.renderer){if(_692&&_692.renderer){_693=_692.renderer;this.setRenderer(esri.renderer.fromJson(_693));if(_693.type==="classBreaks"){this.renderer._setMaxInclusiveness(true);}if(!this._collection){var _694=_693.type,_695=[];_693=this.renderer;switch(_694){case "simple":_695.push(_693.symbol);break;case "uniqueValue":case "classBreaks":_695.push(_693.defaultSymbol);_695=_695.concat(dojo.map(_693.infos,function(info){return info.symbol;}));break;}_695=dojo.filter(_695,esri._isDefined);var _696=this._url.path+"/images/",_697=this._getToken();dojo.forEach(_695,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_696+url;}if(_697&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_697);}}});}}else{if(_684){_686=this.types;if(_686.length>0){_693=new esri.renderer.UniqueValueRenderer(this.defaultSymbol,this.typeIdField);dojo.forEach(_686,function(type){_693.addValue(type.id,type.symbol);});}else{_693=new esri.renderer.SimpleRenderer(this.defaultSymbol);}this.setRenderer(_693);}else{if(!this._isTable){var _698;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_698=new esri.symbol.SimpleMarkerSymbol();break;case "esriGeometryPolyline":_698=new esri.symbol.SimpleLineSymbol();break;case "esriGeometryPolygon":_698=new esri.symbol.SimpleFillSymbol();break;}this.setRenderer(_698?new esri.renderer.SimpleRenderer(_698):null);}}}}var _699=(_692&&_692.transparency)||0;if(!esri._isDefined(this.opacity)&&_699>0){this.opacity=1-(_699/100);}this.version=_67a.currentVersion;if(!this.version){var ver;if("capabilities" in _67a||"drawingInfo" in _67a||"hasAttachments" in _67a||"htmlPopupType" in _67a||"relationships" in _67a||"timeInfo" in _67a||"typeIdField" in _67a||"types" in _67a){ver=10;}else{ver=9.3;}this.version=ver;}if((dojo.isIE||dojo.isSafari)&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();if(this._collection){this._fireUpdateStart();var _69a=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new esri.tasks.FeatureSet(_69a));this._fcAdded=true;}this.onLoad(this);var _69b=this._loadCallback;if(_69b){delete this._loadCallback;_69b(this);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _69c=this.renderer;if(_69c){this._ager=(_69c.declaredClass.indexOf("TemporalRenderer")!==-1&&_69c.observationAger&&_69c.observationRenderer);var _69d=dojo.filter([_69c,_69c.observationRenderer,_69c.latestObservationRenderer,_69c.trackRenderer],esri._isDefined);var _69e=[];dojo.forEach(_69d,function(rnd){_69e.push(rnd.attributeField);_69e.push(rnd.attributeField2);_69e.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_69e,esri._isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map,_69f){this._map=map;this._toggleTime(true);var div=this.inherited("_setMap",arguments);this.clearSelection();var _6a0=this.renderer;if(this.timeInfo){if(this._trackIdField||(_6a0&&(_6a0.latestObservationRenderer||_6a0.trackRenderer))){this._trackManager=new esri.layers._TrackManager(this);this._trackManager.initialize(map);}}this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._zoomHandler);this._zoomHandler();var mode=this._mode;if(mode){mode.initialize(map);}return div;},_unsetMap:function(map,_6a1){var mode=this._mode;if(mode){mode.destroy();this._mode=null;}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}dojo.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},setEditable:function(_6a2){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_6a2;return this;}var _6a3=this._editable;this._editable=_6a2;this._updateCaps();if(_6a3!==_6a2){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_6a4){var _6a5={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _6a5;}var _6a6=_6a4&&_6a4.feature,_6a7=_6a4&&_6a4.userId,caps=dojo.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),dojo.trim),_6a8=dojo.indexOf(caps,"editing")>-1,_6a9=_6a8&&(dojo.indexOf(caps,"create")>-1),_6aa=_6a8&&(dojo.indexOf(caps,"update")>-1),_6ab=_6a8&&(dojo.indexOf(caps,"delete")>-1),_6ac=this.ownershipBasedAccessControlForFeatures,_6ad=this.editFieldsInfo,_6ae=_6ad&&_6ad.creatorField,_6af=_6ad&&_6ad.realm,_6b0=_6a6&&_6a6.attributes,_6b1=(_6b0&&_6ae)?_6b0[_6ae]:undefined,_6b2,_6b3=!!this.userIsAdmin,_6b4=!_6ac||_6b3||!!(_6ac.allowOthersToUpdate||_6ac.allowUpdateToOthers),_6b5=!_6ac||_6b3||!!(_6ac.allowOthersToDelete||_6ac.allowDeleteToOthers);if(_6b3||(_6a8&&!(_6a9||_6aa||_6ab))){_6a9=_6aa=_6ab=true;}_6b2={"canCreate":_6a9,"canUpdate":_6aa,"canDelete":_6ab};if(_6b1===null){_6b2.canUpdate=_6aa&&_6b4;_6b2.canDelete=_6ab&&_6b5;}else{if(_6b1===""){return _6b2;}else{if(_6b1){_6a7=_6a7||this.getUserId();if(_6a7&&_6af){_6a7=_6a7+"@"+_6af;}if(_6a7.toLowerCase()===_6b1.toLowerCase()){return _6b2;}else{_6b2.canUpdate=_6aa&&_6b4;_6b2.canDelete=_6ab&&_6b5;}}}}return _6b2;},getUserId:function(){var _6b6;if(this.loaded){_6b6=(this.credential&&this.credential.userId)||this.userId||"";}return _6b6;},setUserIsAdmin:function(_6b7){this.userIsAdmin=_6b7;},setEditSummaryCallback:function(_6b8){this.editSummaryCallback=_6b8;},getEditSummary:function(_6b9,_6ba,_6bb){_6bb=esri._isDefined(_6bb)?_6bb:(new Date()).getTime();var _6bc="",info=this.getEditInfo(_6b9,_6ba,_6bb),_6bd=(_6ba&&_6ba.callback)||this.editSummaryCallback;if(_6bd){info=_6bd(_6b9,info)||"";}if(dojo.isString(info)){_6bc=info;}else{if(info){var _6be=info.action,_6bf=info.userId,_6c0=info.timeValue,_6c1=0;if(_6be){_6c1++;}if(_6bf){_6c1++;}if(esri._isDefined(_6c0)){_6c1++;}if(_6c1>1){_6bc=(_6be==="edit"?"edit":"create")+(_6bf?"User":"")+(esri._isDefined(_6c0)?info.displayPattern:"");}}_6bc=_6bc&&esri.substitute(info,esri.bundle.layers.FeatureLayer[_6bc]);}return _6bc;},getEditInfo:function(_6c2,_6c3,_6c4){if(!this.loaded){return;}_6c4=esri._isDefined(_6c4)?_6c4:(new Date()).getTime();var _6c5=(_6c3&&_6c3.action)||"last",_6c6=this.editFieldsInfo,_6c7=_6c6&&_6c6.creatorField,_6c8=_6c6&&_6c6.creationDateField,_6c9=_6c6&&_6c6.editorField,_6ca=_6c6&&_6c6.editDateField,_6cb=_6c6&&_6c6.realm,_6cc=_6c2&&_6c2.attributes,_6cd=(_6cc&&_6c7)?_6cc[_6c7]:undefined,_6ce=(_6cc&&_6c8)?_6cc[_6c8]:null,_6cf=(_6cc&&_6c9)?_6cc[_6c9]:undefined,_6d0=(_6cc&&_6ca)?_6cc[_6ca]:null,_6d1=this._getEditData(_6cd,_6ce,_6c4),_6d2=this._getEditData(_6cf,_6d0,_6c4),_6d3;switch(_6c5){case "creation":_6d3=_6d1;break;case "edit":_6d3=_6d2;break;case "last":_6d3=_6d2||_6d1;break;}if(_6d3){_6d3.action=(_6d3===_6d2)?"edit":"creation";}return _6d3;},_getEditData:function(_6d4,_6d5,_6d6){var data,_6d7,_6d8,_6d9=60000,_6da=3600000,_6db=2*_6da,_6dc=24*_6da,_6dd=7*_6dc;if(esri._isDefined(_6d5)){_6d7=_6d6-_6d5;if(_6d7<0){_6d8="Full";}else{if(_6d7<_6d9){_6d8="Seconds";}else{if(_6d7<(2*_6d9)){_6d8="Minute";}else{if(_6d7<_6da){_6d8="Minutes";}else{if(_6d7<_6db){_6d8="Hour";}else{if(_6d7<_6dc){_6d8="Hours";}else{if(_6d7<_6dd){_6d8="WeekDay";}else{_6d8="Full";}}}}}}}}if((_6d4!==undefined)||_6d8){data=data||{};data.userId=_6d4;if(_6d8){var _6de=dojo.date.locale.format,_6df=new Date(_6d5);data.minutes=Math.floor(_6d7/_6d9);data.hours=Math.floor(_6d7/_6da);data.weekDay=_6de(_6df,{datePattern:"EEEE",selector:"date"});data.formattedDate=_6de(_6df,{selector:"date"});data.formattedTime=_6de(_6df,{selector:"time"});data.displayPattern=_6d8;data.timeValue=_6d5;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_6e0){if(!this.isEditable()){this._maxOffset=_6e0;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_6e1){if(!this.loaded){this._optAutoGen=_6e1;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_6e1;if(_6e1){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setScaleRange:function(_6e2,_6e3){this.minScale=_6e2||0;this.maxScale=_6e3||0;if(this._map&&this._map.loaded){this._updateStatus();}},setGDBVersion:function(_6e4){if(!this._collection&&(_6e4!==this.gdbVersion)&&(_6e4||this.gdbVersion)){this.gdbVersion=_6e4;this._task.gdbVersion=_6e4;this._url.query=dojo.mixin(this._url.query,{gdbVersion:_6e4});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_6e5){if(this._isSnapshot){this._timeDefn=_6e5;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_6e6,_6e7){this._timeOffset=_6e6;this._timeOffsetUnits=_6e7;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this._suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_6e8,_6e9,_6ea,_6eb){_6e9=_6e9||this.constructor.SELECTION_NEW;var _6ec=this._getShallowClone(_6e8),map=this._map,_6ed,dfd=esri._fixDfd(new dojo.Deferred(esri._dfdCanceller));_6ec.outFields=this._getOutFields();_6ec.returnGeometry=true;if(map){_6ec.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_6ec)){_6ed={features:[]};this._selectHandler(_6ed,_6e9,_6ea,_6eb,dfd);return dfd;}var _6ee=this._canDoClientSideQuery(_6ec);if(_6ee){_6ed={features:this._doQuery(_6ec,_6ee)};this._selectHandler(_6ed,_6e9,_6ea,_6eb,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_6eb,dfd,true);return dfd;}var self=this;if(this._ts){_6ec._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_6ec);temp.addCallbacks(function(_6ef){self._selectHandler(_6ef,_6e9,_6ea,_6eb,dfd);},function(err){self._resolve([err],null,_6eb,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _6f0=this._selectedFeatures,_6f1=[],item;for(item in _6f0){if(_6f0.hasOwnProperty(item)){_6f1.push(_6f0[item]);}}return _6f1;},clearSelection:function(_6f2){var _6f3=this._selectedFeatures,mode=this._mode,item;for(item in _6f3){if(_6f3.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_6f2){this.onSelectionClear();}return this;},setSelectionSymbol:function(_6f4){this._selectionSymbol=_6f4;if(_6f4){var _6f5=this._selectedFeatures,item;for(item in _6f5){if(_6f5.hasOwnProperty(item)){_6f5[item].setSymbol(_6f4);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_6f6,_6f7,_6f8,_6f9,_6fa){var _6fb=_6fa.assembly,dfd=_6fa.dfd;this._applyNormalized(adds,_6fb&&_6fb[0]);this._applyNormalized(_6f6,_6fb&&_6fb[1]);this.onBeforeApplyEdits(adds,_6f6,_6f7);var i,_6fc={},_6fd=this.objectIdField,_6fe={f:"json"},_6ff=false;if(this._collection){var _700={};_700.addResults=adds?dojo.map(adds,function(){_6ff=true;return {objectId:this._nextId++,success:true};},this):null;_700.updateResults=_6f6?dojo.map(_6f6,function(_701){_6ff=true;var oid=_701.attributes[_6fd];_6fc[oid]=_701;return {objectId:oid,success:true};},this):null;_700.deleteResults=_6f7?dojo.map(_6f7,function(_702){_6ff=true;return {objectId:_702.attributes[_6fd],success:true};},this):null;if(_6ff){this._editHandler(_700,adds,_6fc,_6f8,_6f9,dfd);}return;}if(adds&&adds.length>0){_6fe.adds=this._convertFeaturesToJson(adds,0,1);_6ff=true;}if(_6f6&&_6f6.length>0){for(i=0;i<_6f6.length;i++){var _703=_6f6[i];_6fc[_703.attributes[_6fd]]=_703;}_6fe.updates=this._convertFeaturesToJson(_6f6,0,0,1);_6ff=true;}if(_6f7&&_6f7.length>0){var ids=[];for(i=0;i<_6f7.length;i++){ids.push(_6f7[i].attributes[_6fd]);}_6fe.deletes=ids.join(",");_6ff=true;}if(_6ff){var self=this;return esri.request({url:this._url.path+"/applyEdits",content:dojo.mixin(_6fe,this._url.query),callbackParamName:"callback",load:function(_704){self._editHandler(_704,adds,_6fc,_6f8,_6f9,dfd);},error:function(err){self._resolve([err],null,_6f9,dfd,true);}},{usePost:true});}},queryFeatures:function(_705,_706,_707){return this._query("execute","onQueryFeaturesComplete",_705,_706,_707);},queryRelatedFeatures:function(_708,_709,_70a){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_708,_709,_70a);},queryIds:function(_70b,_70c,_70d){return this._query("executeForIds","onQueryIdsComplete",_70b,_70c,_70d);},queryCount:function(_70e,_70f,_710){return this._query("executeForCount","onQueryCountComplete",_70e,_70f,_710);},queryAttachmentInfos:function(_711,_712,_713){var url=this._url.path+"/"+_711+"/attachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this;dfd._pendingDfd=esri.request({url:url,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_714){var _715=_714.attachmentInfos,_716;dojo.forEach(_715,function(info){_716=dojo.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_716?("?"+_716):"");info.objectId=_711;});self._resolve([_715],"onQueryAttachmentInfosComplete",_712,dfd);},error:function(err){self._resolve([err],null,_713,dfd,true);}});return dfd;},addAttachment:function(_717,_718,_719,_71a){return this._sendAttachment("add",_717,_718,_719,_71a);},updateAttachment:function(_71b,_71c,_71d,_71e,_71f){_71d.appendChild(dojo.create("input",{type:"hidden",name:"attachmentId",value:_71c}));return this._sendAttachment("update",_71b,_71d,_71e,_71f);},deleteAttachments:function(_720,_721,_722,_723){var url=this._url.path+"/"+_720+"/deleteAttachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this,_724={f:"json",attachmentIds:_721.join(",")};dfd._pendingDfd=esri.request({url:url,content:dojo.mixin(_724,this._url.query),callbackParamName:"callback",load:dojo.hitch(this,function(_725){var _726=_725.deleteAttachmentResults;_726=dojo.map(_726,function(_727){var res=new esri.layers.FeatureEditResult(_727);res.attachmentId=res.objectId;res.objectId=_720;return res;});self._resolve([_726],"onDeleteAttachmentsComplete",_722,dfd);}),error:function(err){self._resolve([err],null,_723,dfd,true);}},{usePost:true});return dfd;},addType:function(_728){var _729=this.types;if(_729){var _72a=dojo.some(_729,function(type){if(type.id==_728.id){return true;}return false;});if(_72a){return false;}else{_729.push(_728);}}else{this.types=[_728];}this._typesDirty=true;return true;},deleteType:function(_72b){if(!this._collection){return;}var _72c=this.types;if(_72c){var _72d=-1;dojo.some(_72c,function(type,_72e){if(type.id==_72b){_72d=_72e;return true;}return false;});if(_72d>-1){this._typesDirty=true;return _72c.splice(_72d,1)[0];}}},toJson:function(){var _72f=this._json,json=dojo.isString(_72f)?dojo.fromJson(_72f):dojo.clone(_72f);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _730=json.layerDefinition,_731=this._collection;if(_731&&this._typesDirty){_730.types=dojo.map(this.types||[],function(type){return type.toJson();});var _732=this.renderer,_733=_730.drawingInfo;if(_733&&_732&&_732.declaredClass.indexOf("TemporalRenderer")===-1){_733.renderer=_732.toJson();}}var _734=null;if(!(_731&&!this._fcAdded)){_734={geometryType:_730.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=dojo.mixin({},json.featureSet||{},_734);if(_731){json.nextObjectId=this._nextId;_730.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_updateCaps:function(){var _735=this._editable,_736=dojo.trim(this.capabilities||""),_737=dojo.map((_736?_736.split(","):[]),dojo.trim),caps=dojo.map((_736?_736.toLowerCase().split(","):[]),dojo.trim),_738=dojo.indexOf(caps,"editing"),cap,i,_739,_73a={"Create":dojo.indexOf(caps,"create"),"Update":dojo.indexOf(caps,"update"),"Delete":dojo.indexOf(caps,"delete")};if(_735&&_738===-1){_737.push("Editing");}else{if(!_735&&_738>-1){_739=[_738];for(cap in _73a){if(_73a[cap]>-1){_739.push(_73a[cap]);}}_739.sort();for(i=_739.length-1;i>=0;i--){_737.splice(_739[i],1);}}}this.capabilities=_737.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},_getDesiredStatus:function(){return this.visible&&this._isMapAtVisibleScale();},_isMapAtVisibleScale:function(){if(!this._map){return false;}var _73b=esri.geometry.getScale(this._map);var _73c=this.minScale,_73d=this.maxScale,_73e=!_73c,_73f=!_73d;if(!_73e&&_73b<=_73c){_73e=true;}if(!_73f&&_73b>=_73d){_73f=true;}return (_73e&&_73f)?true:false;},_suspend:function(){this.inherited("_suspend",arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},_resume:function(){this.inherited("_resume",arguments);this._toggleTime(true);var mode=this._mode;if(mode){mode.resume();}},_zoomHandler:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}this._updateStatus();}},_toggleTime:function(_740){var map=this._map;if(_740&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=dojo.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;dojo.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_741){this._mapTimeExtent=_741;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_742){var _743=this._timeOffset,_744=this._timeOffsetUnits;return (_742&&_743&&_744)?_742.offset(-1*_743,_744):_742;},_getTimeOverlap:function(_745,_746){if(_745&&_746){return _745.intersection(_746);}else{return _745||_746;}},_getTimeFilter:function(_747){var _748=this.getTimeDefinition(),_749=null,_74a;if(_748||_749){_74a=this._getTimeOverlap(_748,_749);if(!_74a){return [false];}}if(_747){_747=_74a?this._getTimeOverlap(_747,_74a):_747;if(!_747){return [false];}}else{_747=_74a;}return [true,_747];},_getAttributeFilter:function(_74b){var _74c=this.getDefinitionExpression();if(_74b){_74b=_74c?"("+_74c+") AND ("+_74b+")":_74b;}else{_74b=_74c;}return _74b;},_applyQueryFilters:function(_74d){_74d.where=this._getAttributeFilter(_74d.where);_74d.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _74e=this._getTimeFilter(_74d.timeExtent);if(!_74e[0]){return false;}else{_74d.timeExtent=_74e[1];}}return true;},_add:function(_74f){var _750=this._selectionSymbol,attr=_74f.attributes,_751=this.visibilityField;if(_750&&this._isSelOnly){_74f.setSymbol(_750);}if(_751&&attr&&attr.hasOwnProperty(_751)){_74f[attr[_751]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_752){var _753=[],map=this._map;if(this._isTable||!map){return;}if(_752.text||(_752.where&&_752.where!==this.getDefinitionExpression())){return;}var _754=this._isSnapshot,_755=this._isSelOnly;var _756=_752.geometry;if(_756){if(!_755&&_752.spatialRelationship===esri.tasks.Query.SPATIAL_REL_INTERSECTS&&(_756.type==="extent"&&(_754||map.extent.contains(_756)))){_753.push(1);}else{return;}}var ids=_752.objectIds;if(ids){if(_754){_753.push(2);}else{var len=ids.length,mode=this._mode,_757=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_757++;}}if(_757===len){_753.push(2);}else{return;}}}if(this.timeInfo){var _758=_752.timeExtent,_759=this._mapTimeExtent;if(_754){if(_758){_753.push(3);}}else{if(_755){if(_758){return;}}else{if(_759){if(dojo.indexOf(_753,2)!==-1){if(_758){_753.push(3);}}else{return;}}else{if(_753.length>0){if(_758){_753.push(3);}}else{if(_758){return;}}}}}}return _753.length>0?_753:null;},_doQuery:function(_75a,_75b,_75c){var _75d=[],mode=this._mode,_75e=this.objectIdField,i,len,_75f;if(dojo.indexOf(_75b,2)!==-1){_75d=[];var ids=_75a.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_75d.push(obj);}}if(_75d.length===0){return [];}}if(dojo.indexOf(_75b,1)!==-1){_75f=_75d.length>0?_75d:this.graphics;len=_75f.length;var _760=_75a.geometry._normalize(null,true);_75d=[];for(i=0;i<len;i++){var _761=_75f[i],_762=_761.geometry;if(_762){if(this.normalization&&_760.length){if(_760[0].intersects(_762)||_760[1].intersects(_762)){_75d.push(_761);}}else{if(_760.intersects(_762)){_75d.push(_761);}}}}if(_75d.length===0){return [];}}if(dojo.indexOf(_75b,3)!==-1){if(this.timeInfo){_75f=_75d.length>0?_75d:this.graphics;var time=_75a.timeExtent,_763=this._filterByTime(_75f,time.startTime,time.endTime);_75d=_763.match;}}if(_75c){return dojo.map(_75d,function(obj){return obj.attributes[_75e];},this);}else{return _75d;}},_filterByTime:function(_764,_765,_766){var _767=this._startTimeField,_768=this._endTimeField,_769;if(!this._twoTimeFields){_769=_767||_768;}var _76a=esri._isDefined,yea=[],nay=[],i,len=_764.length,_76b,_76c;_765=_765?_765.getTime():-Infinity;_766=_766?_766.getTime():Infinity;if(_769){for(i=0;i<len;i++){_76b=_764[i];_76c=_76b.attributes;var time=_76c[_769];if(time>=_765&&time<=_766){yea.push(_76b);}else{nay.push(_76b);}}}else{for(i=0;i<len;i++){_76b=_764[i];_76c=_76b.attributes;var _76d=_76c[_767],end=_76c[_768];_76d=_76a(_76d)?_76d:-Infinity;end=_76a(end)?end:Infinity;if((_76d>=_765&&_76d<=_766)||(end>=_765&&end<=_766)||(_765>=_76d&&_766<=end)){yea.push(_76b);}else{nay.push(_76b);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_76e,_76f,dfd,_770){if(_76e){this[_76e].apply(this,args);}if(_76f){_76f.apply(null,args);}if(dfd){esri._resDfd(dfd,args,_770);}},_getShallowClone:function(_771){var _772=new esri.tasks.Query(),prop;for(prop in _771){if(_771.hasOwnProperty(prop)){_772[prop]=_771[prop];}}return _772;},_query:function(type,_773,_774,_775,_776){var that=this,dfd=new dojo.Deferred(esri._dfdCanceller);var _777=function(_778,_779){if(!_779&&type==="execute"&&!that._isTable){var _77a=_778.features,mode=that._mode,_77b=that.objectIdField,il=_77a.length,i;for(i=il-1;i>=0;i--){var oid=_77a[i].attributes[_77b];var _77c=mode._getFeature(oid);if(_77c){_77a.splice(i,1,_77c);}}}that._resolve([_778],_773,_775,dfd);};if(type!=="executeRelationshipQuery"){_774=this._getShallowClone(_774);_774.outFields=this._getOutFields();_774.returnGeometry=true;var map=this._map,_77d;if(map){_774.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_774)){switch(type){case "execute":_77d=new esri.tasks.FeatureSet({features:[]});break;case "executeForIds":_77d=[];break;case "executeForCount":_77d=0;break;}_777(_77d,true);return dfd;}var _77e=this._canDoClientSideQuery(_774);if(_77e){var _77f=this._doQuery(_774,_77e,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_77d=new esri.tasks.FeatureSet();_77d.features=_77f;break;case "executeForIds":_77d=_77f;break;case "executeForCount":_77d=_77f.length;break;}_777(_77d,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_776,dfd,true);return dfd;}if(this._ts){_774._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_774);temp.addCallbacks(_777,function(err){that._resolve([err],null,_776,dfd,true);});return dfd;},_convertFeaturesToJson:function(_780,_781,_782,_783){var json=[],_784=this._selectionSymbol,_785=this.visibilityField,i,_786,_787=this.objectIdField;if(this.loaded&&(_782||_783)){_786=dojo.filter(this.fields,function(_788){return (_788.editable===false)&&(!_783||(_788.name!==_787));});}for(i=0;i<_780.length;i++){var _789=_780[i],_78a={},_78b=_789.geometry,attr=_789.attributes,_78c=_789.symbol;if(_78b&&(!_783||!this.loaded||this.allowGeometryUpdates)){_78a.geometry=_78b.toJson();}if(_785){_78a.attributes=attr=dojo.mixin({},attr);attr[_785]=_789.visible?1:0;}else{if(attr){_78a.attributes=dojo.mixin({},attr);}}if(_78a.attributes&&_786&&_786.length){dojo.forEach(_786,function(_78d){delete _78a.attributes[_78d.name];});}if(_78c&&(_78c!==_784)){_78a.symbol=_78c.toJson();}json.push(_78a);}return _781?json:dojo.toJson(json);},_selectHandler:function(_78e,_78f,_790,_791,dfd){var _792,ctor=this.constructor;switch(_78f){case ctor.SELECTION_NEW:this.clearSelection(true);_792=true;break;case ctor.SELECTION_ADD:_792=true;break;case ctor.SELECTION_SUBTRACT:_792=false;break;}var i,_793=_78e.features,mode=this._mode,_794=[],_795=this.objectIdField,_796,oid;if(_792){for(i=0;i<_793.length;i++){_796=_793[i];oid=_796.attributes[_795];var _797=mode._addFeatureIIf(oid,_796);_794.push(_797);this._selectFeatureIIf(oid,_797,mode);}}else{for(i=0;i<_793.length;i++){_796=_793[i];oid=_796.attributes[_795];this._unSelectFeatureIIf(oid,mode);var _798=mode._removeFeatureIIf(oid);_794.push(_798||_796);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_794,_78f,_78e.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_790,dfd);if(_78e.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_799,mode){var _79a=this._selectedFeatures,_79b=_79a[oid];if(!_79b){mode._incRefCount(oid);_79a[oid]=_799;if(!this._isTable){this._setSelectSymbol(_799);}}return _79b||_799;},_unSelectFeatureIIf:function(oid,mode){var _79c=this._selectedFeatures[oid];if(_79c){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_79c);}}return _79c;},_isSelected:function(_79d){},_setSelectSymbol:function(_79e){var _79f=this._selectionSymbol;if(_79f&&!this._isSelOnly){_79e.setSymbol(_79f);}},_setUnSelectSymbol:function(_7a0){var _7a1=this._selectionSymbol;if(_7a1&&!this._isSelOnly){if(_7a1===_7a0.symbol){_7a0.setSymbol(null,true);}}},_getOutFields:function(){var _7a2=dojo.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_7a3,_7a4,arr){return !!_7a3&&(dojo.indexOf(arr,_7a3)===_7a4);});var _7a5=dojo.clone(this._outFields);if(_7a5){if(dojo.indexOf(_7a5,"*")!==-1){return _7a5;}dojo.forEach(_7a2,function(_7a6){if(dojo.indexOf(_7a5,_7a6)===-1){_7a5.push(_7a6);}});return _7a5;}else{return _7a2;}},_checkFields:function(_7a7){var _7a8=_7a7||this._getOutFields();dojo.forEach(_7a8,function(_7a9){if(_7a9==="*"){return;}if(!this._getField(_7a9)){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url,field:_7a9},esri.bundle.layers.FeatureLayer.fieldNotFound));}},this);if(!_7a7&&!this._isTable&&!this._fserver&&!this._collection){var _7aa=dojo.some(this.fields,function(_7ab){return (_7ab&&_7ab.type==="esriFieldTypeGeometry")?true:false;});if(!_7aa){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noGeometryField));}}},_fixRendererFields:function(){var _7ac=this.renderer;if(_7ac&&this.fields.length>0){var _7ad=dojo.filter([_7ac,_7ac.observationRenderer,_7ac.latestObservationRenderer,_7ac.trackRenderer],esri._isDefined);var _7ae=[];dojo.forEach(_7ad,function(rnd){var _7af,_7b0;_7b0=rnd.attributeField;if(_7b0){_7af=!this._getField(_7b0)&&this._getField(_7b0,true);if(_7af){rnd.attributeField=_7af.name;}}_7b0=rnd.attributeField2;if(_7b0){_7af=!this._getField(_7b0)&&this._getField(_7b0,true);if(_7af){rnd.attributeField2=_7af.name;}}_7b0=rnd.attributeField3;if(_7b0){_7af=!this._getField(_7b0)&&this._getField(_7b0,true);if(_7af){rnd.attributeField3=_7af.name;}}_7ae.push(rnd.attributeField);_7ae.push(rnd.attributeField2);_7ae.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_7ae,esri._isDefined);}},_getField:function(_7b1,_7b2){var _7b3=this.fields;if(_7b3.length===0){return null;}var _7b4;if(_7b2){_7b1=_7b1.toLowerCase();}dojo.some(_7b3,function(_7b5){var _7b6=false;if(_7b2){_7b6=(_7b5&&_7b5.name.toLowerCase()===_7b1)?true:false;}else{_7b6=(_7b5&&_7b5.name===_7b1)?true:false;}if(_7b6){_7b4=_7b5;}return _7b6;});return _7b4;},_getDateOpts:function(){if(!this._dtOpts){var _7b7=dojo.map(dojo.filter(this.fields,function(_7b8){return !!(_7b8&&_7b8.type==="esriFieldTypeDate");}),function(_7b9){return _7b9.name;});this._dtOpts={properties:_7b7};}return this._dtOpts;},_applyNormalized:function(_7ba,_7bb){if(_7ba&&_7bb){dojo.forEach(_7ba,function(_7bc,_7bd){if(_7bc&&_7bb[_7bd]){_7bc.setGeometry(_7bb[_7bd]);}});}},_editHandler:function(_7be,adds,_7bf,_7c0,_7c1,dfd){var _7c2=_7be.addResults,_7c3=_7be.updateResults,_7c4=_7be.deleteResults,i,_7c5,oid,_7c6,attr,_7c7=this.objectIdField,mode=this._mode,_7c8=this._isTable;var _7c9=this.editFieldsInfo,_7ca=this._getOutFields()||[],_7cb=_7c9&&_7c9.creatorField,_7cc=_7c9&&_7c9.creationDateField,_7cd=_7c9&&_7c9.editorField,_7ce=_7c9&&_7c9.editDateField,_7cf=_7c9&&_7c9.realm;if(dojo.indexOf(_7ca,"*")===-1){if(_7cb&&dojo.indexOf(_7ca,_7cb)===-1){_7cb=null;}if(_7cc&&dojo.indexOf(_7ca,_7cc)===-1){_7cc=null;}if(_7cd&&dojo.indexOf(_7ca,_7cd)===-1){_7cd=null;}if(_7ce&&dojo.indexOf(_7ca,_7ce)===-1){_7ce=null;}}var _7d0=(_7cc||_7ce)?(new Date()).getTime():null,_7d1=(_7cb||_7cd)?this.getUserId():undefined;if(_7d1&&_7cf){_7d1=_7d1+"@"+_7cf;}if(_7c2){for(i=0;i<_7c2.length;i++){_7c2[i]=new esri.layers.FeatureEditResult(_7c2[i]);if(_7c8){continue;}_7c5=_7c2[i];if(_7c5.success){oid=_7c5.objectId;_7c6=adds[i];var gl=_7c6._graphicsLayer;if(gl&&gl!==this){gl.remove(_7c6);}attr=_7c6.attributes||{};attr[_7c7]=oid;if(_7cb){attr[_7cb]=_7d1;}if(_7cd){attr[_7cd]=_7d1;}if(_7cc){attr[_7cc]=_7d0;}if(_7ce){attr[_7ce]=_7d0;}_7c6.setAttributes(attr);if(mode._init){mode.drawFeature(_7c6);}}}}if(_7c3){for(i=0;i<_7c3.length;i++){_7c3[i]=new esri.layers.FeatureEditResult(_7c3[i]);if(_7c8){continue;}_7c5=_7c3[i];if(_7c5.success){oid=_7c5.objectId;_7c6=_7bf[oid];var _7d2=mode._getFeature(oid);if(_7d2){if(_7d2.geometry!==_7c6.geometry){_7d2.setGeometry(esri.geometry.fromJson(_7c6.geometry.toJson()));}this._repaint(_7d2,oid);}_7c6=_7d2||_7c6;attr=_7c6.attributes||{};if(_7cd){attr[_7cd]=_7d1;}if(_7ce){attr[_7ce]=_7d0;}_7c6.setAttributes(attr);}}}if(_7c4){var _7d3=[];for(i=0;i<_7c4.length;i++){_7c4[i]=new esri.layers.FeatureEditResult(_7c4[i]);if(_7c8){continue;}_7c5=_7c4[i];if(_7c5.success){oid=_7c5.objectId;_7c6=mode._getFeature(oid);if(_7c6){if(this._unSelectFeatureIIf(oid,mode)){_7d3.push(_7c6);}_7c6._count=0;mode._removeFeatureIIf(oid);}}}if(_7d3.length>0){this.onSelectionComplete(_7d3,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_7c2,_7c3,_7c4],"onEditsComplete",_7c0,dfd);},_sendAttachment:function(type,_7d4,_7d5,_7d6,_7d7){var _7d8=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_7d4+"/"+_7d8,self=this;var dfd=esri.request({url:url,form:_7d5,content:dojo.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_7d9){var _7da=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_7db=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_7dc=new esri.layers.FeatureEditResult(_7d9[_7da]);_7dc.attachmentId=_7dc.objectId;_7dc.objectId=_7d4;self._resolve([_7dc],_7db,_7d6);return _7dc;}).addErrback(function(_7dd){self._resolve([_7dd],null,_7d7,null,true);});return dfd;},_repaint:function(_7de,oid,_7df){oid=esri._isDefined(oid)?oid:_7de.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_7de.setSymbol(_7de.symbol,_7df);}},_getKind:function(_7e0){var _7e1=this._trackManager;if(_7e1){return _7e1.isLatestObservation(_7e0)?1:0;}return 0;}});dojo.mixin(esri.layers.FeatureLayer,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});esri._createWrappers("esri.layers.FeatureLayer");dojo.declare("esri.layers.FeatureType",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.id=json.id;this.name=json.name;var _7e2=json.symbol;if(_7e2){this.symbol=esri.symbol.fromJson(_7e2);}var _7e3=json.domains,_7e4,i;var _7e5=this.domains={};for(_7e4 in _7e3){if(_7e3.hasOwnProperty(_7e4)){var _7e6=_7e3[_7e4];switch(_7e6.type){case "range":_7e5[_7e4]=new esri.layers.RangeDomain(_7e6);break;case "codedValue":_7e5[_7e4]=new esri.layers.CodedValueDomain(_7e6);break;case "inherited":_7e5[_7e4]=new esri.layers.InheritedDomain(_7e6);break;}}}var _7e7=json.templates;if(_7e7){var _7e8=this.templates=[];for(i=0;i<_7e7.length;i++){_7e8.push(new esri.layers.FeatureTemplate(_7e7[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _7e9,_7ea=this.domains,_7eb=this.templates,_7ec=esri._sanitize;if(_7ea){var _7ed=json.domains={};for(_7e9 in _7ea){if(_7ea.hasOwnProperty(_7e9)){_7ed[_7e9]=_7ea[_7e9]&&_7ea[_7e9].toJson();}}_7ec(_7ed);}if(_7eb){json.templates=dojo.map(_7eb,function(_7ee){return _7ee.toJson();});}return _7ec(json);}});dojo.declare("esri.layers.FeatureTemplate",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _7ef=json.prototype;this.prototype=new esri.Graphic(_7ef.geometry,null,_7ef.attributes);}},toJson:function(){return esri._sanitize({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});dojo.mixin(esri.layers.FeatureTemplate,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});dojo.declare("esri.layers.FeatureEditResult",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});dojo.declare("esri.layers._RenderMode",null,{constructor:function(){this._prefix="jsonp_"+(dojo._scopeName||"dojo")+"IoScript";},initialize:function(map){},propertyChangeHandler:function(type){},destroy:function(){},drawFeature:function(_7f0){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _7f1=this._featureMap[oid];if(_7f1){_7f1._count++;}},_decRefCount:function(oid){var _7f2=this._featureMap[oid];if(_7f2){_7f2._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_7f3){var fmap=this._featureMap,_7f4=fmap[oid],_7f5=this.featureLayer;if(!_7f4){fmap[oid]=_7f3;_7f5._add(_7f3);_7f3._count=0;}return _7f4||_7f3;},_removeFeatureIIf:function(oid){var _7f6=this._featureMap[oid],_7f7=this.featureLayer;if(_7f6){if(_7f6._count){return;}delete this._featureMap[oid];_7f7._remove(_7f6);}return _7f6;},_clearIIf:function(){var i,_7f8=this.featureLayer,_7f9=_7f8.graphics,_7fa=_7f8._selectedFeatures,_7fb=_7f8.objectIdField;for(i=_7f9.length-1;i>=0;i--){var _7fc=_7f9[i];var oid=_7fc.attributes[_7fb];if(oid in _7fa){_7fc._count=1;continue;}_7fc._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=dojo.io.script[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||dojo.io.script[this._prefix+id];if(dfd){try{dfd.cancel();dojo.io.script._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){dojo.io.script._validCheck(null);},_toggleVisibility:function(show){var _7fd=this.featureLayer,_7fe=_7fd.graphics,_7ff=show?"show":"hide",i,len=_7fe.length;show=show&&_7fd._ager;for(i=0;i<len;i++){var _800=_7fe[i];_800[_7ff]();if(show){_7fd._repaint(_800);}}},_applyTimeFilter:function(_801){var _802=this.featureLayer;if(!_802.timeInfo||_802._suspended){return;}if(!_801){_802._fireUpdateStart();}var _803=_802._trackManager;if(_803){_803.clearTracks();}var defn=_802.getTimeDefinition(),_804=_802._getOffsettedTE(_802._mapTimeExtent);if(_804){_804=_802._getTimeOverlap(defn,_804);if(_804){var _805=_802._filterByTime(_802.graphics,_804.startTime,_804.endTime);if(_803){_803.addFeatures(_805.match);}dojo.forEach(_805.match,function(_806){var _807=_806._shape;if(!_806.visible){_806.show();_807=_806._shape;_807&&_807._moveToFront();}if(_802._ager&&_807){_802._repaint(_806);}});dojo.forEach(_805.noMatch,function(_808){if(_808.visible){_808.hide();}});}else{this._toggleVisibility(false);}}else{if(_803){_803.addFeatures(_802.graphics);}this._toggleVisibility(true);}if(_803){_803.moveLatestToFront();_803.drawTracks();}if(!_801){_802._fireUpdateEnd();}}});dojo.declare("esri.layers._SelectionMode",[esri.layers._RenderMode],{constructor:function(_809){this.featureLayer=_809;this._featureMap={};},initialize:function(map){this.map=map;this._init=true;},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},destroy:function(){this._init=false;},resume:function(){this.propertyChangeHandler(0);}});dojo.declare("esri.layers._SnapshotMode",[esri.layers._RenderMode],{constructor:function(_80a){this.featureLayer=_80a;this._featureMap={};this._drawFeatures=dojo.hitch(this,this._drawFeatures);this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;var _80b=this.featureLayer;if(_80b._collection){this._applyTimeFilter();}else{this._fetchAll();}this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type){this._fetchAll();}else{this._applyTimeFilter();}}},destroy:function(){this._init=false;},drawFeature:function(_80c){var _80d=this.featureLayer,_80e=_80d.objectIdField,oid=_80c.attributes[_80e];this._addFeatureIIf(oid,_80c);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _80f=this.featureLayer;if(_80f._collection){_80f._fireUpdateStart();_80f._refresh(true);_80f._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_810){var id="_"+_810.name+_810.layerId+_810._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _811=this.featureLayer;if(_811._collection){return;}_811._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_812=this.featureLayer,_813=_812.getDefinitionExpression();var _814=new esri.tasks.Query();_814.outFields=_812._getOutFields();_814.where=_813||"1=1";_814.returnGeometry=true;_814.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());_814.timeExtent=_812.getTimeDefinition();_814.maxAllowableOffset=_812._maxOffset;if(_812._ts){_814._ts=(new Date()).getTime();}var _815;if(_812._usePatch){_815=this._getRequestId(_812);this._cancelPendingRequest(null,_815);}_812._task.execute(_814,this._drawFeatures,this._queryErrorHandler,_815);},_drawFeatures:function(_816){this._purgeRequests();var _817=_816.features,_818=this.featureLayer,_819=_818.objectIdField,i,len=_817.length,_81a,oid;for(i=0;i<len;i++){_81a=_817[i];oid=_81a.attributes[_819];this._addFeatureIIf(oid,_81a);this._incRefCount(oid);}this._applyTimeFilter(true);_818._fireUpdateEnd(null,_816.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_816.exceededTransferLimit){_818.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _81b=this.featureLayer;_81b._errorHandler(err);_81b._fireUpdateEnd(err);}});dojo.declare("esri.layers._OnDemandMode",[esri.layers._RenderMode],{constructor:function(_81c){this.featureLayer=_81c;this._featureMap={};this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;this._initialize();this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}}},destroy:function(){this._disableConnectors();this._init=false;},drawFeature:function(_81d){var _81e=this._gridLayer,geom=_81d.geometry,_81f=[];if(!geom){return;}_81f=_81e.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _820=this._cellMap,i,cell,oid=_81d.attributes[this.featureLayer.objectIdField],_821,row,col;for(i=0;i<_81f.length;i++){cell=_81f[i];_821=cell.latticeID;row=cell.row;col=cell.col;if(_821){cell=(_820[_821]=(_820[_821]||cell));}else{_820[row]=_820[row]||{};cell=(_820[row][col]=(_820[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_81d);this._addFeatureIIf(oid,_81d);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_initialize:function(){var map=this.map,_822=this.featureLayer;var _823=_822._srInfo;this._gridLayer=new esri.layers._GridLayout(new esri.geometry.Point(_823?_823.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_822._tileWidth,height:_822._tileHeight},{width:map.width,height:map.height},_823);this._ioQueue=[];if(!_822._suspended){this._zoomHandler();this._enableConnectors();}},_enableConnectors:function(){var map=this.map;this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=dojo.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=dojo.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){dojo.disconnect(this._zoomConnect);dojo.disconnect(this._panConnect);dojo.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _824=this.featureLayer,map=this.map;if(_824._suspended){return;}_824._fireUpdateStart();this._clearIIf();var _825=_824._trackManager;if(_825){_825.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_826,cell){var id="_"+_826.name+_826.layerId+_826._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_827){this._exceeds=false;var _828=this.featureLayer,map=this.map,_829=_827||map.extent,_82a=this._gridLayer.getCellsInExtent(_829,_828.latticeTiling),_82b=_82a.cells;if(!_828.isEditable()){var _82c=this._cellMap;_82b=dojo.filter(_82b,function(cell){if(cell.lattice){if(_82c[cell.latticeID]){return false;}}else{if(_82c[cell.row]&&_82c[cell.row][cell.col]){return false;}}return true;});}var _82d=_828._getOutFields(),_82e=_828.getDefinitionExpression(),time=_828._getOffsettedTE(_828._mapTimeExtent),_82f=_828._usePatch,_830=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_831,_832;this._pending=this._pending||0;for(i=0;i<_82b.length;i++){cell=_82b[i];_831=new esri.tasks.Query();_831.geometry=cell.extent||cell.lattice;_831.outFields=_82d;_831.where=_82e;if(_828.latticeTiling&&cell.extent){_831.spatialRelationship=esri.tasks.Query.SPATIAL_REL_CONTAINS;}_831.returnGeometry=true;_831.timeExtent=time;_831.maxAllowableOffset=_828._maxOffset;if(_828._ts){_831._ts=(new Date()).getTime();}_832=null;if(_82f){_832=this._getRequestId(_828,cell);if(this._isPending(_832)){continue;}}this._pending++;_830.push(_828._task.execute(_831,function(){var _833=cell;return function(_834){func.apply(self,[_834,_833]);};}.call(this),this._queryErrorHandler,_832));}this._removeOldCells(_829);this._endCheck();},_drawFeatures:function(_835,cell){this._exceeds=this._exceeds||_835.exceededTransferLimit;this._finalizeIO();var _836=this.featureLayer,map=this.map,_837=map.extent,_838=cell.extent,row=cell.row,col=cell.col,_839=_836.objectIdField,_83a=_835.features,_83b=this._gridLayer,_83c=this._cellMap,i,len,_83d=cell.latticeID,_83e=_83d?_83c[_83d]:(_83c[row]&&_83c[row][col]);if((cell.resolution!=_83b._resolution)||(_83d?(_83d!==_83b.getLatticeID(_837)):(!_83b.intersects(_838,_837)))){if(_83e){this._removeCell(row,col,_83d);}}else{if(_83e){this._updateCell(_83e,_83a);}else{cell.features=_83a;if(_83d){_83c[_83d]=cell;}else{_83c[row]=_83c[row]||{};_83c[row][col]=cell;}len=_83a.length;for(i=0;i<len;i++){var _83f=_83a[i];var oid=_83f.attributes[_839];this._addFeatureIIf(oid,_83f);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_840){if(this._pending===0){this._processIOQueue();var _841=this.featureLayer,_842=_841._trackManager;if(_842){_842.clearTracks();_842.addFeatures(_841.graphics);if(_841._ager){dojo.forEach(_841.graphics,function(_843){if(_843._shape){_841._repaint(_843);}});}_842.moveLatestToFront();_842.drawTracks();}this.featureLayer._fireUpdateEnd(_840&&new Error("FeatureLayer: "+esri.bundle.layers.FeatureLayer.updateError),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_841.onQueryLimitExceeded();}}},_processIOQueue:function(_844){this._ioQueue=dojo.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_844){dojo.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_845){var _846=this._cellMap,_847=this._gridLayer,_848,_849;for(_848 in _846){if(_846[_848]){var row=_846[_848],_84a=row.latticeID,_84b=0,_84c=0;if(_84a){_84b++;if(_84a!==_847.getLatticeID(_845)){this._removeCell(null,null,_84a);_84c++;}}else{for(_849 in row){if(row[_849]){_84b++;var _84d=row[_849].extent;if(!_847.intersects(_84d,_845)){this._removeCell(_848,_849);_84c++;}}}}if(_84c===_84b){delete _846[_848];}}}},_updateCell:function(cell,_84e){var _84f=this.featureLayer,_850=_84f.objectIdField,_851=_84f._selectedFeatures,i,len=_84e.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _852=_84e[i];var oid=_852.attributes[_850];var _853=this._addFeatureIIf(oid,_852);if(_853===_852){this._incRefCount(oid);cell.features.push(_853);}else{if(!(oid in _851)){_853.setGeometry(_852.geometry);_853.setAttributes(_852.attributes);}}}},_removeCell:function(row,col,_854){var _855=this._cellMap,_856=this.featureLayer,_857=_856.objectIdField;var cell=_854?_855[_854]:(_855[row]&&_855[row][col]);if(cell){if(_854){delete _855[_854];}else{delete _855[row][col];}var _858=cell.features,i;for(i=0;i<_858.length;i++){var _859=_858[i];var oid=_859.attributes[_857];this._decRefCount(oid);if(oid in _856._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});dojo.declare("esri.layers._GridLayout",null,{constructor:function(_85a,_85b,_85c,_85d){this.origin=_85a;this.cellWidth=_85b.width;this.cellHeight=_85b.height;this.mapWidth=_85c.width;this.mapHeight=_85c.height;this.srInfo=_85d;},setResolution:function(_85e){this._resolution=(_85e.xmax-_85e.xmin)/this.mapWidth;if(this.srInfo){var _85f=Math.round((2*this.srInfo.valid[1])/this._resolution),_860=Math.round(_85f/this.cellWidth);this._frameStats=[_860,0,_860-1];}},getCellCoordinates:function(_861){var res=this._resolution,_862=this.origin;return {row:Math.floor((_862.y-_861.y)/(this.cellHeight*res)),col:Math.floor((_861.x-_862.x)/(this.cellWidth*res))};},normalize:function(col){var _863=this._frameStats;if(_863){var _864=_863[0],m180=_863[1],p180=_863[2];if(col<m180){col=col%_864;col=col<m180?col+_864:col;}else{if(col>p180){col=col%_864;}}}return col;},intersects:function(_865,_866){var _867=this.srInfo;if(_867){return dojo.some(_866._getParts(_867),function(_868){return _865.intersects(_868.extent);});}else{return _865.intersects(_866);}},getCellExtent:function(row,col){var res=this._resolution,_869=this.origin,_86a=this.cellWidth,_86b=this.cellHeight;return new esri.geometry.Extent((col*_86a*res)+_869.x,_869.y-((row+1)*_86b*res),((col+1)*_86a*res)+_869.x,_869.y-(row*_86b*res),new esri.SpatialReference(_869.spatialReference.toJson()));},getLatticeID:function(_86c){var _86d=this.getCellCoordinates({x:_86c.xmin,y:_86c.ymax}),_86e=this.getCellCoordinates({x:_86c.xmax,y:_86c.ymin}),_86f=_86d.row,_870=_86e.row,_871=this.normalize(_86d.col),_872=this.normalize(_86e.col);return _86f+"_"+_870+"_"+_871+"_"+_872;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_873,_874){var _875=this.getCellCoordinates({x:_873.xmin,y:_873.ymax}),_876=this.getCellCoordinates({x:_873.xmax,y:_873.ymin}),_877=_875.row,_878=_876.row,_879=_875.col,_87a=_876.col,_87b=[],i,j,nj,_87c=[],_87d=[],len,xmin,xmax,ymin,ymax,_87e=[],_87f,_880;for(i=_877;i<=_878;i++){for(j=_879;j<=_87a;j++){nj=this.normalize(j);_873=this.getCellExtent(i,nj);_87b.push({row:i,col:nj,extent:_873,resolution:this._resolution});if(_874){_87c.push(_873.xmin,_873.xmax);_87d.push(_873.ymin,_873.ymax);}}}_879=this.normalize(_879);_87a=this.normalize(_87a);_87c.sort(this.sorter);_87d.sort(this.sorter);len=_87c.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_87c[i]===_87c[i+1]){_87c.splice(i,1);}}}len=_87d.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_87d[i]===_87d[i+1]){_87d.splice(i,1);}}}if(_87c.length&&_87d.length){xmin=_87c[0];xmax=_87c[_87c.length-1];ymin=_87d[0];ymax=_87d[_87d.length-1];len=_87c.length;for(i=0;i<len;i++){_87e.push([[_87c[i],ymax],[_87c[i],ymin]]);}len=_87d.length;for(i=0;i<len;i++){_87e.push([[xmin,_87d[i]],[xmax,_87d[i]]]);}_87f=new esri.geometry.Polyline({paths:_87e,spatialReference:this.origin.spatialReference.toJson()});_880=_877+"_"+_878+"_"+_879+"_"+_87a;_87b.push({latticeID:_880,lattice:_87f,resolution:this._resolution});}return {minRow:_877,maxRow:_878,minCol:_879,maxCol:_87a,cells:_87b};}});dojo.declare("esri.layers._TrackManager",null,{constructor:function(_881){this.layer=_881;this.trackMap={};},initialize:function(map){this.map=map;var _882=this.layer,_883=_882.renderer.trackRenderer;if(_883&&(_882.geometryType==="esriGeometryPoint")){var _884=(this.container=new esri.layers._GraphicsLayer({id:_882.id+"_tracks",_child:true}));_884._setMap(map,_882._div);_884.setRenderer(_883);}},addFeatures:function(_885){var tkid,_886=this.trackMap,_887=this.layer,_888=_887._trackIdField;dojo.forEach(_885,function(_889){var _88a=_889.attributes;tkid=_88a[_888];var ary=(_886[tkid]=(_886[tkid]||[]));ary.push(_889);});var _88b=_887._startTimeField,_88c=_887.objectIdField;var _88d=function(a,b){var _88e=a.attributes[_88b],_88f=b.attributes[_88b];if(_88e===_88f){return (a.attributes[_88c]<b.attributes[_88c])?-1:1;}else{return (_88e<_88f)?-1:1;}};for(tkid in _886){_886[tkid].sort(_88d);}},drawTracks:function(){var _890=this.container;if(!_890){return;}var _891=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_892,_893=this.layer._trackIdField,_894;for(tkid in _891){ary=_891[tkid];path=[];for(i=ary.length-1;i>=0;i--){_892=ary[i].geometry;if(_892){path.push([_892.x,_892.y]);}}_894={};_894[_893]=tkid;if(path.length>0){_890.add(new esri.Graphic(new esri.geometry.Polyline({paths:[path],spatialReference:sr}),null,_894));}}},moveLatestToFront:function(){dojo.forEach(this.getLatestObservations(),function(_895){var _896=_895._shape;_896&&_896._moveToFront();this._repaint(_895,null,true);},this.layer);},getLatestObservations:function(){var _897=[];if(!this.layer.renderer.latestObservationRenderer){return _897;}var _898=this.trackMap,tkid;for(tkid in _898){var ary=_898[tkid];_897.push(ary[ary.length-1]);}return _897;},clearTracks:function(){var _899=this.getLatestObservations();this.trackMap={};var _89a=this.container;if(_89a){_89a.clear();}dojo.forEach(_899,function(_89b){this._repaint(_89b,null,true);},this.layer);},isLatestObservation:function(_89c){var _89d=this.layer._trackIdField;var _89e=this.trackMap[_89c.attributes[_89d]];if(_89e){return (_89e[_89e.length-1]===_89c);}return false;},destroy:function(){var _89f=this.container;if(_89f){_89f.clear();_89f._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});});},"*noref":1}});require(["dojo/i18n"],function(i18n){i18n._preloadLocalizations("esri/dijit/editing/nls/TemplatePicker-all",["nl-nl","en-us","da","fi-fi","pt-pt","hu","sk","sl","pl","ca","sv","zh-tw","ar","en-gb","he-il","de-de","ko-kr","ja-jp","ro","az","nb","ru","es-es","th","cs","it-it","pt-br","fr-fr","el","tr","zh-cn"]);});define("esri/dijit/editing/TemplatePicker-all",["dijit","dojo","dojox","dojo/require!esri/layers/FeatureLayer,esri/toolbars/draw,esri/toolbars/edit,esri/dijit/editing/TemplatePicker"],function(_8a0,dojo,_8a1){dojo.provide("esri.dijit.editing.TemplatePicker-all");dojo.require("esri.layers.FeatureLayer");dojo.require("esri.toolbars.draw");dojo.require("esri.toolbars.edit");dojo.require("esri.dijit.editing.TemplatePicker");});